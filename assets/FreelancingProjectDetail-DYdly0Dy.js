import{j as e}from"./radix-ui-C3V2uSY1.js";import{r as N,d as U,u as Y}from"./router-BQf8R6iK.js";import{C}from"./Card-B1RPKrwx.js";import{y as D,B as f,j as v,g as E,z as I}from"./index-xR7wiZ90.js";import{P as _}from"./progress-CzWuDUNG.js";import"./dnd-kit-VvYmaRfD.js";import{L as A,a as B}from"./ListCard-BvAU9eYy.js";import{C as z}from"./Checkbox-DiLyklnL.js";import{a as T,i as S,h as H,c as J,b as W,f as O,P as X,j as Z,u as ee}from"./TaskModals-C0EeFzui.js";import{a2 as $,a3 as q,z as k,T as L,g as b,y as se,_ as te,Y as F,O as ae,Q as re,P as ie}from"./utils-MsfPC-Eo.js";import{K as le,a as K}from"./KanbanCard-BlFbAKWt.js";import"./react-vendor-pR2cKLDH.js";import"./charts-5ZM4_dsB.js";import"./TextArea-DMBC70KO.js";import"./FormSelect-DT8fwc83.js";const ne=({tasks:a,onToggleComplete:i,onEdit:p,onDelete:j})=>{const[l,r]=N.useState(!0),m=a.filter(t=>!t.completed),o=a.filter(t=>t.completed),n=t=>{const u=[];if(u.push({label:T(t.priority),variant:D(t.priority)}),t.dueDate){const s=S(t.dueDate);u.push({label:`Due: ${new Date(t.dueDate).toLocaleDateString()}${s&&!t.completed?" (Overdue)":""}`,variant:s&&!t.completed?"destructive":"outline",icon:e.jsx(b,{className:"h-3 w-3"})})}return t.timeEstimate&&u.push({label:`${t.timeEstimate}h estimated`,variant:"outline"}),u},g=t=>[{label:t.completed?"Mark Incomplete":"Mark Complete",icon:t.completed?e.jsx($,{className:"h-4 w-4"}):e.jsx(q,{className:"h-4 w-4"}),onClick:()=>i(t.id)},{label:"Edit",icon:e.jsx(k,{className:"h-4 w-4"}),onClick:()=>p(t)},{label:"Delete",icon:e.jsx(L,{className:"h-4 w-4"}),onClick:()=>j(t.id),variant:"destructive"}];return a.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:'No tasks yet. Click "Add Task" to get started.'})}):e.jsxs("div",{className:"space-y-4",children:[m.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:["Active Tasks (",m.length,")"]}),e.jsx(A,{items:m,getItemId:t=>t.id,emptyMessage:"",renderItem:t=>e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(z,{checked:t.completed,onCheckedChange:()=>i(t.id),className:"mt-4"}),e.jsx("div",{className:"flex-1",children:e.jsx(B,{title:t.title,description:t.description,badges:n(t),actions:g(t),className:t.completed?"opacity-60":""})})]})})]}),o.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>r(!l),className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide hover:text-foreground transition-colors",children:["Completed Tasks (",o.length,")",e.jsx("span",{className:"ml-2",children:l?"â–¼":"â–¶"})]}),l&&e.jsx(A,{items:o,getItemId:t=>t.id,emptyMessage:"",renderItem:t=>e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(z,{checked:t.completed,onCheckedChange:()=>i(t.id),className:"mt-4"}),e.jsx("div",{className:"flex-1",children:e.jsx(B,{title:t.title,description:t.description,badges:n(t),actions:g(t),className:"opacity-60"})})]})})]})]})},oe=({tasks:a,onToggleComplete:i,onEdit:p,onDelete:j,onUpdateStatus:l})=>{const r=s=>{const x=[];if(s.priority&&x.push({label:T(s.priority),variant:D(s.priority)}),s.dueDate){const d=S(s.dueDate);x.push({label:new Date(s.dueDate).toLocaleDateString(),variant:d?"destructive":"outline",icon:e.jsx(b,{className:"h-3 w-3"})})}return x},m=s=>{const x=[{label:s.completed?"Mark Incomplete":"Mark Complete",icon:s.completed?e.jsx($,{className:"h-4 w-4"}):e.jsx(q,{className:"h-4 w-4"}),onClick:()=>i(s.id)},{label:"Edit",icon:e.jsx(k,{className:"h-4 w-4"}),onClick:()=>p(s),separator:!0},{label:"Delete",icon:e.jsx(L,{className:"h-4 w-4"}),onClick:()=>j(s.id),variant:"destructive"}];if(!s.completed){const d=s.status||"todo",c=[];d!=="inProgress"&&c.push({label:"Move to In Progress",onClick:()=>l(s.id,"inProgress"),separator:c.length===0}),d!=="todo"&&c.push({label:"Move to To Do",onClick:()=>l(s.id,"todo"),separator:c.length===0}),x.splice(1,0,...c)}return x},o=(s,x)=>{const d=a.find(y=>y.id===s);if(!d)return;const c=x;c==="completed"?d.completed||i(s):(d.completed&&i(s),l(s,c))},n=a.filter(s=>!s.completed&&(!s.status||s.status==="todo")),g=a.filter(s=>!s.completed&&s.status==="inProgress"),t=a.filter(s=>s.completed),u=[{id:"todo",title:"ðŸ“‹ To Do",items:n,color:"from-blue-500 to-cyan-500"},{id:"inProgress",title:"ðŸ”¶ In Progress",items:g,color:"from-yellow-500 to-orange-500"},{id:"completed",title:"âœ… Completed",items:t,color:"from-green-500 to-emerald-500"}];return e.jsx(le,{columns:u,getItemId:s=>s.id,onDragEnd:o,renderItem:s=>e.jsx(K,{id:s.id,title:s.title,description:s.description,badges:r(s),actions:m(s),className:s.completed?"opacity-60":""}),dragOverlay:s=>e.jsx(K,{id:s.id,title:s.title,description:s.description,badges:r(s),actions:[],className:s.completed?"opacity-60":""})})},de=({project:a,onBack:i,onUpdate:p,onDelete:j})=>{const[l,r]=N.useState(!1),[m,o]=N.useState(!1),[n,g]=N.useState(!1),[t,u]=N.useState("kanban"),{tasks:s,addTask:x,deleteTask:d,toggleTaskComplete:c,updateTask:y,reloadTasks:V}=H(a.id),M=J(a.id),w=S(a.deadline),R=W(a.deadline),G=s.filter(h=>h.completed).length,Q=()=>a.status==="todo"?e.jsx(v,{variant:"secondary",children:"To Do"}):a.status==="inProgress"?e.jsx(v,{variant:"default",children:"In Progress"}):e.jsx(v,{className:"bg-green-500/10 text-green-500",children:"Done"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(f,{variant:"outline",size:"default",onClick:i,className:"gap-2 hover:bg-primary/10 hover:border-primary text-primary transition-all duration-200 font-medium shadow-sm",children:[e.jsx(se,{className:"h-4 w-4"}),"Back to Projects"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(f,{variant:"outline",size:"default",onClick:()=>r(!0),className:"gap-2 hover:bg-blue-50 hover:border-blue-500 hover:text-blue-600 transition-all duration-200 shadow-sm text-primary ",children:[e.jsx(k,{className:"h-4 w-4"}),"Edit Project"]}),e.jsxs(f,{variant:"outline",size:"default",onClick:()=>g(!0),className:"gap-2 hover:bg-red-50 hover:border-red-500 hover:text-red-600 transition-all duration-200 shadow-sm text-primary ",children:[e.jsx(L,{className:"h-4 w-4"}),"Delete"]})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Freelancing > Projects >"," ",e.jsx("span",{className:"text-foreground font-medium",children:a.name})]}),e.jsx(C,{className:"p-6 border-border",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:a.name}),e.jsx("p",{className:"text-lg text-muted-foreground",children:a.clientName})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[Q(),a.priority&&e.jsx(v,{variant:D(a.priority),children:T(a.priority)})]})]}),a.description&&e.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-foreground whitespace-pre-wrap",children:a.description})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Timeline"}),e.jsxs("div",{className:"space-y-2",children:[a.startDate&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(b,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-foreground",children:["Started:"," ",new Date(a.startDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[w?e.jsx(te,{className:"h-4 w-4 text-destructive"}):e.jsx(b,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:"Deadline: "}),e.jsx("span",{dir:"rtl",className:w?"text-destructive font-medium":"text-foreground",children:new Date(a.deadline).toLocaleDateString().toString()}),e.jsxs("span",{children:[" ",w?" (Overdue)":` (${R} days left)`]})]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Financial"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Expected:"}),e.jsx("span",{className:"font-semibold text-foreground",children:O(a.expectedProfit,a.currency)})]}),a.actualProfit&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Actual:"}),e.jsx("span",{className:"font-bold text-green-600",children:O(a.actualProfit,a.currency)})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[a.tags.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map((h,P)=>e.jsx(v,{variant:"outline",children:h},P))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Metadata"}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Created:"," ",e.jsx("span",{dir:"rtl",children:new Date(a.createdAt).toLocaleDateString()})]}),e.jsxs("p",{children:["Last updated:"," ",e.jsx("span",{dir:"rtl",children:new Date(a.updatedAt).toLocaleDateString()})]})]})]})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-foreground",children:"Project Progress"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[G," of ",s.length," tasks completed"]})]}),e.jsx(_,{value:M,className:"h-2.5"}),e.jsx("div",{className:"text-right mt-2",children:e.jsxs("span",{className:"text-2xl font-bold text-primary",children:[M,"%"]})})]})]})}),e.jsxs(C,{className:"p-6 border-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Tasks"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{variant:t==="kanban"?"secondary":"ghost",size:"sm",onClick:()=>u("kanban"),"aria-label":"Kanban view",className:E("text-primary",t==="kanban"&&"bg-primary/10 text-primary hover:bg-primary/20"),children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsx(f,{variant:t==="list"?"secondary":"ghost",size:"sm",onClick:()=>u("list"),"aria-label":"List view",className:E("text-primary",t==="list"&&"bg-primary/10 hover:bg-primary/20"),children:e.jsx(re,{className:"h-4 w-4"})}),e.jsxs(f,{onClick:()=>o(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add Task"]})]})]}),t==="kanban"?e.jsx(oe,{tasks:s,onToggleComplete:c,onEdit:()=>{},onDelete:d,onUpdateStatus:(h,P)=>{y(h,{status:P})}}):e.jsx(ne,{tasks:s,onToggleComplete:c,onEdit:()=>{},onDelete:d})]}),l&&e.jsx(X,{isOpen:l,onClose:()=>r(!1),onSave:h=>{p(h),r(!1)},project:a,mode:"edit"}),m&&e.jsx(Z,{isOpen:m,onClose:()=>o(!1),onSave:h=>{x(h),o(!1),V()},projectId:a.id,mode:"create"}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(C,{className:"p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Delete Project?"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-6",children:['Are you sure you want to delete "',a.name,'"? This will also delete all associated tasks. This action cannot be undone.']}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(f,{variant:"secondary",onClick:()=>g(!1),children:"Cancel"}),e.jsx(f,{variant:"destructive",onClick:()=>{j(),g(!1)},children:"Delete Project"})]})]})})]})},Ce=()=>{const{projectId:a}=U(),i=Y(),{projects:p,updateProject:j,deleteProject:l}=ee(),r=N.useMemo(()=>a&&p.find(n=>n.id===a)||null,[p,a]),m=n=>{r&&j(r.id,n)},o=()=>{r&&l(r.id)};return r?e.jsx(de,{project:r,onBack:()=>i("/freelancing"),onUpdate:n=>{m(n),I.success("Project updated successfully")},onDelete:()=>{o(),I.success("Project deleted"),i("/freelancing")}}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Project Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"The project you're looking for doesn't exist."}),e.jsx("button",{onClick:()=>i("/freelancing"),className:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors",children:"Back to Freelancing"})]})};export{Ce as FreelancingProjectDetail};
