const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-OeeYqBZp.js","assets/radix-ui-C3V2uSY1.js","assets/router-BQf8R6iK.js","assets/react-vendor-pR2cKLDH.js","assets/utils-MsfPC-Eo.js","assets/charts-5ZM4_dsB.js","assets/dnd-kit-VvYmaRfD.js","assets/index-qMQHlaWf.css"])))=>i.map(i=>d[i]);
import{u as Me,b as Ye,d as Ue,e as $e,h as Oe,V as I,B as r,S as u,f as Ge,i as _e,r as qe,_ as Pe,g as He}from"./index-OeeYqBZp.js";import{j as e}from"./radix-ui-C3V2uSY1.js";import{r as a}from"./router-BQf8R6iK.js";import{C as b}from"./Card-Bf7Y9406.js";import{L as T,S as Ke,a as ne,b as ce,c as de,d as oe,e as d}from"./Select-BtnnQVj2.js";import{S as We,B as Je,R as V,T as v,D as Ze,C as y,a as me,H as Qe,b as xe,L as o,U as Xe,c as k,d as L,e as ue,f as he,g as es,h as ss}from"./utils-MsfPC-Eo.js";import"./react-vendor-pR2cKLDH.js";import"./charts-5ZM4_dsB.js";import"./dnd-kit-VvYmaRfD.js";const ms=()=>{const{data:i,updateData:M,dismissedNotifications:h,neverShowAgain:g,resetDismissedNotifications:ge,refreshData:pe}=Me(),{isAuthenticated:m}=Ye(),{lastSyncTime:Y,isCloudMode:x}=Ue(),[fe,w]=a.useState(!1),[je,U]=a.useState(!1),[S,$]=a.useState(!1),[O,C]=a.useState(null),[G,_]=a.useState(null),[B,q]=a.useState(!1),[be,P]=a.useState(!1),[D,H]=a.useState(!1),[K,W]=a.useState(null),[p,ve]=a.useState([]),[z,J]=a.useState(!1),[Z,Q]=a.useState(!1),[Ne,E]=a.useState(!1),[X,ee]=a.useState(null),[se,te]=a.useState(null),[ae,n]=a.useState(null),[re,ye]=a.useState(null),[ke,we]=a.useState(0),[A,Se]=a.useState(!1);a.useEffect(()=>{const s=$e();ye(s),Se(Oe());const t=localStorage.getItem(I);t&&we(new Blob([t]).size)},[]);const Ce=async()=>{$(!0),C(null);try{qe()?(localStorage.removeItem(I),window.location.reload()):C("No backup found to restore.")}catch(s){C(s instanceof Error?s.message:"Rollback failed")}finally{$(!1)}},Be=()=>{Ge()},De=async()=>{H(!0),W(null);try{await u.delete(He.MAIN_DATA),localStorage.removeItem(I),window.location.reload()}catch(s){W(s instanceof Error?s.message:"Failed to clear data"),H(!1)}},N=async()=>{if(x){J(!0);try{const s=await u.listCloudBackups();ve(s)}catch(s){console.error("Failed to load backups:",s)}finally{J(!1)}}},ze=async()=>{Q(!0),n(null),E(!1);try{const s=await u.createCloudBackup();if(s.success){E(!0),setTimeout(()=>E(!1),3e3);const t=i.settings?.backup?.maxBackups??5;await u.cleanupOldBackups(t),M({settings:{...i.settings,backup:{...i.settings?.backup??{autoBackupEnabled:!1,frequency:"weekly",maxBackups:5},lastBackupTime:Date.now()}}}),await N()}else n(s.error||"Backup failed")}catch(s){n(s instanceof Error?s.message:"Backup failed")}finally{Q(!1)}},Ee=async s=>{if(confirm(`Are you sure you want to restore from "${s.name}"? Your current data will be overwritten.`)){ee(s.id),n(null);try{const t=await u.restoreCloudBackup(s.fileName);t.success?window.location.reload():n(t.error||"Restore failed")}catch(t){n(t instanceof Error?t.message:"Restore failed")}finally{ee(null)}}},Ae=async s=>{if(confirm(`Are you sure you want to delete "${s.name}"?`)){te(s.id),n(null);try{const t=await u.deleteCloudBackup(s.fileName);t.success?await N():n(t.error||"Delete failed")}catch(t){n(t instanceof Error?t.message:"Delete failed")}finally{te(null)}}},Re=async s=>{try{const{DriveService:t}=await Pe(async()=>{const{DriveService:c}=await import("./index-OeeYqBZp.js").then(f=>f.E);return{DriveService:c}},__vite__mapDeps([0,1,2,3,4,5,6,7])),l=await t.restoreBackup(s.fileName);if(l){const c=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),f=URL.createObjectURL(c),j=document.createElement("a");j.href=f;const Le=new Date(s.createdTime);j.download=`lifeos-backup-${Le.toISOString().split("T")[0]}.json`,document.body.appendChild(j),j.click(),document.body.removeChild(j),URL.revokeObjectURL(f)}else n("Failed to download backup")}catch(t){n(t instanceof Error?t.message:"Download failed")}},R=s=>{M({settings:{...i.settings,backup:{...i.settings?.backup??{autoBackupEnabled:!1,frequency:"weekly",lastBackupTime:null,maxBackups:5},...s}}})};a.useEffect(()=>{x&&m&&N()},[x,m]);const Fe=async s=>{const t=s.target.files?.[0];if(t){q(!0),_(null);try{await _e(t),pe(),s.target.value=""}catch(l){_(l instanceof Error?l.message:"Import failed")}finally{q(!1)}}},Ie=s=>{if(s===0)return"0 Bytes";const t=1024,l=["Bytes","KB","MB","GB"],c=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,c)).toFixed(2))+" "+l[c]},F=s=>{const t=s.getFullYear(),l=String(s.getMonth()+1).padStart(2,"0"),c=String(s.getDate()).padStart(2,"0");return`${t}-${l}-${c}`},le=s=>{const t=s.getHours(),l=String(s.getMinutes()).padStart(2,"0"),c=t>=12?"PM":"AM";return`${t%12||12}:${l} ${c}`},ie=s=>`${F(s)} ${le(s)}`,Te=()=>{ge(),w(!1)},Ve=h.filter(s=>s.dismissUntil?new Date(s.dismissUntil)>new Date:!0).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(We,{className:"text-primary",size:32}),e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Settings"})]}),e.jsxs(b,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Je,{className:"text-primary",size:24}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Notification Settings"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-primary/10 rounded-lg p-4 border border-primary/20",children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:Ve}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Currently Dismissed"})]}),e.jsxs("div",{className:"bg-destructive/10 rounded-lg p-4 border border-destructive/20",children:[e.jsx("div",{className:"text-3xl font-bold text-destructive",children:g.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Never Show Again"})]}),e.jsxs("div",{className:"bg-green-500/10 rounded-lg p-4 border border-green-500/20",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:h.length+g.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Dismissed"})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 border border-border",children:[e.jsx("h3",{className:"font-semibold text-lg mb-3 text-foreground",children:"How Notification Dismissal Works"}),e.jsxs("ul",{className:"space-y-2 text-sm text-foreground",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-primary mt-1",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Session Only:"})," Notification is hidden until you close and reopen the app"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"For 1 Day:"})," Notification will reappear after 24 hours"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-yellow-600 dark:text-yellow-400 mt-1",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"For 1 Week:"})," Notification will reappear after 7 days"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-destructive mt-1",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Never Show Again:"})," ","Notification is permanently hidden"]})]})]})]}),h.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-3 text-foreground",children:"Dismissed Notifications"}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:h.map(s=>{const t=s.dismissUntil&&new Date(s.dismissUntil)<new Date,l=s.dismissUntil?t?"Expired (will show again)":`Until ${F(new Date(s.dismissUntil))}`:"Until next session";return e.jsx("div",{className:"bg-muted/50 rounded p-3 border border-border flex justify-between items-center",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:s.id}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:l})]})},s.id)})})]}),g.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-3 text-foreground",children:"Never Show Again"}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:g.map(s=>e.jsxs("div",{className:"bg-destructive/10 rounded p-3 border border-destructive/20 flex justify-between items-center",children:[e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:s}),e.jsx("span",{className:"text-xs text-destructive",children:"Permanently Hidden"})]},s))})]}),e.jsx("div",{className:"pt-4 border-t border-border",children:fe?e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded p-4",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-3",children:[e.jsx(v,{className:"text-destructive mt-1",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-destructive",children:"Are you sure?"}),e.jsx("p",{className:"text-sm text-foreground mt-1",children:'This will show all dismissed notifications again, including those marked as "Never Show Again".'})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{variant:"destructive",onClick:Te,children:"Yes, Reset All"}),e.jsx(r,{variant:"secondary",onClick:()=>w(!1),children:"Cancel"})]})]})}):e.jsxs(r,{variant:"destructive",onClick:()=>w(!0),disabled:h.length===0&&g.length===0,children:[e.jsx(V,{size:16}),"Reset All Dismissed Notifications"]})})]})]}),e.jsxs(b,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ze,{className:"text-primary",size:24}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Storage & Data"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-primary/10 rounded-lg p-4 border border-primary/20",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Storage Format"}),e.jsx("div",{className:"text-xl font-bold text-primary flex items-center gap-2",children:re==="2.0.0"?e.jsxs(e.Fragment,{children:[e.jsx(y,{size:18}),"V2 (Unified)"]}):re==="1.0.0"?e.jsxs(e.Fragment,{children:[e.jsx(me,{size:18}),"V1 (Legacy)"]}):"Fresh Install"})]}),e.jsxs("div",{className:"bg-blue-500/10 rounded-lg p-4 border border-blue-500/20",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Storage Size"}),e.jsxs("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400 flex items-center gap-2",children:[e.jsx(Qe,{size:18}),Ie(ke)]})]}),e.jsxs("div",{className:"bg-green-500/10 rounded-lg p-4 border border-green-500/20",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Backup Available"}),e.jsx("div",{className:`text-xl font-bold flex items-center gap-2 ${p.length>0||A?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:p.length>0?`Yes (${p.length} cloud)`:A?"Yes (V1)":"No"})]})]}),e.jsxs("div",{className:"border border-border rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-3 text-foreground",children:"Export & Import Data"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Export your data as a JSON file for backup or transfer to another device."}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(r,{variant:"outline",onClick:Be,children:[e.jsx(xe,{size:16}),"Export Data"]}),e.jsxs("label",{children:[e.jsx("input",{type:"file",accept:".json",onChange:Fe,className:"hidden",disabled:B}),e.jsx(r,{variant:"outline",asChild:!0,disabled:B,children:e.jsx("span",{children:B?e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"animate-spin",size:16}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Xe,{size:16}),"Import Data"]})})})]})]}),G&&e.jsx("p",{className:"text-sm text-destructive mt-2",children:G})]}),A&&e.jsxs("div",{className:"border border-amber-500/30 bg-amber-500/5 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-2 text-foreground flex items-center gap-2",children:[e.jsx(me,{className:"text-amber-500",size:20}),"Rollback to V1"]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"If you're experiencing issues with the new storage system, you can rollback to the previous V1 format. Your V1 backup from the migration will be restored."}),je?e.jsxs("div",{className:"space-y-3 bg-amber-500/10 border border-amber-500/30 rounded p-4",children:[e.jsx("p",{className:"text-sm font-medium text-amber-600 dark:text-amber-400",children:"Are you sure you want to rollback? This will:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Restore your V1 data from backup"}),e.jsx("li",{children:"Remove the V2 unified storage"}),e.jsx("li",{children:"Reload the application"})]}),O&&e.jsx("p",{className:"text-sm text-destructive",children:O}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{variant:"destructive",onClick:Ce,disabled:S,children:S?e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"animate-spin",size:16}),"Rolling back..."]}):"Yes, Rollback"}),e.jsx(r,{variant:"secondary",onClick:()=>U(!1),disabled:S,children:"Cancel"})]})]}):e.jsxs(r,{variant:"outline",onClick:()=>U(!0),className:"border-amber-500/50 hover:bg-amber-500/10",children:[e.jsx(V,{size:16}),"Rollback to V1"]})]})]})]}),!m&&e.jsxs(b,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(k,{className:"text-primary",size:24}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Account & Cloud Sync"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(L,{className:"text-amber-500 shrink-0 mt-0.5",size:20}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground",children:"You're using Guest Mode"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your data is only stored locally on this device. Sign in with Google to enable cloud sync and keep your data safe across all your devices."})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-primary/10 rounded-lg p-4 border border-primary/20",children:[e.jsx(k,{className:"text-primary mb-2",size:24}),e.jsx("h4",{className:"font-medium text-foreground",children:"Cloud Backup"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your data is automatically backed up to Google Drive"})]}),e.jsxs("div",{className:"bg-blue-500/10 rounded-lg p-4 border border-blue-500/20",children:[e.jsx(ue,{className:"text-blue-500 mb-2",size:24}),e.jsx("h4",{className:"font-medium text-foreground",children:"Sync Across Devices"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Access your data from any device, anywhere"})]}),e.jsxs("div",{className:"bg-green-500/10 rounded-lg p-4 border border-green-500/20",children:[e.jsx(y,{className:"text-green-500 mb-2",size:24}),e.jsx("h4",{className:"font-medium text-foreground",children:"Never Lose Data"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your data is safe even if you clear your browser"})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-4 py-4",children:[e.jsxs(r,{size:"lg",onClick:()=>{const s=document.querySelector("[data-google-login]");s&&s.click()},className:"gap-2",children:[e.jsx(k,{size:18}),"Sign in with Google"]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center max-w-md",children:"We only access a dedicated LifeOS folder in your Google Drive. Your other files remain private."})]})]})]}),m&&e.jsxs(b,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[x?e.jsx(k,{className:"text-primary",size:24}):e.jsx(L,{className:"text-muted-foreground",size:24}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Cloud Sync"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-primary/10 rounded-lg p-4 border border-primary/20",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Sync Status"}),e.jsx("div",{className:"text-xl font-bold text-primary flex items-center gap-2",children:x?e.jsxs(e.Fragment,{children:[e.jsx(y,{size:18}),"Connected"]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{size:18}),"Offline"]})})]}),e.jsxs("div",{className:"bg-blue-500/10 rounded-lg p-4 border border-blue-500/20",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Last Synced"}),e.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:Y?ie(Y):"Never"})]})]}),e.jsxs("div",{className:"border border-border rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-2 text-foreground flex items-center gap-2",children:[e.jsx(he,{size:18,className:"text-primary"}),"Cloud Backups"]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Create and manage backups stored directly in your Google Drive. These backups can be restored at any time."}),e.jsx("div",{className:"mb-4",children:e.jsx(r,{onClick:ze,disabled:Z||!x,children:Z?e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"animate-spin",size:16}),"Creating Backup..."]}):Ne?e.jsxs(e.Fragment,{children:[e.jsx(y,{size:16,className:"text-green-500"}),"Backup Created!"]}):e.jsxs(e.Fragment,{children:[e.jsx(he,{size:16}),"Create Cloud Backup"]})})}),ae&&e.jsx("div",{className:"mb-4 p-3 bg-destructive/10 border border-destructive/20 rounded-lg text-destructive text-sm",children:ae}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Your Backups"}),e.jsx(r,{variant:"ghost",size:"sm",onClick:N,disabled:z,children:e.jsx(ue,{size:14,className:z?"animate-spin":""})})]}),z?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(o,{className:"animate-spin text-muted-foreground",size:24})}):p.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No cloud backups found. Create one to get started."}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:p.map(s=>{const t=new Date(s.createdTime);return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-medium text-sm",children:["Backup from"," ",F(t)]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:le(t)})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>Ee(s),disabled:X===s.id,title:"Restore this backup",children:X===s.id?e.jsx(o,{className:"animate-spin",size:14}):e.jsx(V,{size:14})}),e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>Re(s),title:"Download this backup",children:e.jsx(xe,{size:14})}),e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>Ae(s),disabled:se===s.id,className:"text-destructive hover:text-destructive",title:"Delete this backup",children:se===s.id?e.jsx(o,{className:"animate-spin",size:14}):e.jsx(v,{size:14})})]})]},s.id)})})]})]}),e.jsxs("div",{className:"border border-border rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-2 text-foreground flex items-center gap-2",children:[e.jsx(es,{size:18,className:"text-primary"}),"Automatic Backups"]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Schedule automatic backups to keep your data safe. Backups are stored in your Google Drive."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:"auto-backup",className:"cursor-pointer",children:"Enable Automatic Backups"}),e.jsx(Ke,{id:"auto-backup",checked:i.settings?.backup?.autoBackupEnabled??!1,onCheckedChange:s=>R({autoBackupEnabled:s})})]}),i.settings?.backup?.autoBackupEnabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"backup-frequency",children:"Backup Frequency"}),e.jsxs(ne,{value:i.settings?.backup?.frequency??"weekly",onValueChange:s=>R({frequency:s}),children:[e.jsx(ce,{id:"backup-frequency",children:e.jsx(de,{placeholder:"Select frequency"})}),e.jsxs(oe,{children:[e.jsx(d,{value:"daily",children:"Daily"}),e.jsx(d,{value:"every2days",children:"Every 2 Days"}),e.jsx(d,{value:"weekly",children:"Weekly"}),e.jsx(d,{value:"monthly",children:"Monthly"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"max-backups",children:"Maximum Backups to Keep"}),e.jsxs(ne,{value:String(i.settings?.backup?.maxBackups??5),onValueChange:s=>R({maxBackups:parseInt(s,10)}),children:[e.jsx(ce,{id:"max-backups",children:e.jsx(de,{placeholder:"Select max backups"})}),e.jsxs(oe,{children:[e.jsx(d,{value:"3",children:"3 backups"}),e.jsx(d,{value:"5",children:"5 backups"}),e.jsx(d,{value:"10",children:"10 backups"}),e.jsx(d,{value:"20",children:"20 backups"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Older backups will be automatically deleted when this limit is reached."})]}),i.settings?.backup?.lastBackupTime&&e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(ss,{size:14}),"Last auto-backup:"," ",ie(new Date(i.settings.backup.lastBackupTime))]})]})]})]})]})]}),e.jsxs(b,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(v,{className:"text-destructive",size:24}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Danger Zone"})]}),e.jsxs("div",{className:"border border-destructive/30 bg-destructive/5 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-2 text-foreground flex items-center gap-2",children:[e.jsx(v,{className:"text-destructive",size:20}),"Clear All Data"]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:m?"Permanently delete all your data from both local storage and Google Drive. This action cannot be undone. Make sure to download a backup first!":"Permanently delete all your local data. This action cannot be undone. Make sure to export your data first!"}),be?e.jsxs("div",{className:"space-y-3 bg-destructive/10 border border-destructive/30 rounded p-4",children:[e.jsx("p",{className:"text-sm font-medium text-destructive",children:"Are you absolutely sure? This will permanently delete:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground list-disc list-inside space-y-1",children:[e.jsx("li",{children:"All local storage data"}),m&&e.jsx("li",{children:"All cloud data in Google Drive"}),e.jsx("li",{children:"All your tasks, projects, finances, etc."})]}),K&&e.jsx("p",{className:"text-sm text-destructive",children:K}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{variant:"destructive",onClick:De,disabled:D,children:D?e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"animate-spin",size:16}),"Clearing..."]}):"Yes, Delete Everything"}),e.jsx(r,{variant:"secondary",onClick:()=>P(!1),disabled:D,children:"Cancel"})]})]}):e.jsxs(r,{variant:"outline",onClick:()=>P(!0),className:"border-destructive/50 hover:bg-destructive/10 text-destructive",children:[e.jsx(v,{size:16}),"Clear All Data"]})]})]})]})};export{ms as Settings};
