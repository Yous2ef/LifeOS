const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CO4gCy-A.js","assets/radix-ui-CneFSYrq.js","assets/router-CJK1Z2Io.js","assets/react-vendor-pR2cKLDH.js","assets/utils-C1zQmt0N.js","assets/charts-CDpzOIQv.js","assets/dnd-kit-Cy9T72DN.js","assets/index-BTzzHmHW.css"])))=>i.map(i=>d[i]);
import{c as f,u as Ye,i as Le,j as $e,k as Oe,l as Ge,V as _,B as l,S as g,m as qe,n as Pe,r as He,_ as Ke,o as We}from"./index-CO4gCy-A.js";import{j as e,e as Je,f as Ze,g as Qe,V as Xe,P as es,h as ss,i as ts,k as as,l as rs,m as ls,S as is,n as ns}from"./radix-ui-CneFSYrq.js";import{r}from"./router-CJK1Z2Io.js";import{C as N}from"./Card-CES3Mh8O.js";import{L as U}from"./Label-yKW-Cje-.js";import{S as cs}from"./switch-CZlFsQdL.js";import{m as fe,n as os,o as ds,p as ms,B as us,R as M,q as y,r as xs,a as w,s as oe,H as hs,t as de,u as x,U as ps,v as S,w as Y,x as me,y as ue,d as gs,z as fs}from"./utils-C1zQmt0N.js";import"./react-vendor-pR2cKLDH.js";import"./charts-CDpzOIQv.js";import"./dnd-kit-Cy9T72DN.js";function xe({...a}){return e.jsx(Je,{"data-slot":"select",...a})}function he({...a}){return e.jsx(Xe,{"data-slot":"select-value",...a})}function pe({className:a,size:c="default",children:i,...m}){return e.jsxs(Ze,{"data-slot":"select-trigger","data-size":c,className:f("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...m,children:[i,e.jsx(Qe,{asChild:!0,children:e.jsx(fe,{className:"size-4 opacity-50"})})]})}function ge({className:a,children:c,position:i="popper",align:m="center",...C}){return e.jsx(es,{children:e.jsxs(ss,{"data-slot":"select-content",className:f("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",i==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:i,align:m,...C,children:[e.jsx(js,{}),e.jsx(ts,{className:f("p-1",i==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:c}),e.jsx(bs,{})]})})}function u({className:a,children:c,...i}){return e.jsxs(as,{"data-slot":"select-item",className:f("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",a),...i,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(rs,{children:e.jsx(os,{className:"size-4"})})}),e.jsx(ls,{children:c})]})}function js({className:a,...c}){return e.jsx(is,{"data-slot":"select-scroll-up-button",className:f("flex cursor-default items-center justify-center py-1",a),...c,children:e.jsx(ds,{className:"size-4"})})}function bs({className:a,...c}){return e.jsx(ns,{"data-slot":"select-scroll-down-button",className:f("flex cursor-default items-center justify-center py-1",a),...c,children:e.jsx(fe,{className:"size-4"})})}const Es=()=>{const{data:a,updateData:c,dismissedNotifications:i,neverShowAgain:m,resetDismissedNotifications:C,refreshData:je}=Ye(),{isAuthenticated:h}=Le(),{lastSyncTime:L,isCloudMode:p}=$e(),[be,B]=r.useState(!1),[ve,$]=r.useState(!1),[z,O]=r.useState(!1),[G,D]=r.useState(null),[q,P]=r.useState(null),[E,H]=r.useState(!1),[Ne,K]=r.useState(!1),[A,W]=r.useState(!1),[J,Z]=r.useState(null),[j,ye]=r.useState([]),[R,Q]=r.useState(!1),[X,ee]=r.useState(!1),[ke,I]=r.useState(!1),[se,te]=r.useState(null),[ae,re]=r.useState(null),[le,o]=r.useState(null),[ie,we]=r.useState(null),[Se,Ce]=r.useState(0),[T,Be]=r.useState(!1);r.useEffect(()=>{const s=Oe();we(s),Be(Ge());const t=localStorage.getItem(_);t&&Ce(new Blob([t]).size)},[]);const ze=async()=>{O(!0),D(null);try{He()?(localStorage.removeItem(_),window.location.reload()):D("No backup found to restore.")}catch(s){D(s instanceof Error?s.message:"Rollback failed")}finally{O(!1)}},De=()=>{qe()},Ee=async()=>{W(!0),Z(null);try{await g.delete(We.MAIN_DATA),localStorage.removeItem(_),window.location.reload()}catch(s){Z(s instanceof Error?s.message:"Failed to clear data"),W(!1)}},k=async()=>{if(p){Q(!0);try{const s=await g.listCloudBackups();ye(s)}catch(s){console.error("Failed to load backups:",s)}finally{Q(!1)}}},Ae=async()=>{ee(!0),o(null),I(!1);try{const s=await g.createCloudBackup();if(s.success){I(!0),setTimeout(()=>I(!1),3e3);const t=a.settings?.backup?.maxBackups??5;await g.cleanupOldBackups(t),c({settings:{...a.settings,backup:{...a.settings?.backup??{autoBackupEnabled:!1,frequency:"weekly",maxBackups:5},lastBackupTime:Date.now()}}}),await k()}else o(s.error||"Backup failed")}catch(s){o(s instanceof Error?s.message:"Backup failed")}finally{ee(!1)}},Re=async s=>{if(confirm(`Are you sure you want to restore from "${s.name}"? Your current data will be overwritten.`)){te(s.id),o(null);try{const t=await g.restoreCloudBackup(s.fileName);t.success?window.location.reload():o(t.error||"Restore failed")}catch(t){o(t instanceof Error?t.message:"Restore failed")}finally{te(null)}}},Ie=async s=>{if(confirm(`Are you sure you want to delete "${s.name}"?`)){re(s.id),o(null);try{const t=await g.deleteCloudBackup(s.fileName);t.success?await k():o(t.error||"Delete failed")}catch(t){o(t instanceof Error?t.message:"Delete failed")}finally{re(null)}}},Te=async s=>{try{const{DriveService:t}=await Ke(async()=>{const{DriveService:d}=await import("./index-CO4gCy-A.js").then(b=>b.E);return{DriveService:d}},__vite__mapDeps([0,1,2,3,4,5,6,7])),n=await t.restoreBackup(s.fileName);if(n){const d=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),b=URL.createObjectURL(d),v=document.createElement("a");v.href=b;const Me=new Date(s.createdTime);v.download=`lifeos-backup-${Me.toISOString().split("T")[0]}.json`,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(b)}else o("Failed to download backup")}catch(t){o(t instanceof Error?t.message:"Download failed")}},F=s=>{c({settings:{...a.settings,backup:{...a.settings?.backup??{autoBackupEnabled:!1,frequency:"weekly",lastBackupTime:null,maxBackups:5},...s}}})};r.useEffect(()=>{p&&h&&k()},[p,h]);const Fe=async s=>{const t=s.target.files?.[0];if(t){H(!0),P(null);try{await Pe(t),je(),s.target.value=""}catch(n){P(n instanceof Error?n.message:"Import failed")}finally{H(!1)}}},Ve=s=>{if(s===0)return"0 Bytes";const t=1024,n=["Bytes","KB","MB","GB"],d=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,d)).toFixed(2))+" "+n[d]},V=s=>{const t=s.getFullYear(),n=String(s.getMonth()+1).padStart(2,"0"),d=String(s.getDate()).padStart(2,"0");return`${t}-${n}-${d}`},ne=s=>{const t=s.getHours(),n=String(s.getMinutes()).padStart(2,"0"),d=t>=12?"PM":"AM";return`${t%12||12}:${n} ${d}`},ce=s=>`${V(s)} ${ne(s)}`,_e=()=>{C(),B(!1)},Ue=i.filter(s=>s.dismissUntil?new Date(s.dismissUntil)>new Date:!0).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ms,{className:"text-primary",size:32}),e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Settings"})]}),e.jsxs(N,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(us,{className:"text-primary",size:24}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Notification Settings"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-primary/10 rounded-lg p-4 border border-primary/20",children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:Ue}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Currently Dismissed"})]}),e.jsxs("div",{className:"bg-destructive/10 rounded-lg p-4 border border-destructive/20",children:[e.jsx("div",{className:"text-3xl font-bold text-destructive",children:m.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Never Show Again"})]}),e.jsxs("div",{className:"bg-green-500/10 rounded-lg p-4 border border-green-500/20",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:i.length+m.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Dismissed"})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 border border-border",children:[e.jsx("h3",{className:"font-semibold text-lg mb-3 text-foreground",children:"How Notification Dismissal Works"}),e.jsxs("ul",{className:"space-y-2 text-sm text-foreground",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-primary mt-1",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Session Only:"})," Notification is hidden until you close and reopen the app"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600 dark:text-green-400 mt-1",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"For 1 Day:"})," Notification will reappear after 24 hours"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-yellow-600 dark:text-yellow-400 mt-1",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"For 1 Week:"})," Notification will reappear after 7 days"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-destructive mt-1",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Never Show Again:"})," ","Notification is permanently hidden"]})]})]})]}),i.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-3 text-foreground",children:"Dismissed Notifications"}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:i.map(s=>{const t=s.dismissUntil&&new Date(s.dismissUntil)<new Date,n=s.dismissUntil?t?"Expired (will show again)":`Until ${V(new Date(s.dismissUntil))}`:"Until next session";return e.jsx("div",{className:"bg-muted/50 rounded p-3 border border-border flex justify-between items-center",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:s.id}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:n})]})},s.id)})})]}),m.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-3 text-foreground",children:"Never Show Again"}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:m.map(s=>e.jsxs("div",{className:"bg-destructive/10 rounded p-3 border border-destructive/20 flex justify-between items-center",children:[e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:s}),e.jsx("span",{className:"text-xs text-destructive",children:"Permanently Hidden"})]},s))})]}),e.jsx("div",{className:"pt-4 border-t border-border",children:be?e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded p-4",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-3",children:[e.jsx(y,{className:"text-destructive mt-1",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-destructive",children:"Are you sure?"}),e.jsx("p",{className:"text-sm text-foreground mt-1",children:'This will show all dismissed notifications again, including those marked as "Never Show Again".'})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"destructive",onClick:_e,children:"Yes, Reset All"}),e.jsx(l,{variant:"secondary",onClick:()=>B(!1),children:"Cancel"})]})]})}):e.jsxs(l,{variant:"destructive",onClick:()=>B(!0),disabled:i.length===0&&m.length===0,children:[e.jsx(M,{size:16}),"Reset All Dismissed Notifications"]})})]})]}),e.jsxs(N,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(xs,{className:"text-primary",size:24}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Storage & Data"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-primary/10 rounded-lg p-4 border border-primary/20",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Storage Format"}),e.jsx("div",{className:"text-xl font-bold text-primary flex items-center gap-2",children:ie==="2.0.0"?e.jsxs(e.Fragment,{children:[e.jsx(w,{size:18}),"V2 (Unified)"]}):ie==="1.0.0"?e.jsxs(e.Fragment,{children:[e.jsx(oe,{size:18}),"V1 (Legacy)"]}):"Fresh Install"})]}),e.jsxs("div",{className:"bg-blue-500/10 rounded-lg p-4 border border-blue-500/20",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Storage Size"}),e.jsxs("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400 flex items-center gap-2",children:[e.jsx(hs,{size:18}),Ve(Se)]})]}),e.jsxs("div",{className:"bg-green-500/10 rounded-lg p-4 border border-green-500/20",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Backup Available"}),e.jsx("div",{className:`text-xl font-bold flex items-center gap-2 ${j.length>0||T?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:j.length>0?`Yes (${j.length} cloud)`:T?"Yes (V1)":"No"})]})]}),e.jsxs("div",{className:"border border-border rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-3 text-foreground",children:"Export & Import Data"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Export your data as a JSON file for backup or transfer to another device."}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(l,{variant:"outline",onClick:De,children:[e.jsx(de,{size:16}),"Export Data"]}),e.jsxs("label",{children:[e.jsx("input",{type:"file",accept:".json",onChange:Fe,className:"hidden",disabled:E}),e.jsx(l,{variant:"outline",asChild:!0,disabled:E,children:e.jsx("span",{children:E?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"animate-spin",size:16}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ps,{size:16}),"Import Data"]})})})]})]}),q&&e.jsx("p",{className:"text-sm text-destructive mt-2",children:q})]}),T&&e.jsxs("div",{className:"border border-amber-500/30 bg-amber-500/5 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-2 text-foreground flex items-center gap-2",children:[e.jsx(oe,{className:"text-amber-500",size:20}),"Rollback to V1"]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"If you're experiencing issues with the new storage system, you can rollback to the previous V1 format. Your V1 backup from the migration will be restored."}),ve?e.jsxs("div",{className:"space-y-3 bg-amber-500/10 border border-amber-500/30 rounded p-4",children:[e.jsx("p",{className:"text-sm font-medium text-amber-600 dark:text-amber-400",children:"Are you sure you want to rollback? This will:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Restore your V1 data from backup"}),e.jsx("li",{children:"Remove the V2 unified storage"}),e.jsx("li",{children:"Reload the application"})]}),G&&e.jsx("p",{className:"text-sm text-destructive",children:G}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"destructive",onClick:ze,disabled:z,children:z?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"animate-spin",size:16}),"Rolling back..."]}):"Yes, Rollback"}),e.jsx(l,{variant:"secondary",onClick:()=>$(!1),disabled:z,children:"Cancel"})]})]}):e.jsxs(l,{variant:"outline",onClick:()=>$(!0),className:"border-amber-500/50 hover:bg-amber-500/10",children:[e.jsx(M,{size:16}),"Rollback to V1"]})]})]})]}),!h&&e.jsxs(N,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(S,{className:"text-primary",size:24}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Account & Cloud Sync"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Y,{className:"text-amber-500 shrink-0 mt-0.5",size:20}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground",children:"You're using Guest Mode"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your data is only stored locally on this device. Sign in with Google to enable cloud sync and keep your data safe across all your devices."})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-primary/10 rounded-lg p-4 border border-primary/20",children:[e.jsx(S,{className:"text-primary mb-2",size:24}),e.jsx("h4",{className:"font-medium text-foreground",children:"Cloud Backup"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your data is automatically backed up to Google Drive"})]}),e.jsxs("div",{className:"bg-blue-500/10 rounded-lg p-4 border border-blue-500/20",children:[e.jsx(me,{className:"text-blue-500 mb-2",size:24}),e.jsx("h4",{className:"font-medium text-foreground",children:"Sync Across Devices"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Access your data from any device, anywhere"})]}),e.jsxs("div",{className:"bg-green-500/10 rounded-lg p-4 border border-green-500/20",children:[e.jsx(w,{className:"text-green-500 mb-2",size:24}),e.jsx("h4",{className:"font-medium text-foreground",children:"Never Lose Data"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your data is safe even if you clear your browser"})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-4 py-4",children:[e.jsxs(l,{size:"lg",onClick:()=>{const s=document.querySelector("[data-google-login]");s&&s.click()},className:"gap-2",children:[e.jsx(S,{size:18}),"Sign in with Google"]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center max-w-md",children:"We only access a dedicated LifeOS folder in your Google Drive. Your other files remain private."})]})]})]}),h&&e.jsxs(N,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[p?e.jsx(S,{className:"text-primary",size:24}):e.jsx(Y,{className:"text-muted-foreground",size:24}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Cloud Sync"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-primary/10 rounded-lg p-4 border border-primary/20",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Sync Status"}),e.jsx("div",{className:"text-xl font-bold text-primary flex items-center gap-2",children:p?e.jsxs(e.Fragment,{children:[e.jsx(w,{size:18}),"Connected"]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{size:18}),"Offline"]})})]}),e.jsxs("div",{className:"bg-blue-500/10 rounded-lg p-4 border border-blue-500/20",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Last Synced"}),e.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:L?ce(L):"Never"})]})]}),e.jsxs("div",{className:"border border-border rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-2 text-foreground flex items-center gap-2",children:[e.jsx(ue,{size:18,className:"text-primary"}),"Cloud Backups"]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Create and manage backups stored directly in your Google Drive. These backups can be restored at any time."}),e.jsx("div",{className:"mb-4",children:e.jsx(l,{onClick:Ae,disabled:X||!p,children:X?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"animate-spin",size:16}),"Creating Backup..."]}):ke?e.jsxs(e.Fragment,{children:[e.jsx(w,{size:16,className:"text-green-500"}),"Backup Created!"]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{size:16}),"Create Cloud Backup"]})})}),le&&e.jsx("div",{className:"mb-4 p-3 bg-destructive/10 border border-destructive/20 rounded-lg text-destructive text-sm",children:le}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Your Backups"}),e.jsx(l,{variant:"ghost",size:"sm",onClick:k,disabled:R,children:e.jsx(me,{size:14,className:R?"animate-spin":""})})]}),R?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(x,{className:"animate-spin text-muted-foreground",size:24})}):j.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No cloud backups found. Create one to get started."}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:j.map(s=>{const t=new Date(s.createdTime);return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-medium text-sm",children:["Backup from"," ",V(t)]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:ne(t)})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>Re(s),disabled:se===s.id,title:"Restore this backup",children:se===s.id?e.jsx(x,{className:"animate-spin",size:14}):e.jsx(M,{size:14})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>Te(s),title:"Download this backup",children:e.jsx(de,{size:14})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>Ie(s),disabled:ae===s.id,className:"text-destructive hover:text-destructive",title:"Delete this backup",children:ae===s.id?e.jsx(x,{className:"animate-spin",size:14}):e.jsx(y,{size:14})})]})]},s.id)})})]})]}),e.jsxs("div",{className:"border border-border rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-2 text-foreground flex items-center gap-2",children:[e.jsx(gs,{size:18,className:"text-primary"}),"Automatic Backups"]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Schedule automatic backups to keep your data safe. Backups are stored in your Google Drive."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(U,{htmlFor:"auto-backup",className:"cursor-pointer",children:"Enable Automatic Backups"}),e.jsx(cs,{id:"auto-backup",checked:a.settings?.backup?.autoBackupEnabled??!1,onCheckedChange:s=>F({autoBackupEnabled:s})})]}),a.settings?.backup?.autoBackupEnabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"backup-frequency",children:"Backup Frequency"}),e.jsxs(xe,{value:a.settings?.backup?.frequency??"weekly",onValueChange:s=>F({frequency:s}),children:[e.jsx(pe,{id:"backup-frequency",children:e.jsx(he,{placeholder:"Select frequency"})}),e.jsxs(ge,{children:[e.jsx(u,{value:"daily",children:"Daily"}),e.jsx(u,{value:"every2days",children:"Every 2 Days"}),e.jsx(u,{value:"weekly",children:"Weekly"}),e.jsx(u,{value:"monthly",children:"Monthly"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"max-backups",children:"Maximum Backups to Keep"}),e.jsxs(xe,{value:String(a.settings?.backup?.maxBackups??5),onValueChange:s=>F({maxBackups:parseInt(s,10)}),children:[e.jsx(pe,{id:"max-backups",children:e.jsx(he,{placeholder:"Select max backups"})}),e.jsxs(ge,{children:[e.jsx(u,{value:"3",children:"3 backups"}),e.jsx(u,{value:"5",children:"5 backups"}),e.jsx(u,{value:"10",children:"10 backups"}),e.jsx(u,{value:"20",children:"20 backups"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Older backups will be automatically deleted when this limit is reached."})]}),a.settings?.backup?.lastBackupTime&&e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(fs,{size:14}),"Last auto-backup:"," ",ce(new Date(a.settings.backup.lastBackupTime))]})]})]})]})]})]}),e.jsxs(N,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{className:"text-destructive",size:24}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Danger Zone"})]}),e.jsxs("div",{className:"border border-destructive/30 bg-destructive/5 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-2 text-foreground flex items-center gap-2",children:[e.jsx(y,{className:"text-destructive",size:20}),"Clear All Data"]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:h?"Permanently delete all your data from both local storage and Google Drive. This action cannot be undone. Make sure to download a backup first!":"Permanently delete all your local data. This action cannot be undone. Make sure to export your data first!"}),Ne?e.jsxs("div",{className:"space-y-3 bg-destructive/10 border border-destructive/30 rounded p-4",children:[e.jsx("p",{className:"text-sm font-medium text-destructive",children:"Are you absolutely sure? This will permanently delete:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground list-disc list-inside space-y-1",children:[e.jsx("li",{children:"All local storage data"}),h&&e.jsx("li",{children:"All cloud data in Google Drive"}),e.jsx("li",{children:"All your tasks, projects, finances, etc."})]}),J&&e.jsx("p",{className:"text-sm text-destructive",children:J}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"destructive",onClick:Ee,disabled:A,children:A?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"animate-spin",size:16}),"Clearing..."]}):"Yes, Delete Everything"}),e.jsx(l,{variant:"secondary",onClick:()=>K(!1),disabled:A,children:"Cancel"})]})]}):e.jsxs(l,{variant:"outline",onClick:()=>K(!0),className:"border-destructive/50 hover:bg-destructive/10 text-destructive",children:[e.jsx(y,{size:16}),"Clear All Data"]})]})]})]})};export{Es as Settings};
