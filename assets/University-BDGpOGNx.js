import{j as e}from"./radix-ui-C3V2uSY1.js";import{r as g,u as us}from"./router-BQf8R6iK.js";import{K as hs,a as Ie}from"./KanbanCard-BSpEv_h4.js";import{L as js,a as gs}from"./ListCard-CoOqD34c.js";import{g as Y,j as z,B as j,u as Je,M as Qe,D as Me,k as Ae,l as De,C as Le,m as ue,n as _,o as Oe,t as Fe,x as Ge,y as ze,w as Be,s as He}from"./index-Dn5yG4Az.js";import{C as M,a as A,b as V,c as K}from"./Card-COpkhGGM.js";import{P as Te}from"./progress-C1RbQUJh.js";import{T as fs,a as ps,b as oe,c as me}from"./tabs-BW2NOjDq.js";import{c as Se,g as Ne,E as vs,S as Ns,T as bs,a as ys,M as ws}from"./MarkExamModal-yHfPPaM1.js";import{h as we,M as ks,z as ie,P as R,T as ae,g as he,i as $e,aa as Cs,ab as Re,ac as Ts,j as Ee,X as Ue,G as Ss,r as We,C as Es,o as Ve,_ as Ms,N as be,J as As,v as Ke,O as Ds,Q as $s,E as Ps}from"./utils-MsfPC-Eo.js";import{F as _e}from"./TextArea-C7vAED9K.js";import{F as re}from"./FormSelect-BwTQkGvn.js";import"./react-vendor-pR2cKLDH.js";import"./dnd-kit-VvYmaRfD.js";import"./charts-5ZM4_dsB.js";const Ys=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],xe=[{hour:8,display:"08:00 - 10:00"},{hour:10,display:"10:00 - 12:00"},{hour:12,display:"12:00 - 2:00"},{hour:14,display:"2:00 - 4:00"},{hour:16,display:"4:00 - 6:00"}],ye=y=>{const[t,c]=y.split(":").map(Number);return t+c/60},Is=({subjects:y,onEditSchedule:t})=>{const c=g.useMemo(()=>{const a={};return y.forEach(u=>{u.lectures?.forEach(d=>{a[d.day]||(a[d.day]=[]);const o=ye(d.startTime),f=ye(d.endTime),S=f-o;a[d.day].push({subject:u,entry:d,type:"lecture",startHour:o,endHour:f,duration:S})}),u.sections?.forEach(d=>{a[d.day]||(a[d.day]=[]);const o=ye(d.startTime),f=ye(d.endTime),S=f-o;a[d.day].push({subject:u,entry:d,type:"section",startHour:o,endHour:f,duration:S})})}),a},[y]),v=(a,u)=>{const d=xe.findIndex(C=>C.hour===Math.floor(a));let o=xe.findIndex(C=>C.hour>=Math.ceil(u));o===-1&&(o=xe.length);const f=d+2,S=Math.max(1,o-d);return{start:f,span:S}},I=y.some(a=>a.lectures&&a.lectures.length>0||a.sections&&a.sections.length>0);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(M,{className:"p-0",dir:"ltr",children:I?e.jsx(M,{className:"h-ful p-0",children:e.jsx(A,{className:"p-0 m-0",children:e.jsx("div",{className:"overflow-x-auto overflow-y-hidden h-full",children:e.jsxs("div",{className:"min-w-[1000px]",children:[e.jsxs("div",{className:"grid grid-cols-[120px_repeat(5,1fr)] border-b",children:[e.jsx("div",{className:"p-3 font-semibold border-r bg-muted/50",children:"Day / Time"}),xe.map(a=>e.jsx("div",{className:"p-2 text-center items-center justify-center pt-3 text-base font-medium border-r last:border-r-0 bg-muted/50",children:a.display},a.hour))]}),Ys.map(a=>{const u=c[a]||[],d=u.length>0;return e.jsxs("div",{className:Y("grid grid-cols-[120px_repeat(5,1fr)] border-b last:border-b-0 relative",d?"min-h-[120px]":"min-h-[20px]"),children:[e.jsx("div",{className:Y("p-3 font-medium border-r bg-muted/30 flex items-center",d?"text-primary":"text-muted-foreground"),children:a}),xe.map(o=>e.jsx("div",{className:"border-r last:border-r-0"},`${a}-${o.hour}-bg`)),u.map((o,f)=>{const{start:S,span:C}=v(o.startHour,o.endHour),m=o.type==="lecture",E=o.subject.color;return e.jsxs("div",{className:Y("absolute rounded-lg p-3 text-base cursor-pointer transition-all hover:shadow-lg hover:z-10","border-2 flex flex-col justify-center"),style:{gridColumn:`${S} / span ${C}`,backgroundColor:m?`${E}80`:`${E}20`,borderColor:E,top:"8px",bottom:"8px",left:"4px",right:"4px"},onClick:()=>t(o.subject.id),children:[e.jsx("div",{className:"font-semibold truncate text-[14px]",children:o.subject.name}),e.jsx("div",{className:"text-[12px] font-[700] opacity-100 truncate mt-0.5",children:m?"Lecture":"Section"}),m&&o.subject.professor&&e.jsx("div",{className:"text-[10px] opacity-100 truncate my-0.5",children:o.subject.professor}),o.entry.location&&e.jsxs("div",{className:"flex items-center gap-1 mt-0.5 text-[12px] font-medium opacity-70",children:[e.jsx(ks,{className:"w-3 h-3 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:o.entry.location})]})]},`${o.subject.id}-${o.type}-${f}`)})]},a)})]})})})}):e.jsx(A,{className:"py-12",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(we,{className:"w-12 h-12 mx-auto text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Schedule Yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Add lecture and section times to your subjects to see your timetable"}),e.jsx("p",{className:"text-sm text-primary",children:'Scroll down to "Manage Schedules" section and click "Add Schedule" on any subject'})]})]})})}),e.jsxs(M,{children:[e.jsx(V,{children:e.jsx(K,{className:"text-lg",children:"Manage Schedules"})}),e.jsx(A,{children:e.jsxs("div",{className:"space-y-3",children:[y.map(a=>{const u=a.lectures&&a.lectures.length>0,d=a.sections&&a.sections.length>0;return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:a.color}}),e.jsx("span",{className:"font-medium",children:a.name})]}),e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-4 mt-1",children:[u&&e.jsx("span",{className:"flex items-center gap-1",children:e.jsxs(z,{variant:"outline",style:{borderColor:a.color,color:a.color},children:[a.lectures.length," ","Lecture",a.lectures.length!==1?"s":""]})}),d&&e.jsx("span",{className:"flex items-center gap-1",children:e.jsxs(z,{variant:"outline",style:{borderColor:a.color,color:a.color,opacity:.8},children:[a.sections.length," ","Section",a.sections.length!==1?"s":""]})}),!u&&!d&&e.jsx("span",{className:"text-muted-foreground",children:"No schedule set"})]})]}),e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>t(a.id),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),u||d?"Edit":"Add"," ","Schedule"]})]},a.id)}),y.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No subjects yet. Add a subject first to create a schedule."})]})})]})]})},qe=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Ls=()=>{const y=[];for(let t=8;t<=18;t++)for(let c=0;c<60;c+=30){const v=`${t.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`,I=t>12?t-12:t===0?12:t,a=t>=12?"PM":"AM",u=`${I}:${c.toString().padStart(2,"0")} ${a}`;y.push({value:v,label:u})}return y},Os=({isOpen:y,onClose:t,subject:c})=>{const{data:v,updateData:I,showToast:a}=Je(),[u,d]=g.useState([]),[o,f]=g.useState([]);g.useEffect(()=>{c&&y?(d(c.lectures||[]),f(c.sections||[])):c||(d([]),f([]))},[c,y]);const S=()=>{d([...u,{day:"Monday",startTime:"09:00",endTime:"10:30",location:""}])},C=()=>{f([...o,{day:"Monday",startTime:"14:00",endTime:"15:30",location:""}])},m=p=>{d(u.filter((h,x)=>x!==p))},E=p=>{f(o.filter((h,x)=>x!==p))},D=(p,h,x)=>{const F=[...u];F[p]={...F[p],[h]:x},d(F)},$=(p,h,x)=>{const F=[...o];F[p]={...F[p],[h]:x},f(F)},B=()=>{const p=[...u,...o];for(const h of p){const[x,F]=h.startTime.split(":").map(Number),[se,le]=h.endTime.split(":").map(Number),q=x*60+F,ce=se*60+le;if(q>=ce)return a("End time must be after start time","error"),!1}return!0},ee=p=>{if(p.preventDefault(),!c){a("No subject selected","error");return}if(!B())return;const h={...c,lectures:u.length>0?u:void 0,sections:o.length>0?o:void 0};I({university:{...v.university,subjects:v.university.subjects.map(x=>x.id===c.id?h:x)}}),a("Schedule updated successfully!","success"),t()},U=Ls();return e.jsx(Qe,{isOpen:y,onClose:t,title:`Edit Schedule - ${c?.name||""}`,footer:e.jsxs(e.Fragment,{children:[e.jsx(j,{variant:"secondary",onClick:t,children:"Cancel"}),e.jsx(j,{variant:"default",onClick:ee,children:"Save Schedule"})]}),children:e.jsxs("form",{onSubmit:ee,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold flex items-center gap-2",children:e.jsx(z,{variant:"outline",className:"text-blue-500 border-blue-500",children:"Lectures"})}),e.jsxs(j,{type:"button",variant:"outline",size:"sm",onClick:S,children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Add Lecture"]})]}),u.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4 border rounded-lg",children:'No lectures scheduled. Click "Add Lecture" to add one.'}),u.map((p,h)=>e.jsxs("div",{className:"p-4 border rounded-lg space-y-3 bg-blue-500/5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Lecture ",h+1]}),e.jsx(j,{type:"button",variant:"ghost",size:"sm",onClick:()=>m(h),children:e.jsx(ae,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(re,{label:"Day",name:`lecture-day-${h}`,value:p.day,onChange:x=>D(h,"day",x.target.value),options:qe.map(x=>({value:x,label:x}))}),e.jsx(_e,{label:"Location",name:`lecture-location-${h}`,value:p.location,onChange:x=>D(h,"location",x.target.value),placeholder:"e.g., Room 101"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(re,{label:"Start Time",name:`lecture-start-${h}`,value:p.startTime,onChange:x=>D(h,"startTime",x.target.value),options:U}),e.jsx(re,{label:"End Time",name:`lecture-end-${h}`,value:p.endTime,onChange:x=>D(h,"endTime",x.target.value),options:U})]})]},`lecture-${h}`))]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold flex items-center gap-2",children:e.jsx(z,{variant:"outline",className:"text-green-500 border-green-500",children:"Sections"})}),e.jsxs(j,{type:"button",variant:"outline",size:"sm",onClick:C,children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Add Section"]})]}),o.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4 border rounded-lg",children:'No sections scheduled. Click "Add Section" to add one.'}),o.map((p,h)=>e.jsxs("div",{className:"p-4 border rounded-lg space-y-3 bg-green-500/5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Section ",h+1]}),e.jsx(j,{type:"button",variant:"ghost",size:"sm",onClick:()=>E(h),children:e.jsx(ae,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(re,{label:"Day",name:`section-day-${h}`,value:p.day,onChange:x=>$(h,"day",x.target.value),options:qe.map(x=>({value:x,label:x}))}),e.jsx(_e,{label:"Location",name:`section-location-${h}`,value:p.location,onChange:x=>$(h,"location",x.target.value),placeholder:"e.g., Lab 203"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(re,{label:"Start Time",name:`section-start-${h}`,value:p.startTime,onChange:x=>$(h,"startTime",x.target.value),options:U}),e.jsx(re,{label:"End Time",name:`section-end-${h}`,value:p.endTime,onChange:x=>$(h,"endTime",x.target.value),options:U})]})]},`section-${h}`))]})]})})},Fs=({years:y,terms:t,currentYearId:c,currentTermId:v,onYearChange:I,onTermChange:a,onManageClick:u})=>{const d=[...y].sort((m,E)=>m.order-E.order),o=y.find(m=>m.id===c),f=t.find(m=>m.id===v),S=c?t.filter(m=>m.yearId===c).sort((m,E)=>m.order-E.order):[],C=m=>{I(m),m&&v&&(t.some(D=>D.id===v&&D.yearId===m)||a(void 0))};return e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs(Me,{children:[e.jsx(Ae,{asChild:!0,children:e.jsxs(j,{variant:"outline",className:"gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),c==="unassigned"?"Unassigned":o?o.name:"All Years",e.jsx($e,{className:"h-4 w-4 opacity-50"})]})}),e.jsxs(De,{align:"start",className:"w-48",children:[e.jsx(Le,{children:"Academic Year"}),e.jsx(ue,{}),e.jsxs(_,{onClick:()=>C(void 0),className:Y(!c&&"bg-accent"),children:[e.jsx("span",{className:"flex-1",children:"All Years"}),!c&&e.jsx(z,{variant:"secondary",className:"ml-2 text-xs",children:"Selected"})]}),e.jsxs(_,{onClick:()=>C("unassigned"),className:Y(c==="unassigned"&&"bg-accent"),children:[e.jsx("span",{className:"flex-1",children:"Unassigned"}),c==="unassigned"&&e.jsx(z,{variant:"secondary",className:"ml-2 text-xs",children:"Selected"})]}),d.length>0&&e.jsx(ue,{}),d.map(m=>e.jsxs(_,{onClick:()=>C(m.id),className:Y(c===m.id&&"bg-accent"),children:[e.jsx("span",{className:"flex-1",children:m.name}),m.isActive&&e.jsx(z,{variant:"default",className:"ml-2 text-xs",children:"Active"}),c===m.id&&!m.isActive&&e.jsx(z,{variant:"secondary",className:"ml-2 text-xs",children:"Selected"})]},m.id)),d.length===0&&e.jsx(_,{disabled:!0,className:"text-muted-foreground",children:"No years added yet"})]})]}),c&&c!=="unassigned"&&e.jsxs(Me,{children:[e.jsx(Ae,{asChild:!0,children:e.jsxs(j,{variant:"outline",className:"gap-2",children:[f?f.name:"All Terms",e.jsx($e,{className:"h-4 w-4 opacity-50"})]})}),e.jsxs(De,{align:"start",className:"w-48",children:[e.jsx(Le,{children:"Term / Semester"}),e.jsx(ue,{}),e.jsxs(_,{onClick:()=>a(void 0),className:Y(!v&&"bg-accent"),children:[e.jsx("span",{className:"flex-1",children:"All Terms"}),!v&&e.jsx(z,{variant:"secondary",className:"ml-2 text-xs",children:"Selected"})]}),S.length>0&&e.jsx(ue,{}),S.map(m=>e.jsxs(_,{onClick:()=>a(m.id),className:Y(v===m.id&&"bg-accent"),children:[e.jsx("span",{className:"flex-1",children:m.name}),v===m.id&&e.jsx(z,{variant:"secondary",className:"ml-2 text-xs",children:"Selected"})]},m.id)),S.length===0&&e.jsx(_,{disabled:!0,className:"text-muted-foreground",children:"No terms for this year"})]})]}),e.jsx(j,{variant:"ghost",size:"icon",onClick:u,title:"Manage Years & Terms",children:e.jsx(Cs,{className:"h-4 w-4"})}),(c||v)&&e.jsx(z,{variant:"outline",className:"text-xs",children:"Filtered"})]})},Gs=({isOpen:y,onClose:t,years:c,terms:v,onSave:I})=>{const[a,u]=g.useState([]),[d,o]=g.useState([]),[f,S]=g.useState(new Set),[C,m]=g.useState(null),[E,D]=g.useState(null),[$,B]=g.useState("");g.useEffect(()=>{y&&(u([...c].sort((r,l)=>r.order-l.order)),o([...v]),S(new Set(c.map(r=>r.id))),m(null),D(null))},[y,c,v]);const ee=r=>{const l=new Set(f);l.has(r)?l.delete(r):l.add(r),S(l)},U=()=>{const r=a.length>0?Math.max(...a.map(w=>w.order))+1:1,l={id:Oe(),name:`Year ${r}`,order:r,isActive:a.length===0,createdAt:new Date().toISOString()};u([...a,l]),S(new Set([...f,l.id])),m(l.id),B(l.name)},p=r=>{confirm("Delete this year and all its terms? Subjects will become unassigned.")&&(u(a.filter(l=>l.id!==r)),o(d.filter(l=>l.yearId!==r)))},h=(r,l)=>{u(a.map(w=>w.id===r?{...w,...l}:w))},x=r=>{u(a.map(l=>({...l,isActive:l.id===r})))},F=r=>{const l=d.filter(b=>b.yearId===r),w=l.length>0?Math.max(...l.map(b=>b.order))+1:1,k={id:Oe(),yearId:r,name:`Term ${w}`,order:w,createdAt:new Date().toISOString()};o([...d,k]),D(k.id),B(k.name)},se=r=>{confirm("Delete this term? Subjects will become unassigned.")&&o(d.filter(l=>l.id!==r))},le=(r,l)=>{o(d.map(w=>w.id===r?{...w,...l}:w))},q=r=>{m(r.id),B(r.name),D(null)},ce=r=>{D(r.id),B(r.name),m(null)},W=()=>{C&&$.trim()&&h(C,{name:$.trim()}),E&&$.trim()&&le(E,{name:$.trim()}),m(null),D(null),B("")},ne=()=>{m(null),D(null),B("")},je=()=>{I(a,d),t()},ge=r=>d.filter(l=>l.yearId===r).sort((l,w)=>l.order-w.order);return e.jsx(Qe,{isOpen:y,onClose:t,title:"Manage Academic Years & Terms",footer:e.jsxs(e.Fragment,{children:[e.jsx(j,{variant:"secondary",onClick:t,children:"Cancel"}),e.jsx(j,{onClick:je,children:"Save Changes"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Organize your subjects by academic year and term/semester."}),e.jsxs(j,{onClick:U,size:"sm",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Add Year"]})]}),a.length===0?e.jsx(M,{children:e.jsxs(A,{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(he,{className:"h-12 w-12 text-muted-foreground mb-3 opacity-50"}),e.jsx("h3",{className:"font-semibold mb-1",children:"No Academic Years"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Add your first academic year to get started"}),e.jsxs(j,{onClick:U,children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Add Year"]})]})}):e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:a.map(r=>e.jsxs(M,{className:"overflow-hidden",children:[e.jsxs("div",{className:Y("flex items-center gap-2 p-3 bg-muted/30 cursor-pointer hover:bg-muted/50 transition-colors",r.isActive&&"border-l-4 border-l-primary"),onClick:()=>ee(r.id),children:[e.jsx(Re,{className:"h-4 w-4 text-muted-foreground cursor-grab"}),f.has(r.id)?e.jsx($e,{className:"h-4 w-4"}):e.jsx(Ts,{className:"h-4 w-4"}),C===r.id?e.jsxs("div",{className:"flex items-center gap-2 flex-1",onClick:l=>l.stopPropagation(),children:[e.jsx("input",{type:"text",value:$,onChange:l=>B(l.target.value),className:"flex-1 px-2 py-1 text-sm border rounded bg-background",autoFocus:!0,onKeyDown:l=>{l.key==="Enter"&&W(),l.key==="Escape"&&ne()}}),e.jsx(j,{size:"icon-sm",variant:"ghost",onClick:W,children:e.jsx(Ee,{className:"h-4 w-4 text-green-500"})}),e.jsx(j,{size:"icon-sm",variant:"ghost",onClick:ne,children:e.jsx(Ue,{className:"h-4 w-4 text-red-500"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-medium flex-1",children:r.name}),r.isActive&&e.jsx(z,{variant:"default",className:"text-xs",children:"Active"}),e.jsxs(z,{variant:"outline",className:"text-xs",children:[ge(r.id).length," ","terms"]})]}),e.jsxs("div",{className:"flex items-center gap-1",onClick:l=>l.stopPropagation(),children:[!r.isActive&&e.jsx(j,{size:"icon-sm",variant:"ghost",onClick:()=>x(r.id),title:"Set as active year",children:e.jsx(Ee,{className:"h-4 w-4"})}),e.jsx(j,{size:"icon-sm",variant:"ghost",onClick:()=>q(r),title:"Edit year name",children:e.jsx(ie,{className:"h-4 w-4"})}),e.jsx(j,{size:"icon-sm",variant:"ghost",onClick:()=>p(r.id),className:"text-destructive hover:text-destructive",title:"Delete year",children:e.jsx(ae,{className:"h-4 w-4"})})]})]}),f.has(r.id)&&e.jsxs(A,{className:"pt-3 pb-3 space-y-2",children:[ge(r.id).map(l=>e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-md bg-muted/20 hover:bg-muted/40 transition-colors",children:[e.jsx(Re,{className:"h-3 w-3 text-muted-foreground cursor-grab"}),E===l.id?e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("input",{type:"text",value:$,onChange:w=>B(w.target.value),className:"flex-1 px-2 py-1 text-sm border rounded bg-background",autoFocus:!0,onKeyDown:w=>{w.key==="Enter"&&W(),w.key==="Escape"&&ne()}}),e.jsx(j,{size:"icon-sm",variant:"ghost",onClick:W,children:e.jsx(Ee,{className:"h-3 w-3 text-green-500"})}),e.jsx(j,{size:"icon-sm",variant:"ghost",onClick:ne,children:e.jsx(Ue,{className:"h-3 w-3 text-red-500"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm flex-1",children:l.name}),e.jsx(j,{size:"icon-sm",variant:"ghost",onClick:()=>ce(l),title:"Edit term name",children:e.jsx(ie,{className:"h-3 w-3"})}),e.jsx(j,{size:"icon-sm",variant:"ghost",onClick:()=>se(l.id),className:"text-destructive hover:text-destructive",title:"Delete term",children:e.jsx(ae,{className:"h-3 w-3"})})]})]},l.id)),e.jsxs(j,{variant:"ghost",size:"sm",className:"w-full mt-2 border border-dashed",onClick:()=>F(r.id),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Add Term"]})]})]},r.id))}),e.jsxs("div",{className:"text-xs text-muted-foreground border-t pt-3 mt-3",children:[e.jsx("p",{children:"ðŸ’¡ Tips:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-1",children:[e.jsx("li",{children:"Click a year to expand/collapse its terms"}),e.jsx("li",{children:'Set one year as "Active" for quick filtering'}),e.jsx("li",{children:'Subjects without year/term will appear in "Unassigned"'})]})]})]})})},st=()=>{const y=us(),{data:t,updateData:c,showToast:v}=Je(),[I,a]=g.useState("tasks"),[u,d]=g.useState("kanban"),[o,f]=g.useState(!1),[S,C]=g.useState(!1),[m,E]=g.useState(!1),[D,$]=g.useState(!1),[B,ee]=g.useState(void 0),[U,p]=g.useState(void 0),[h,x]=g.useState(void 0),[F,se]=g.useState(void 0),[le,q]=g.useState(!1),[ce,W]=g.useState(void 0),[ne,je]=g.useState("mark"),[ge,r]=g.useState(!1),l=t.university.academicYears||[],w=t.university.terms||[],k=t.university.currentYearId,b=t.university.currentTermId,L=g.useMemo(()=>!k&&!b?t.university.subjects:k==="unassigned"?t.university.subjects.filter(s=>!s.yearId&&!s.termId):t.university.subjects.filter(s=>!(!s.yearId&&!s.termId||k&&s.yearId!==k||b&&s.termId!==b)),[t.university.subjects,k,b]),fe=g.useMemo(()=>new Set(L.map(s=>s.id)),[L]),J=g.useMemo(()=>!k&&!b?t.university.tasks:t.university.tasks.filter(s=>fe.has(s.subjectId)),[t.university.tasks,fe,k,b]),te=g.useMemo(()=>!k&&!b?t.university.exams:t.university.exams.filter(s=>fe.has(s.subjectId)),[t.university.exams,fe,k,b]),Xe=g.useCallback(s=>{c({university:{...t.university,currentYearId:s,currentTermId:s&&b&&w.find(n=>n.id===b&&n.yearId===s)?b:void 0}})},[t.university,b,w,c]),Ze=g.useCallback(s=>{c({university:{...t.university,currentTermId:s}})},[t.university,c]),es=g.useCallback((s,n)=>{c({university:{...t.university,academicYears:s,terms:n}}),v("Academic years and terms updated","success")},[t.university,c,v]),G=g.useMemo(()=>{const s=J,n=te,i=L,N=s.length,T=s.filter(H=>H.status==="done").length,P=s.filter(H=>H.status==="in-progress").length,Q=s.filter(H=>H.status==="todo").length,O=n.filter(H=>!H.taken&&Fe(H.date)>=0&&Fe(H.date)<=7).length,X=t.university.gradeEntries||[];let Z=0,ve=0,de=0;i.forEach(H=>{const ms=n.filter(Ce=>Ce.subjectId===H.id),xs=X.filter(Ce=>Ce.subjectId===H.id),ke=Se(ms,xs);ke.totalPossible>0&&(Z+=ke.totalEarned,ve+=ke.totalPossible,de++)});const os=ve>0?Z/ve*100:0;return{totalTasks:N,completedTasks:T,inProgressTasks:P,todoTasks:Q,upcomingExams:O,completionRate:N>0?Math.round(T/N*100):0,overallGrade:Math.round(os*10)/10,subjectsWithGrades:de}},[J,te,L,t.university.gradeEntries]),ss=s=>{confirm("Delete this subject and all related tasks?")&&(c({university:{...t.university,subjects:t.university.subjects.filter(n=>n.id!==s),tasks:t.university.tasks.filter(n=>n.subjectId!==s),exams:t.university.exams.filter(n=>n.subjectId!==s)}}),v("Subject deleted successfully","success"))},Pe=s=>{confirm("Delete this task?")&&(c({university:{...t.university,tasks:t.university.tasks.filter(n=>n.id!==s)}}),v("Task deleted successfully","success"))},ts=s=>{confirm("Delete this exam?")&&(c({university:{...t.university,exams:t.university.exams.filter(n=>n.id!==s)}}),v("Exam deleted successfully","success"))},as=s=>{W(s),je("mark"),q(!0)},ns=s=>{W(s),je("grade"),q(!0)},rs=(s,n)=>{c({university:{...t.university,exams:t.university.exams.map(i=>i.id===s?{...i,...n}:i)}}),v(n.grade!==void 0?"Grade saved successfully":"Exam marked as taken","success"),q(!1),W(void 0)},pe=(s,n)=>{c({university:{...t.university,tasks:t.university.tasks.map(i=>i.id===s.id?{...i,status:n}:i)}}),v("Task status updated","success")},is=s=>{switch(s){case"done":return"secondary";case"in-progress":return"default";default:return"outline"}},Ye=s=>{const n=t.university.subjects.find(N=>N.id===s.subjectId),i=[];return i.push({label:`Priority ${s.priority}`,variant:ze(s.priority)}),n&&i.push({label:n.name,variant:"outline"}),s.dueDate&&i.push({label:Be(new Date(s.dueDate)),variant:He(s.dueDate)?"destructive":"outline",icon:e.jsx(we,{className:"h-3 w-3"})}),i},ls=s=>{const n=[{label:"Edit",icon:e.jsx(ie,{className:"h-4 w-4"}),onClick:()=>{p(s),C(!0)}}];return s.status!=="todo"&&n.push({label:"Move to To Do",onClick:()=>pe(s,"todo")}),s.status!=="in-progress"&&n.push({label:"Move to In Progress",onClick:()=>pe(s,"in-progress")}),s.status!=="done"&&n.push({label:"Move to Done",onClick:()=>pe(s,"done")}),n.push({label:"Delete",icon:e.jsx(ae,{className:"h-4 w-4"}),onClick:()=>Pe(s.id),variant:"destructive",separator:!0}),n},cs=s=>{const n=t.university.subjects.find(N=>N.id===s.subjectId),i=[];return i.push({label:s.status,variant:is(s.status)}),i.push({label:`Priority ${s.priority}`,variant:ze(s.priority)}),n&&i.push({label:n.name,variant:"outline"}),s.dueDate&&i.push({label:`Due: ${Be(new Date(s.dueDate))}`,variant:He(s.dueDate)?"destructive":"outline",icon:e.jsx(we,{className:"h-3 w-3"})}),i},ds=[{id:"todo",title:"To Do",tasks:J.filter(s=>s.status==="todo"),color:"from-blue-500 to-cyan-500"},{id:"in-progress",title:"In Progress",tasks:J.filter(s=>s.status==="in-progress"),color:"from-yellow-500 to-orange-500"},{id:"done",title:"Done",tasks:J.filter(s=>s.status==="done"),color:"from-green-500 to-emerald-500"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-bold tracking-tight flex items-center gap-3 text-foreground",children:[e.jsx(Ss,{className:"h-10 w-10"}),"University"]}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage your courses, tasks, and exams"})]}),e.jsx(Fs,{years:l,terms:w,currentYearId:k,currentTermId:b,onYearChange:Xe,onTermChange:Ze,onManageClick:()=>r(!0)})]}),e.jsx(Ge,{}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6",children:[e.jsxs(M,{children:[e.jsxs(V,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(K,{className:"text-sm font-medium",children:"Total Tasks"}),e.jsx(We,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold",children:G.totalTasks}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all subjects"})]})]}),e.jsxs(M,{children:[e.jsxs(V,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(K,{className:"text-sm font-medium",children:"Completed"}),e.jsx(Es,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold",children:G.completedTasks}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[G.completionRate,"% completion"]}),e.jsx(Te,{value:G.completionRate,className:"mt-2"})]})]}),e.jsxs(M,{children:[e.jsxs(V,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(K,{className:"text-sm font-medium",children:"In Progress"}),e.jsx(Ve,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold",children:G.inProgressTasks}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently working on"})]})]}),e.jsxs(M,{children:[e.jsxs(V,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(K,{className:"text-sm font-medium",children:"To Do"}),e.jsx(Ms,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold",children:G.todoTasks}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pending tasks"})]})]}),e.jsxs(M,{children:[e.jsxs(V,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(K,{className:"text-sm font-medium",children:"Upcoming Exams"}),e.jsx(he,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold",children:G.upcomingExams}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Next 7 days"})]})]}),e.jsxs(M,{children:[e.jsxs(V,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(K,{className:"text-sm font-medium",children:"Overall Grade"}),e.jsx(be,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(A,{children:[e.jsx("div",{className:Y("text-2xl font-bold",Ne(G.overallGrade)),children:G.subjectsWithGrades>0?`${G.overallGrade}%`:"â€”"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:G.subjectsWithGrades>0?`${G.subjectsWithGrades} subject${G.subjectsWithGrades!==1?"s":""}`:"No grades yet"})]})]})]}),e.jsxs(fs,{value:I,onValueChange:s=>a(s),children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs(ps,{className:"flex-wrap h-auto w-full sm:w-auto",children:[e.jsxs(oe,{value:"tasks",className:"flex-1 sm:flex-none",children:[e.jsx(As,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Tasks"}),e.jsx("span",{className:"sm:hidden",children:"Tasks"})]}),e.jsxs(oe,{value:"grades",className:"flex-1 sm:flex-none",children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Grades"}),e.jsx("span",{className:"sm:hidden",children:"Grades"})]}),e.jsxs(oe,{value:"subjects",className:"flex-1 sm:flex-none",children:[e.jsx(Ke,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Subjects"}),e.jsx("span",{className:"sm:hidden",children:"Subjects"})]}),e.jsxs(oe,{value:"exams",className:"flex-1 sm:flex-none",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Exams"}),e.jsx("span",{className:"sm:hidden",children:"Exams"})]}),e.jsxs(oe,{value:"timetable",className:"flex-1 sm:flex-none",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Timetable"}),e.jsx("span",{className:"sm:hidden",children:"Timetable"})]})]}),I==="tasks"&&e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{variant:u==="kanban"?"secondary":"ghost",size:"sm",onClick:()=>d("kanban"),"aria-label":"Kanban view",className:Y("text-primary",u==="kanban"&&"bg-primary/10 text-primary hover:bg-primary/20"),children:e.jsx(Ds,{className:"h-4 w-4"})}),e.jsx(j,{variant:u==="list"?"secondary":"ghost",size:"sm",onClick:()=>d("list"),"aria-label":"List view",className:Y("text-primary",u==="list"&&"bg-primary/10 hover:bg-primary/20"),children:e.jsx($s,{className:"h-4 w-4"})})]}),e.jsxs(j,{onClick:()=>C(!0),className:"flex-1 sm:flex-none",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Task"}),e.jsx("span",{className:"sm:hidden",children:"Add"})]})]}),I==="subjects"&&e.jsxs(j,{onClick:()=>f(!0),className:"w-full sm:w-auto",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Subject"}),e.jsx("span",{className:"sm:hidden",children:"Add"})]}),I==="exams"&&e.jsxs(j,{onClick:()=>E(!0),className:"w-full sm:w-auto",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Exam"}),e.jsx("span",{className:"sm:hidden",children:"Add"})]})]}),e.jsx(me,{value:"tasks",className:"space-y-4",children:J.length===0?e.jsx(M,{children:e.jsxs(A,{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(We,{className:"h-16 w-16 text-muted-foreground mb-4 opacity-50"}),e.jsx("h3",{className:"text-xl font-semibold mb-2 text-foreground",children:k||b?"No tasks in this term":"No tasks yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:k||b?"Add subjects to this term or change your filter":"Create your first task to get started"}),e.jsxs(j,{onClick:()=>C(!0),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Add Task"]})]})}):u==="kanban"?e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsx(hs,{columns:ds.map(s=>({id:s.id,title:s.title,items:s.tasks,color:s.color})),getItemId:s=>s.id,onDragEnd:(s,n)=>{const i=t.university.tasks.find(N=>N.id===s);i&&pe(i,n)},renderItem:s=>e.jsx(Ie,{id:s.id,title:s.title,description:s.description,badges:Ye(s),actions:ls(s)}),dragOverlay:s=>e.jsx(Ie,{id:s.id,title:s.title,description:s.description,badges:Ye(s),actions:[]})})}):e.jsx(js,{items:J,getItemId:s=>s.id,emptyMessage:"No tasks yet. Create your first task to get started.",renderItem:s=>e.jsx(gs,{title:s.title,description:s.description,badges:cs(s),actions:[{icon:e.jsx(ie,{className:"h-4 w-4"}),onClick:()=>{p(s),C(!0)},label:"Edit"},{icon:e.jsx(ae,{className:"h-4 w-4"}),onClick:()=>Pe(s.id),variant:"destructive",label:"Delete"}]})})}),e.jsx(me,{value:"grades",className:"space-y-6",children:L.length===0?e.jsx(M,{children:e.jsxs(A,{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(be,{className:"h-16 w-16 text-muted-foreground mb-4 opacity-50"}),e.jsx("h3",{className:"text-xl font-semibold mb-2 text-foreground",children:k||b?"No subjects in this term":"No subjects yet"}),e.jsx("p",{className:"text-muted-foreground mb-4 text-center",children:k||b?"Add subjects to this term or change your filter":"Add subjects to start tracking your grades"}),e.jsxs(j,{onClick:()=>f(!0),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Add Subject"]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs(M,{children:[e.jsx(V,{children:e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-5 h-5"}),"Overall Performance"]})}),e.jsx(A,{children:(()=>{const s=t.university.gradeEntries||[];let n=0,i=0;L.forEach(T=>{const P=te.filter(X=>X.subjectId===T.id),Q=s.filter(X=>X.subjectId===T.id),O=Se(P,Q);n+=O.totalEarned,i+=O.totalPossible});const N=i>0?n/i*100:0;return e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[e.jsxs("div",{className:"text-center p-6 bg-muted/30 rounded-xl flex-1",children:[e.jsx(be,{className:Y("w-12 h-12 mx-auto mb-2",Ne(N))}),e.jsxs("div",{className:Y("text-4xl font-bold",Ne(N)),children:[N.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Overall Grade"})]}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Total Points Earned"}),e.jsx("span",{className:"font-medium",children:n.toFixed(1)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Total Possible Points"}),e.jsx("span",{className:"font-medium",children:i.toFixed(1)})]}),e.jsx(Ge,{className:"my-2"}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subjects with Grades"}),e.jsxs("span",{className:"font-medium",children:[L.filter(T=>{const P=te.filter(O=>O.subjectId===T.id&&O.taken&&O.grade!==void 0),Q=(t.university.gradeEntries||[]).filter(O=>O.subjectId===T.id);return P.length>0||Q.length>0}).length," ","/"," ",L.length]})]})]})]})})()})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:L.map(s=>{const n=te.filter(P=>P.subjectId===s.id),i=(t.university.gradeEntries||[]).filter(P=>P.subjectId===s.id),N=Se(n,i),T=n.filter(P=>P.taken&&P.grade!==void 0).length;return e.jsx(M,{className:"cursor-pointer hover:shadow-md transition-all",style:{borderLeftWidth:"4px",borderLeftColor:s.color},onClick:()=>y(`/university/subject/${s.id}`),children:e.jsxs(A,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[T," ","exam",T!==1&&"s"," ","graded",i.length>0&&` â€¢ ${i.length} other grade${i.length!==1?"s":""}`]})]}),e.jsx("div",{className:Y("text-2xl font-bold",Ne(N.percentage)),children:N.totalPossible>0?`${N.percentage.toFixed(1)}%`:"â€”"})]}),N.totalPossible>0?e.jsxs(e.Fragment,{children:[e.jsx(Te,{value:Math.min(N.percentage,100),className:"h-2 mb-2"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[N.totalEarned.toFixed(1)," ","/"," ",N.totalPossible.toFixed(1)," ","points"]})]}):e.jsx("div",{className:"text-sm text-muted-foreground italic",children:"No grades recorded yet"})]})},s.id)})})]})}),e.jsx(me,{value:"subjects",className:"space-y-4",children:L.length===0?e.jsx(M,{children:e.jsxs(A,{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(Ke,{className:"h-16 w-16 text-muted-foreground mb-4 opacity-50"}),e.jsx("h3",{className:"text-xl font-semibold mb-2 text-foreground",children:k||b?"No subjects in this term":"No subjects yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:k||b?"Add subjects to this term or change your filter":"Add your first subject to organize your courses"}),e.jsxs(j,{onClick:()=>f(!0),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Add Subject"]})]})}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:L.map(s=>{const n=J.filter(T=>T.subjectId===s.id),i=n.filter(T=>T.status==="done").length,N=n.length>0?Math.round(i/n.length*100):0;return e.jsxs(M,{className:"hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>y(`/university/subject/${s.id}`),children:[e.jsx(V,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.color}}),e.jsx("div",{children:e.jsx(K,{children:s.name})})]}),e.jsx("div",{onClick:T=>T.stopPropagation(),children:e.jsxs(Me,{children:[e.jsx(Ae,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"icon-sm",children:e.jsx(Ps,{className:"h-4 w-4"})})}),e.jsxs(De,{align:"end",children:[e.jsxs(_,{onClick:()=>{ee(s),f(!0)},children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsx(ue,{}),e.jsxs(_,{onClick:()=>ss(s.id),className:"text-destructive",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})})]})}),e.jsxs(A,{children:[s.professor&&e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Prof. ",s.professor]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Progress"}),e.jsxs("span",{className:"font-medium",children:[N,"%"]})]}),e.jsx(Te,{value:N}),e.jsxs("div",{className:"flex items-center justify-between text-sm pt-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Tasks"}),e.jsxs("span",{className:"font-medium",children:[i," /"," ",n.length]})]})]})]})]},s.id)})})}),e.jsx(me,{value:"exams",className:"space-y-4",children:te.length===0?e.jsx(M,{children:e.jsxs(A,{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(he,{className:"h-16 w-16 text-muted-foreground mb-4 opacity-50"}),e.jsx("h3",{className:"text-xl font-semibold mb-2 text-foreground",children:k||b?"No exams in this term":"No exams scheduled"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:k||b?"Add exams to subjects in this term or change your filter":"Add your exam dates to stay prepared"}),e.jsxs(j,{onClick:()=>E(!0),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Add Exam"]})]})}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:te.sort((s,n)=>{const i=new Date,N=new Date(i.getFullYear(),i.getMonth(),i.getDate()),T=new Date(s.date),P=new Date(n.date),Q=Z=>{const de=new Date(Z.date)<N;return!Z.taken&&de?1:!Z.taken&&!de?2:Z.taken&&Z.grade===void 0?3:4},O=Q(s),X=Q(n);return O!==X?O-X:O===2?T.getTime()-P.getTime():P.getTime()-T.getTime()}).map(s=>{const n=t.university.subjects.find(i=>i.id===s.subjectId);return e.jsx(vs,{exam:s,subjectName:n?.name,subjectColor:n?.color,onMarkAsTaken:as,onAddGrade:ns,onEdit:i=>{x(i),E(!0)},onDelete:i=>ts(i.id)},s.id)})})}),e.jsx(me,{value:"timetable",children:e.jsx(Is,{subjects:L,onAddSchedule:s=>{const n=L.find(i=>i.id===s);n&&(se(n),$(!0))},onEditSchedule:s=>{const n=L.find(i=>i.id===s);n&&(se(n),$(!0))}})})]}),e.jsx(Ns,{isOpen:o,onClose:()=>{f(!1),ee(void 0)},subject:B}),e.jsx(bs,{isOpen:S,onClose:()=>{C(!1),p(void 0)},task:U}),e.jsx(ys,{isOpen:m,onClose:()=>{E(!1),x(void 0)},exam:h}),e.jsx(ws,{isOpen:le,onClose:()=>{q(!1),W(void 0)},exam:ce||null,mode:ne,onSave:rs}),e.jsx(Os,{isOpen:D,onClose:()=>{$(!1),se(void 0)},subject:F}),e.jsx(Gs,{isOpen:ge,onClose:()=>r(!1),years:l,terms:w,onSave:es})]})};export{st as University};
