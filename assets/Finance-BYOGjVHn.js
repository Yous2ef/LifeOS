import{j as e,o as Qt,p as Xt,q as It,r as Zt,s as Mt,D as Et,O as Tt}from"./radix-ui-C3V2uSY1.js";import{r}from"./router-BQf8R6iK.js";import{C as K,a as J,b as re,c as ce,d as Be}from"./Card-D8FG43pY.js";import{u as es,g as $,M as Ft,B as F,I as ne,j as ts}from"./index-CO5L2hPJ.js";import{T as Ot,a as Rt,b as we,c as Ce}from"./tabs-BV5ebja8.js";import{aj as Fe,ak as rt,W as Ye,al as ss,o as pe,p as Xe,X as Ze,j as Ve,am as pt,T as me,a5 as Le,C as as,an as Nt,r as Ie,ao as mt,ap as xt,a as Oe,aq as $t,ar as ns,q as Qe,ac as lt,as as ls,at as et,g as Ue,B as Pt,_ as gt,h as rs,k as Bt,i as Gt,l as _e,P as Te,au as yt,S as Lt,av as cs,aw as Yt,ax as is,a4 as os,Z as ds,ay as ms,N as xs,az as us,Y as hs,a9 as gs,aA as ps,aB as js,e as fs,aC as Ns,aD as ys,U as bs,aE as bt,aF as vt}from"./utils-MsfPC-Eo.js";import{F as Ge,T as He}from"./TextArea-BN_339Pt.js";import{L,a as Se,b as De,c as Ae,d as ke,e as ae,S as $e}from"./Select-SnNIy5bD.js";import{R as jt,L as vs,C as zt,X as qt,Y as Wt,T as ft,d as Vt,e as ut,P as ws,f as Cs,b as Ss,A as Ds,g as As,h as wt}from"./charts-5ZM4_dsB.js";import{P as Ut}from"./progress-sEUTKVRb.js";import"./react-vendor-pR2cKLDH.js";import"./dnd-kit-VvYmaRfD.js";const U=()=>`${Date.now()}_${Math.random().toString(36).substring(2,9)}`,nt=()=>{const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`},ks=(n,h=1)=>{const[s,a]=n.split("-").map(Number);return new Date(s,a-1,h)},Is=(n,h=1)=>{const[s,a]=n.split("-").map(Number);return new Date(s,a,h-1,23,59,59,999)},Pe=(n,h,s=1)=>{const a=new Date(n),g=ks(h,s),i=Is(h,s);return a>=g&&a<=i},ht=()=>{const n=new Date().toISOString(),h=[{id:U(),name:"Rent/Mortgage",nameAr:"Ø¥ÙŠØ¬Ø§Ø±/Ù‚Ø³Ø· Ø³ÙƒÙ†",icon:"",color:"#3b82f6",isEssential:!0,isDefault:!0,order:1,createdAt:n},{id:U(),name:"Utilities",nameAr:"ÙÙˆØ§ØªÙŠØ±",icon:"",color:"#eab308",isEssential:!0,isDefault:!0,order:2,createdAt:n},{id:U(),name:"Transportation",nameAr:"Ù…ÙˆØ§ØµÙ„Ø§Øª",icon:"",color:"#8b5cf6",isEssential:!0,isDefault:!0,order:3,createdAt:n},{id:U(),name:"Groceries",nameAr:"Ø·Ø¹Ø§Ù… ÙˆØ¨Ù‚Ø§Ù„Ø©",icon:"",color:"#22c55e",isEssential:!0,isDefault:!0,order:4,createdAt:n},{id:U(),name:"Healthcare",nameAr:"ØµØ­Ø© ÙˆØ¯ÙˆØ§Ø¡",icon:"",color:"#ef4444",isEssential:!0,isDefault:!0,order:5,createdAt:n},{id:U(),name:"Insurance",nameAr:"ØªØ£Ù…ÙŠÙ†",icon:"",color:"#0ea5e9",isEssential:!0,isDefault:!0,order:6,createdAt:n},{id:U(),name:"Dining Out",nameAr:"Ø£ÙƒÙ„ Ø¨Ø±Ù‡",icon:"",color:"#f97316",isEssential:!1,isDefault:!0,order:7,createdAt:n},{id:U(),name:"Entertainment",nameAr:"ØªØ±ÙÙŠÙ‡",icon:"",color:"#ec4899",isEssential:!1,isDefault:!0,order:8,createdAt:n},{id:U(),name:"Shopping",nameAr:"ØªØ³ÙˆÙ‚",icon:"",color:"#a855f7",isEssential:!1,isDefault:!0,order:9,createdAt:n},{id:U(),name:"Clothing",nameAr:"Ù…Ù„Ø§Ø¨Ø³",icon:"",color:"#06b6d4",isEssential:!1,isDefault:!0,order:10,createdAt:n},{id:U(),name:"Education",nameAr:"ØªØ¹Ù„ÙŠÙ…",icon:"",color:"#14b8a6",isEssential:!1,isDefault:!0,order:11,createdAt:n},{id:U(),name:"Gifts",nameAr:"Ù‡Ø¯Ø§ÙŠØ§",icon:"",color:"#f43f5e",isEssential:!1,isDefault:!0,order:12,createdAt:n},{id:U(),name:"Sports",nameAr:"Ø±ÙŠØ§Ø¶Ø©",icon:"",color:"#10b981",isEssential:!1,isDefault:!0,order:13,createdAt:n},{id:U(),name:"Travel",nameAr:"Ø³ÙØ±",icon:"",color:"#6366f1",isEssential:!1,isDefault:!0,order:14,createdAt:n},{id:U(),name:"Subscriptions",nameAr:"Ø§Ø´ØªØ±Ø§ÙƒØ§Øª",icon:"",color:"#8b5cf6",isEssential:!1,isDefault:!0,order:15,createdAt:n},{id:U(),name:"Personal Care",nameAr:"Ø¹Ù†Ø§ÙŠØ© Ø´Ø®ØµÙŠØ©",icon:"",color:"#d946ef",isEssential:!1,isDefault:!0,order:16,createdAt:n},{id:U(),name:"Emergency",nameAr:"Ø·ÙˆØ§Ø±Ø¦",icon:"",color:"#dc2626",isEssential:!0,isDefault:!0,order:17,createdAt:n},{id:U(),name:"Other",nameAr:"Ø£Ø®Ø±Ù‰",icon:"",color:"#64748b",isEssential:!1,isDefault:!0,order:18,createdAt:n}];return{incomes:[],expenses:[],categories:h,installments:[],budgets:[],goals:[],alerts:[],settings:{defaultCurrency:"EGP",monthStartDay:1,showCents:!1,enableBudgetAlerts:!0,budgetWarningThreshold:80,enableInstallmentReminders:!0,installmentReminderDays:3,enableInsights:!0,weeklyReportEnabled:!0,monthlyReportEnabled:!0}}},Ms=()=>{const{data:n,updateData:h}=es(),s=r.useMemo(()=>({...ht(),...n.finance,settings:{...ht().settings,...n.finance?.settings||{}}}),[n.finance]),a=r.useCallback(b=>{h(typeof b=="function"?{finance:b(s)}:{finance:b})},[s,h]),g=r.useCallback((b,C)=>{const t=new Date(b);switch(C){case"daily":t.setDate(t.getDate()+1);break;case"weekly":t.setDate(t.getDate()+7);break;case"bi-weekly":t.setDate(t.getDate()+14);break;case"monthly":t.setMonth(t.getMonth()+1);break;case"quarterly":t.setMonth(t.getMonth()+3);break;case"yearly":t.setFullYear(t.getFullYear()+1);break;default:t.setMonth(t.getMonth()+1)}return t.toISOString().split("T")[0]},[]);r.useEffect(()=>{const C=setTimeout(()=>{const t=new Date;t.setHours(0,0,0,0);const D=s.incomes.filter(M=>M.isRecurring&&M.frequency!=="one-time"&&(!M.recurringEndDate||new Date(M.recurringEndDate)>=t)),T=[],B=[];D.forEach(M=>{let z=M.nextOccurrence?new Date(M.nextOccurrence):M.actualDate?new Date(M.actualDate):new Date(M.createdAt);if(!M.nextOccurrence){const G=M.actualDate||M.createdAt;z=new Date(g(G,M.frequency))}for(;z<=t;){const G=z.toISOString().split("T")[0];if(!s.incomes.find(O=>O.title===M.title&&O.amount===M.amount&&O.actualDate===G)){const O=new Date().toISOString();T.push({...M,id:U(),status:"received",actualDate:G,expectedDate:void 0,isRecurring:!1,nextOccurrence:void 0,createdAt:O,updatedAt:O,notes:`${M.notes?M.notes+" | ":""}Auto-generated from recurring income`})}const Q=g(G,M.frequency);z=new Date(Q)}if(z>t){const G=z.toISOString().split("T")[0];M.nextOccurrence!==G&&B.push({id:M.id,nextOccurrence:G})}}),(T.length>0||B.length>0)&&a(M=>({...M,incomes:[...M.incomes.map(z=>{const G=B.find(te=>te.id===z.id);return G?{...z,nextOccurrence:G.nextOccurrence,updatedAt:new Date().toISOString()}:z}),...T]}))},500);return()=>clearTimeout(C)},[]),r.useEffect(()=>{const C=setTimeout(()=>{const t=new Date;t.setHours(0,0,0,0);const D=s.expenses.filter(M=>M.isRecurring&&M.recurringFrequency&&(!M.recurringEndDate||new Date(M.recurringEndDate)>=t)),T=[],B=[];D.forEach(M=>{let z=M.nextOccurrence?new Date(M.nextOccurrence):new Date(M.date);for(M.nextOccurrence||(z=new Date(g(M.date,M.recurringFrequency||"monthly")));z<=t;){const G=z.toISOString().split("T")[0];if(!s.expenses.find(O=>O.title===M.title&&O.amount===M.amount&&O.categoryId===M.categoryId&&O.date===G)){const O=new Date().toISOString();T.push({...M,id:U(),date:G,isRecurring:!1,recurringFrequency:void 0,nextOccurrence:void 0,createdAt:O,updatedAt:O,notes:`${M.notes?M.notes+" | ":""}Auto-generated from recurring expense`})}const Q=g(G,M.recurringFrequency||"monthly");z=new Date(Q)}if(z>t){const G=z.toISOString().split("T")[0];M.nextOccurrence!==G&&B.push({id:M.id,nextOccurrence:G})}}),(T.length>0||B.length>0)&&a(M=>({...M,expenses:[...M.expenses.map(z=>{const G=B.find(te=>te.id===z.id);return G?{...z,nextOccurrence:G.nextOccurrence,updatedAt:new Date().toISOString()}:z}),...T]}))},700);return()=>clearTimeout(C)},[]);const i=r.useCallback(b=>{const C=new Date().toISOString(),t={...b,id:U(),createdAt:C,updatedAt:C};return a(D=>({...D,incomes:[...D.incomes,t]})),t},[a]),j=r.useCallback((b,C)=>{a(t=>({...t,incomes:t.incomes.map(D=>D.id===b?{...D,...C,updatedAt:new Date().toISOString()}:D)}))},[a]),m=r.useCallback(b=>{a(C=>({...C,incomes:C.incomes.filter(t=>t.id!==b)}))},[a]),p=r.useCallback(b=>s.incomes.find(C=>C.id===b),[s.incomes]),c=r.useCallback(b=>{const C=new Date().toISOString(),t={...b,id:U(),createdAt:C,updatedAt:C};return a(D=>({...D,expenses:[...D.expenses,t]})),t},[a]),N=r.useCallback((b,C)=>{a(t=>({...t,expenses:t.expenses.map(D=>D.id===b?{...D,...C,updatedAt:new Date().toISOString()}:D)}))},[a]),f=r.useCallback(b=>{a(C=>({...C,expenses:C.expenses.filter(t=>t.id!==b)}))},[a]),k=r.useCallback(b=>s.expenses.find(C=>C.id===b),[s.expenses]),o=r.useCallback(b=>{const C={...b,id:U(),createdAt:new Date().toISOString()};return a(t=>({...t,categories:[...t.categories,C]})),C},[a]),u=r.useCallback((b,C)=>{a(t=>({...t,categories:t.categories.map(D=>D.id===b?{...D,...C}:D)}))},[a]),d=r.useCallback(b=>s.categories.find(t=>t.id===b)?.isDefault?!1:(a(t=>({...t,categories:t.categories.filter(D=>D.id!==b)})),!0),[s.categories,a]),l=r.useCallback(b=>s.categories.find(C=>C.id===b),[s.categories]),x=r.useCallback(b=>{const C=new Date().toISOString(),t={...b,id:U(),paidAmount:0,paidInstallments:0,payments:[],createdAt:C,updatedAt:C};return a(D=>({...D,installments:[...D.installments,t]})),t},[a]),v=r.useCallback((b,C)=>{a(t=>({...t,installments:t.installments.map(D=>D.id===b?{...D,...C,updatedAt:new Date().toISOString()}:D)}))},[a]),I=r.useCallback(b=>{a(C=>({...C,installments:C.installments.filter(t=>t.id!==b)}))},[a]),S=r.useCallback((b,C)=>{const t=new Date().toISOString(),D={...C,id:U(),installmentId:b,createdAt:t};return a(T=>{const B=T.installments.find(V=>V.id===b);if(!B)return T;const M=[...B.payments,D],z=M.filter(V=>V.status==="paid"||V.status==="late").reduce((V,he)=>V+he.amount,0),G=M.filter(V=>V.status==="paid"||V.status==="late").length;let te=B.nextPaymentDate;const Q=new Date(B.nextPaymentDate);switch(B.frequency){case"weekly":Q.setDate(Q.getDate()+7);break;case"bi-weekly":Q.setDate(Q.getDate()+14);break;case"monthly":Q.setMonth(Q.getMonth()+1);break;case"quarterly":Q.setMonth(Q.getMonth()+3);break;case"yearly":Q.setFullYear(Q.getFullYear()+1);break}te=Q.toISOString().split("T")[0];const O=G>=B.totalInstallments;return{...T,installments:T.installments.map(V=>V.id===b?{...V,payments:M,paidAmount:z,paidInstallments:G,nextPaymentDate:O?V.endDate:te,status:O?"completed":V.status,updatedAt:t}:V)}}),D},[a]),E=r.useCallback(b=>{const C=new Date().toISOString(),t=b.currentAmount||0,D=U(),T=t>0?[{id:U(),goalId:D,amount:t,date:C.split("T")[0],notes:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ",createdAt:C}]:[],B={...b,id:D,currentAmount:t,contributions:T,createdAt:C,updatedAt:C};return a(M=>({...M,goals:[...M.goals,B]})),B},[a]),P=r.useCallback((b,C)=>{a(t=>({...t,goals:t.goals.map(D=>D.id===b?{...D,...C,updatedAt:new Date().toISOString()}:D)}))},[a]),q=r.useCallback(b=>{a(C=>({...C,goals:C.goals.filter(t=>t.id!==b)}))},[a]),H=r.useCallback((b,C,t)=>{const D=new Date().toISOString(),T={id:U(),goalId:b,amount:C,date:D.split("T")[0],notes:t,createdAt:D};return a(B=>{const M=B.goals.find(O=>O.id===b);if(!M)return B;const z=[...M.contributions,T],G=z.reduce((O,V)=>O+V.amount,0),te=G>=M.targetAmount,Q=M.milestones.map(O=>!O.reached&&G>=O.targetAmount?{...O,reached:!0,reachedAt:D}:O);return{...B,goals:B.goals.map(O=>O.id===b?{...O,contributions:z,currentAmount:G,milestones:Q,status:te?"completed":O.status,updatedAt:D}:O)}}),T},[a]),_=r.useCallback((b=nt())=>{const C=s.settings.monthStartDay,t=s.expenses.filter(O=>Pe(O.date,b,C)),T=s.incomes.filter(O=>{const V=O.actualDate||O.expectedDate;return V&&Pe(V,b,C)&&O.status==="received"}).reduce((O,V)=>O+V.amount,0),B=t.reduce((O,V)=>O+V.amount,0),M=s.categories.map(O=>{const he=t.filter(oe=>oe.categoryId===O.id).reduce((oe,Ke)=>oe+Ke.amount,0),Re=s.budgets.find(oe=>oe.month===b)?.categoryBudgets.find(oe=>oe.categoryId===O.id)?.planned??(O.monthlyBudget||0);return{categoryId:O.id,planned:Re,spent:he}}),z=M.reduce((O,V)=>O+V.planned,0),G=s.budgets.find(O=>O.month===b);if(G)return{...G,categoryBudgets:M,totalActualIncome:T,totalActualExpenses:B,actualSavings:T-B};const te=new Date().toISOString(),Q={id:U(),month:b,totalPlannedIncome:0,totalActualIncome:T,totalPlannedExpenses:z,totalActualExpenses:B,savingsGoal:0,actualSavings:T-B,categoryBudgets:M,createdAt:te,updatedAt:te};return a(O=>({...O,budgets:[...O.budgets,Q]})),Q},[s.budgets,s.categories,s.expenses,s.incomes,s.settings.monthStartDay,a]),X=r.useCallback((b,C)=>{a(t=>({...t,budgets:t.budgets.map(D=>D.id===b?{...D,...C,updatedAt:new Date().toISOString()}:D)}))},[a]),w=r.useCallback(b=>{const C={...b,id:U(),dismissed:!1,createdAt:new Date().toISOString()};return a(t=>({...t,alerts:[...t.alerts,C]})),C},[a]),A=r.useCallback(b=>{a(C=>({...C,alerts:C.alerts.map(t=>t.id===b?{...t,dismissed:!0,dismissedAt:new Date().toISOString()}:t)}))},[a]),y=r.useCallback(()=>{const b=new Date;a(C=>({...C,alerts:C.alerts.filter(t=>!(t.expiresAt&&new Date(t.expiresAt)<b))}))},[a]),R=r.useCallback(b=>{a(C=>({...C,settings:{...C.settings,...b}}))},[a]),W=r.useCallback((b=nt())=>{const C=s.settings.monthStartDay,D=s.incomes.filter(Y=>Y.status==="received"&&Y.actualDate&&Pe(Y.actualDate,b,C)).reduce((Y,le)=>Y+le.amount,0),T=s.expenses.filter(Y=>Pe(Y.date,b,C)),B=T.reduce((Y,le)=>Y+le.amount,0),[M,z]=b.split("-").map(Number),G=z===1?`${M-1}-12`:`${M}-${String(z-1).padStart(2,"0")}`,Q=s.incomes.filter(Y=>Y.status==="received"&&Y.actualDate&&Pe(Y.actualDate,G,C)).reduce((Y,le)=>Y+le.amount,0),V=s.expenses.filter(Y=>Pe(Y.date,G,C)).reduce((Y,le)=>Y+le.amount,0),he=Q>0?(D-Q)/Q*100:0,tt=V>0?(B-V)/V*100:0,ze=s.installments.filter(Y=>Y.status==="active"),Re=ze.reduce((Y,le)=>Y+(le.totalAmount-le.paidAmount),0),oe=s.goals.filter(Y=>Y.status==="active"),Ke=oe.length>0?oe.reduce((Y,le)=>Y+le.currentAmount/le.targetAmount*100,0)/oe.length:0,Ee={};T.forEach(Y=>{Ee[Y.categoryId]=(Ee[Y.categoryId]||0)+Y.amount});let qe="",Je=0;Object.entries(Ee).forEach(([Y,le])=>{le>Je&&(qe=Y,Je=le)});const ot=s.categories.find(Y=>Y.id===qe),st=s.alerts.filter(Y=>!Y.dismissed),dt=st.filter(Y=>Y.severity==="critical"),at=D-B,ve=D>0?at/D*100:0;return{totalIncomeThisMonth:D,totalExpensesThisMonth:B,netBalanceThisMonth:at,savingsRateThisMonth:ve,incomeVsLastMonth:he,expensesVsLastMonth:tt,totalActiveInstallments:ze.length,totalInstallmentDebt:Re,totalGoalsProgress:Ke,topSpendingCategory:ot?.name||"None",topSpendingAmount:Je,activeAlertsCount:st.length,criticalAlertsCount:dt.length}},[s]),ie=r.useCallback((b=nt())=>{const C=s.settings.monthStartDay,t=s.expenses.filter(D=>Pe(D.date,b,C));return s.categories.map(D=>{const B=t.filter(G=>G.categoryId===D.id).reduce((G,te)=>G+te.amount,0),M=D.monthlyBudget||0,z=M>0?B/M*100:0;return{categoryId:D.id,categoryName:D.name,categoryIcon:D.icon,categoryColor:D.color,spent:B,budget:M,percentage:z,isOverBudget:M>0&&B>M}}).sort((D,T)=>T.spent-D.spent)},[s.categories,s.expenses,s.settings.monthStartDay]),xe=r.useCallback((b,C)=>{const t=new Date(b),D=new Date(C),T=[],B=new Date(t);for(;B<=D;){const M=B.toISOString().split("T")[0],z=s.expenses.filter(G=>G.date===M);T.push({date:M,amount:z.reduce((G,te)=>G+te.amount,0),transactions:z.length}),B.setDate(B.getDate()+1)}return T},[s.expenses]),ye=r.useCallback((b=10)=>{const C=[];return s.incomes.filter(t=>t.status==="received"&&t.actualDate).forEach(t=>{C.push({id:t.id,type:"income",title:t.title,amount:t.amount,date:t.actualDate})}),s.expenses.forEach(t=>{const D=s.categories.find(T=>T.id===t.categoryId);C.push({id:t.id,type:"expense",title:t.title,amount:t.amount,date:t.date,category:D?.name,categoryIcon:D?.icon,categoryColor:D?.color})}),C.sort((t,D)=>new Date(D.date).getTime()-new Date(t.date).getTime()).slice(0,b)},[s.incomes,s.expenses,s.categories]),de=r.useCallback((b,C,t,D)=>{const T=s.categories.find(B=>B.id===C);return c({title:t||T?.name||"Expense",amount:b,currency:s.settings.defaultCurrency,categoryId:C,type:"variable",paymentMethod:"cash",date:new Date().toISOString().split("T")[0],isRecurring:!1,tags:[],notes:D})},[c,s.categories,s.settings.defaultCurrency]),ue=r.useCallback((b,C)=>{const t=C||s.settings.defaultCurrency;return`${new Intl.NumberFormat("en-US",{minimumFractionDigits:s.settings.showCents?2:0,maximumFractionDigits:s.settings.showCents?2:0}).format(b)} ${t}`},[s.settings.defaultCurrency,s.settings.showCents]),be=r.useCallback(()=>({...s,exportedAt:new Date().toISOString(),version:"1.0.0"}),[s]),ee=r.useCallback(b=>{if(!b.incomes||!b.expenses||!b.categories)throw new Error("Invalid data structure");a({incomes:b.incomes||[],expenses:b.expenses||[],categories:b.categories||s.categories,installments:b.installments||[],budgets:b.budgets||[],goals:b.goals||[],alerts:b.alerts||[],settings:b.settings||s.settings,exportedAt:new Date().toISOString(),version:b.version||"1.0.0"})},[s.categories,s.settings,a]),Z=r.useCallback(()=>{const b=ht();a(b)},[a]);return{incomes:s.incomes,expenses:s.expenses,categories:s.categories,installments:s.installments,budgets:s.budgets,goals:s.goals,alerts:s.alerts.filter(b=>!b.dismissed),settings:s.settings,addIncome:i,updateIncome:j,deleteIncome:m,getIncomeById:p,addExpense:c,updateExpense:N,deleteExpense:f,getExpenseById:k,quickAddExpense:de,addCategory:o,updateCategory:u,deleteCategory:d,getCategoryById:l,addInstallment:x,updateInstallment:v,deleteInstallment:I,addInstallmentPayment:S,addGoal:E,updateGoal:P,deleteGoal:q,addGoalContribution:H,getOrCreateBudget:_,updateBudget:X,addAlert:w,dismissAlert:A,clearExpiredAlerts:y,updateSettings:R,getMonthlyStats:W,getCategorySpending:ie,getDailySpending:xe,getRecentTransactions:ye,exportData:be,importData:ee,resetData:Z,formatCurrency:ue,getCurrentMonth:nt}},Es=({stats:n,formatCurrency:h})=>{const s=r.useMemo(()=>[{title:"Total Income",value:n.totalIncomeThisMonth,change:n.incomeVsLastMonth,icon:Fe,color:"text-green-500",bgColor:"bg-green-500/10",trend:n.incomeVsLastMonth>=0?"up":"down"},{title:"Total Expenses",value:n.totalExpensesThisMonth,change:n.expensesVsLastMonth,icon:rt,color:"text-red-500",bgColor:"bg-red-500/10",trend:n.expensesVsLastMonth<=0?"up":"down"},{title:"Balance",value:n.netBalanceThisMonth,icon:Ye,color:n.netBalanceThisMonth>=0?"text-primary":"text-red-500",bgColor:n.netBalanceThisMonth>=0?"bg-primary/10":"bg-red-500/10",isBalance:!0},{title:"Savings Rate",value:n.savingsRateThisMonth,icon:ss,color:n.savingsRateThisMonth>=20?"text-green-500":n.savingsRateThisMonth>=0?"text-yellow-500":"text-red-500",bgColor:n.savingsRateThisMonth>=20?"bg-green-500/10":n.savingsRateThisMonth>=0?"bg-yellow-500/10":"bg-red-500/10",isPercentage:!0}],[n]);return e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:s.map(a=>e.jsx(K,{className:"overflow-hidden",children:e.jsx(J,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground truncate",children:a.title}),e.jsxs("p",{className:$("text-lg sm:text-2xl font-bold mt-1 truncate",a.isBalance&&a.value<0&&"text-red-500"),children:[a.isPercentage?`${a.value.toFixed(1)}%`:h(Math.abs(a.value)),a.isBalance&&a.value<0&&e.jsx("span",{className:"text-xs ml-1",children:"-"})]}),a.change!==void 0&&e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[a.change>=0?e.jsx(pe,{className:$("h-3 w-3",a.trend==="up"?"text-green-500":"text-red-500")}):e.jsx(Xe,{className:$("h-3 w-3",a.trend==="up"?"text-green-500":"text-red-500")}),e.jsxs("span",{className:$("text-xs",a.trend==="up"?"text-green-500":"text-red-500"),children:[Math.abs(a.change).toFixed(1),"%"]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"vs last month"})]})]}),e.jsx("div",{className:$("p-2 rounded-lg shrink-0",a.bgColor),children:e.jsx(a.icon,{className:$("h-4 w-4 sm:h-5 sm:w-5",a.color)})})]})})},a.title))})},Ts=({isOpen:n,onClose:h,categories:s,onAdd:a})=>{const[g,i]=r.useState(""),[j,m]=r.useState(null),p=()=>{if(!g||!j)return;const o=parseFloat(g);isNaN(o)||o<=0||(a(o,j),i(""),m(null),h())},c=o=>{if(!(o==="."&&g.includes("."))){if(o==="."&&g===""){i("0.");return}i(u=>u+o)}},N=()=>{i(o=>o.slice(0,-1))},f=()=>{i("")};if(!n)return null;const k=[...s].sort((o,u)=>o.order-u.order).slice(0,12);return e.jsx("div",{className:"fixed inset-0 z-50 bg-background/95 backdrop-blur-sm animate-in fade-in-0",children:e.jsxs("div",{className:"flex flex-col h-full max-w-lg mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("button",{onClick:h,className:"p-2 rounded-full hover:bg-muted transition-colors",children:e.jsx(Ze,{className:"h-5 w-5"})}),e.jsx("h2",{className:"text-lg font-semibold",children:"Quick Add Expense"}),e.jsx("button",{onClick:p,disabled:!g||!j,className:$("p-2 rounded-full transition-colors",g&&j?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),children:e.jsx(Ve,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6",children:[e.jsx("p",{className:"text-muted-foreground text-sm mb-2",children:"Amount"}),e.jsxs("div",{className:"text-5xl sm:text-6xl font-bold text-center min-h-[72px]",children:[g||"0",e.jsx("span",{className:"text-2xl text-muted-foreground ml-2",children:"EGP"})]})]}),e.jsxs("div",{className:"px-4 pb-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Category"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:k.map(o=>e.jsxs("button",{onClick:()=>m(o.id),className:$("flex flex-col items-center gap-1 p-3 rounded-xl transition-all",j===o.id?"bg-primary text-primary-foreground scale-105":"bg-muted hover:bg-muted/80"),children:[e.jsx("span",{className:"text-2xl",children:o.icon}),e.jsx("span",{className:"text-xs truncate max-w-full",children:o.nameAr||o.name})]},o.id))})]}),e.jsxs("div",{className:"p-4 bg-muted/30 border-t",children:[e.jsx("div",{className:"grid grid-cols-3 gap-2 max-w-xs mx-auto",children:["1","2","3","4","5","6","7","8","9",".","0","âŒ«"].map(o=>e.jsx("button",{onClick:()=>{o==="âŒ«"?N():c(o)},className:$("h-14 rounded-xl text-xl font-medium transition-all active:scale-95",o==="âŒ«"?"bg-red-500/10 text-red-500 hover:bg-red-500/20":"bg-background hover:bg-muted"),children:o},o))}),g&&e.jsx("button",{onClick:f,className:"w-full mt-3 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:"Clear"})]})]})})},Fs=({isOpen:n,onClose:h,categories:s,onSave:a,defaultCurrency:g,editingExpense:i})=>{const[j,m]=r.useState(i?.title||""),[p,c]=r.useState(i?.amount?.toString()||""),[N,f]=r.useState(i?.categoryId||s[0]?.id||""),[k,o]=r.useState(i?.type||"variable"),[u,d]=r.useState(i?.paymentMethod||"cash"),[l,x]=r.useState(i?.date||new Date().toISOString().split("T")[0]),[v,I]=r.useState(i?.notes||""),[S,E]=r.useState(i?.isRecurring||!1),[P,q]=r.useState(i?.recurringFrequency||"monthly"),H=()=>{if(!p||!N)return;const w=parseFloat(p);if(isNaN(w)||w<=0)return;const A=s.find(y=>y.id===N);a({title:j||A?.name||"Expense",amount:w,currency:g,categoryId:N,type:k,paymentMethod:u,date:l,isRecurring:S,recurringFrequency:S?P:void 0,tags:[],notes:v||void 0}),m(""),c(""),f(s[0]?.id||""),o("variable"),d("cash"),x(new Date().toISOString().split("T")[0]),I(""),E(!1),q("monthly"),h()},_=[{value:"fixed",label:"Fixed"},{value:"variable",label:"Variable"},{value:"emergency",label:"Emergency"}],X=[{value:"cash",label:"Cash",icon:"ðŸ’µ"},{value:"card",label:"Card",icon:"ðŸ’³"},{value:"bank-transfer",label:"Bank",icon:"ðŸ¦"},{value:"mobile-wallet",label:"Mobile",icon:"ðŸ“±"},{value:"other",label:"Other",icon:"ðŸ“¦"}];return e.jsx(Ft,{isOpen:n,onClose:h,title:i?"Edit Expense":"Add Expense",footer:e.jsxs(e.Fragment,{children:[e.jsx(F,{variant:"outline",onClick:h,children:"Cancel"}),e.jsx(F,{onClick:H,disabled:!p||!N,children:i?"Save Changes":"Add Expense"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ge,{label:"Amount *",type:"number",value:p,onChange:w=>c(w.target.value),placeholder:"0",min:"0",step:"0.01"}),e.jsx(Ge,{label:"Description",value:j,onChange:w=>m(w.target.value),placeholder:"What was this expense for?"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Category *"}),e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 gap-2 max-h-48 overflow-y-auto",children:s.map(w=>e.jsxs("button",{type:"button",onClick:()=>f(w.id),className:`flex flex-col items-center gap-1 p-2 rounded-lg border transition-all ${N===w.id?"border-primary bg-primary/10":"border-border hover:border-primary/50"}`,children:[e.jsx("span",{className:"text-xl",children:w.icon}),e.jsx("span",{className:"text-xs truncate max-w-full text-center",children:w.nameAr||w.name})]},w.id))})]}),e.jsx(Ge,{label:"Date",type:"date",value:l,onChange:w=>x(w.target.value)}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Type"}),e.jsx("div",{className:"flex gap-2",children:_.map(w=>e.jsx("button",{type:"button",onClick:()=>o(w.value),className:`flex-1 py-2 px-3 rounded-lg border text-sm transition-all ${k===w.value?"border-primary bg-primary/10 text-primary":"border-border hover:border-primary/50"}`,children:w.label},w.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Payment Method"}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:X.map(w=>e.jsxs("button",{type:"button",onClick:()=>d(w.value),className:`flex items-center gap-1.5 py-2 px-3 rounded-lg border text-sm whitespace-nowrap transition-all ${u===w.value?"border-primary bg-primary/10":"border-border hover:border-primary/50"}`,children:[e.jsx("span",{children:w.icon}),e.jsx("span",{children:w.label})]},w.value))})]}),e.jsx(He,{label:"Notes",value:v,onChange:w=>I(w.target.value),placeholder:"Any additional notes...",rows:2}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Recurring Expense"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Repeat this expense automatically"})]}),e.jsx("button",{type:"button",onClick:()=>E(!S),className:`relative w-11 h-6 rounded-full transition-colors ${S?"bg-primary":"bg-muted"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 rounded-full bg-white shadow transition-transform ${S?"translate-x-5":""}`})})]}),S&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Repeat Every"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"bi-weekly",label:"Bi-Weekly"},{value:"monthly",label:"Monthly"},{value:"quarterly",label:"Quarterly"},{value:"yearly",label:"Yearly"}].map(w=>e.jsx("button",{type:"button",onClick:()=>q(w.value),className:`py-1.5 px-3 rounded-lg border text-sm transition-all ${P===w.value?"border-primary bg-primary/10 text-primary":"border-border hover:border-primary/50"}`,children:w.label},w.value))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"A new expense will be created automatically on schedule"})]})]})})},Os=({isOpen:n,onClose:h,onSave:s,defaultCurrency:a,editingIncome:g})=>{const[i,j]=r.useState(g?.title||""),[m,p]=r.useState(g?.amount?.toString()||""),[c,N]=r.useState(g?.type||"salary"),[f,k]=r.useState(g?.status||"received"),[o,u]=r.useState(g?.frequency||"monthly"),[d,l]=r.useState(g?.actualDate||new Date().toISOString().split("T")[0]),[x,v]=r.useState(g?.expectedDate||""),[I,S]=r.useState(g?.notes||""),[E,P]=r.useState(g?.isRecurring||!1),q=()=>{if(!i||!m)return;const w=parseFloat(m);isNaN(w)||w<=0||(s({title:i,amount:w,currency:a,type:c,status:f,frequency:o,actualDate:f==="received"?d:void 0,expectedDate:f!=="received"?x:void 0,isRecurring:E,tags:[],notes:I||void 0}),j(""),p(""),N("salary"),k("received"),u("monthly"),l(new Date().toISOString().split("T")[0]),v(""),S(""),P(!1),h())},H=[{value:"salary",label:"Salary",icon:"ðŸ’¼"},{value:"freelance",label:"Freelance",icon:"ðŸ’»"},{value:"commission",label:"Commission",icon:"ðŸ“Š"},{value:"bonus",label:"Bonus",icon:"ðŸŽ"},{value:"investment",label:"Investment",icon:"ðŸ“ˆ"},{value:"gift",label:"Gift",icon:"ðŸŽ€"},{value:"refund",label:"Refund",icon:"â†©ï¸"},{value:"other",label:"Other",icon:"ðŸ“¦"}],_=[{value:"received",label:"Received",color:"text-green-500"},{value:"pending",label:"Pending",color:"text-yellow-500"},{value:"expected",label:"Expected",color:"text-blue-500"}],X=[{value:"one-time",label:"One Time"},{value:"weekly",label:"Weekly"},{value:"bi-weekly",label:"Bi-Weekly"},{value:"monthly",label:"Monthly"},{value:"quarterly",label:"Quarterly"},{value:"yearly",label:"Yearly"}];return e.jsx(Ft,{isOpen:n,onClose:h,title:g?"Edit Income":"Add Income",footer:e.jsxs(e.Fragment,{children:[e.jsx(F,{variant:"outline",onClick:h,children:"Cancel"}),e.jsx(F,{onClick:q,disabled:!i||!m,children:g?"Save Changes":"Add Income"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ge,{label:"Title *",value:i,onChange:w=>j(w.target.value),placeholder:"e.g., Monthly Salary, Freelance Project"}),e.jsx(Ge,{label:"Amount *",type:"number",value:m,onChange:w=>p(w.target.value),placeholder:"0",min:"0",step:"0.01"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Type"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:H.map(w=>e.jsxs("button",{type:"button",onClick:()=>N(w.value),className:`flex flex-col items-center gap-1 p-2 rounded-lg border transition-all ${c===w.value?"border-primary bg-primary/10":"border-border hover:border-primary/50"}`,children:[e.jsx("span",{className:"text-xl",children:w.icon}),e.jsx("span",{className:"text-xs",children:w.label})]},w.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Status"}),e.jsx("div",{className:"flex gap-2",children:_.map(w=>e.jsx("button",{type:"button",onClick:()=>k(w.value),className:`flex-1 py-2 px-3 rounded-lg border text-sm transition-all ${f===w.value?"border-primary bg-primary/10":"border-border hover:border-primary/50"}`,children:e.jsx("span",{className:f===w.value?w.color:"",children:w.label})},w.value))})]}),f==="received"?e.jsx(Ge,{label:"Date Received",type:"date",value:d,onChange:w=>l(w.target.value)}):e.jsx(Ge,{label:"Expected Date",type:"date",value:x,onChange:w=>v(w.target.value)}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Frequency"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:X.map(w=>e.jsx("button",{type:"button",onClick:()=>u(w.value),className:`py-1.5 px-3 rounded-lg border text-sm transition-all ${o===w.value?"border-primary bg-primary/10 text-primary":"border-border hover:border-primary/50"}`,children:w.label},w.value))})]}),e.jsx(He,{label:"Notes",value:I,onChange:w=>S(w.target.value),placeholder:"Any additional notes...",rows:2}),o!=="one-time"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Recurring Income"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically add this income on schedule"})]}),e.jsx("button",{type:"button",onClick:()=>P(!E),className:`relative w-11 h-6 rounded-full transition-colors ${E?"bg-primary":"bg-muted"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 rounded-full bg-white shadow transition-transform ${E?"translate-x-5":""}`})})]}),E&&e.jsxs("p",{className:"text-xs text-primary bg-primary/10 p-2 rounded-lg",children:["âœ¨ A new income entry will be created automatically every"," ",o==="weekly"?"week":o==="bi-weekly"?"2 weeks":o==="monthly"?"month":o==="quarterly"?"3 months":"year"]})]})]})})},Me=Qt,Rs=Xt,Ht=r.forwardRef(({className:n,...h},s)=>e.jsx(Tt,{ref:s,className:$("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...h}));Ht.displayName=Tt.displayName;const je=r.forwardRef(({className:n,children:h,...s},a)=>e.jsxs(Rs,{children:[e.jsx(Ht,{}),e.jsxs(It,{ref:a,className:$("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",n),...s,children:[h,e.jsxs(Zt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));je.displayName=It.displayName;const fe=({className:n,...h})=>e.jsx("div",{className:$("flex flex-col space-y-1.5 text-center sm:text-left",n),...h});fe.displayName="DialogHeader";const ct=({className:n,...h})=>e.jsx("div",{className:$("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",n),...h});ct.displayName="DialogFooter";const Ne=r.forwardRef(({className:n,...h},s)=>e.jsx(Mt,{ref:s,className:$("text-lg font-semibold leading-none tracking-tight",n),...h}));Ne.displayName=Mt.displayName;const it=r.forwardRef(({className:n,...h},s)=>e.jsx(Et,{ref:s,className:$("text-sm text-muted-foreground",n),...h}));it.displayName=Et.displayName;const Ct=({transactions:n,formatCurrency:h,compact:s=!1,onDeleteIncome:a,onDeleteExpense:g,onEditIncome:i,onEditExpense:j})=>{const[m,p]=r.useState(null);if(n.length===0)return e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"No transactions yet"}),e.jsx("p",{className:"text-sm",children:"Add your first income or expense to get started"})]});const c={};n.forEach(f=>{const k=f.date;c[k]||(c[k]=[]),c[k].push(f)});const N=f=>{const k=new Date(f),o=new Date,u=new Date(o);return u.setDate(u.getDate()-1),k.toDateString()===o.toDateString()?"Today":k.toDateString()===u.toDateString()?"Yesterday":k.toLocaleDateString("en-US",{weekday:s?void 0:"short",month:"short",day:"numeric"})};return s?e.jsx("div",{className:"space-y-2",children:n.map(f=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsx("div",{className:$("w-10 h-10 rounded-full flex items-center justify-center text-lg shrink-0",f.type==="income"?"bg-green-500/10":"bg-muted"),style:{backgroundColor:f.type==="expense"&&f.categoryColor?`${f.categoryColor}20`:void 0},children:f.type==="income"?e.jsx(Fe,{className:"h-5 w-5 text-green-500"}):f.categoryIcon||"ðŸ“¦"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:f.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[N(f.date),f.category&&` â€¢ ${f.category}`]})]}),e.jsxs("p",{className:$("text-sm font-semibold tabular-nums",f.type==="income"?"text-green-500":"text-foreground"),children:[f.type==="income"?"+":"-",h(f.amount)]})]},f.id))}):e.jsxs("div",{className:"space-y-4",children:[Object.entries(c).map(([f,k])=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:N(f)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[k.length," transaction",k.length>1?"s":""]})]}),e.jsx("div",{className:"space-y-2",children:k.map(o=>e.jsxs("div",{className:"group flex items-center gap-3 p-3 rounded-xl bg-muted/30 hover:bg-muted/50 transition-colors cursor-pointer",children:[e.jsx("div",{className:$("w-12 h-12 rounded-xl flex items-center justify-center text-xl shrink-0",o.type==="income"?"bg-green-500/10":"bg-muted"),style:{backgroundColor:o.type==="expense"&&o.categoryColor?`${o.categoryColor}15`:void 0},children:o.type==="income"?e.jsx(Fe,{className:"h-6 w-6 text-green-500"}):o.categoryIcon||"ðŸ“¦"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:o.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o.category||(o.type==="income"?"Income":"Expense")})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:$("font-semibold tabular-nums",o.type==="income"?"text-green-500":"text-foreground"),children:[o.type==="income"?"+":"-",h(o.amount)]})}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(o.type==="income"&&i||o.type==="expense"&&j)&&e.jsx(F,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0",onClick:u=>{u.stopPropagation(),o.type==="income"&&i?i(o.id):o.type==="expense"&&j&&j(o.id)},children:e.jsx(pt,{className:"h-4 w-4"})}),(o.type==="income"&&a||o.type==="expense"&&g)&&e.jsx(F,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-red-500 hover:text-red-600 hover:bg-red-500/10",onClick:u=>{u.stopPropagation(),p(o)},children:e.jsx(me,{className:"h-4 w-4"})})]})]},o.id))})]},f)),e.jsx(Me,{open:!!m,onOpenChange:()=>p(null),children:e.jsxs(je,{className:"sm:max-w-md text-foreground",children:[e.jsxs(fe,{children:[e.jsxs(Ne,{className:"text-red-500 flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5"}),"Ø­Ø°Ù"," ",m?.type==="income"?"Ø§Ù„Ø¯Ø®Ù„":"Ø§Ù„Ù…ØµØ±ÙˆÙ"]}),e.jsx(it,{children:"Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©ØŸ"})]}),m&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:$("w-10 h-10 rounded-full flex items-center justify-center text-lg",m.type==="income"?"bg-green-500/10":"bg-muted"),children:m.type==="income"?e.jsx(Fe,{className:"h-5 w-5 text-green-500"}):m.categoryIcon||"ðŸ“¦"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:m.title}),e.jsxs("p",{className:$("text-sm font-semibold",m.type==="income"?"text-green-500":"text-foreground"),children:[m.type==="income"?"+":"-",h(m.amount)]})]})]})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"âš ï¸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{variant:"destructive",className:"flex-1",onClick:()=>{m&&(m.type==="income"&&a?a(m.id):m.type==="expense"&&g&&g(m.id),p(null))},children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Ù†Ø¹Ù…ØŒ Ø§Ø­Ø°Ù"]}),e.jsx(F,{variant:"outline",onClick:()=>p(null),children:"Ø¥Ù„ØºØ§Ø¡"})]})]})]})})]})},$s=({categorySpending:n,formatCurrency:h,limit:s=6})=>{const a=n.filter(i=>i.spent>0).slice(0,s),g=n.reduce((i,j)=>i+j.spent,0);return a.length===0?e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx("p",{children:"No expenses this month"}),e.jsx("p",{className:"text-sm",children:"Start tracking your spending"})]}):e.jsxs("div",{className:"space-y-3",children:[a.map(i=>{const j=g>0?i.spent/g*100:0;return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:i.categoryIcon}),e.jsx("span",{className:"text-sm font-medium truncate max-w-[120px] sm:max-w-none",children:i.categoryName})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-semibold tabular-nums",children:h(i.spent)}),e.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:[j.toFixed(0),"%"]})]})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${Math.min(j,100)}%`,backgroundColor:i.categoryColor}})})]},i.categoryId)}),n.filter(i=>i.spent>0).length>s&&e.jsxs("p",{className:"text-xs text-muted-foreground text-center pt-2",children:["+",n.filter(i=>i.spent>0).length-s," ","more categories"]})]})};function Ps({isOpen:n,onClose:h,goal:s,formatCurrency:a,onContribute:g}){const[i,j]=r.useState("deposit"),[m,p]=r.useState(""),[c,N]=r.useState(""),[f,k]=r.useState(!1),[o,u]=r.useState(null),d=parseFloat(m)||0,l=i==="withdraw"?-d:d,x=s.currentAmount+l,v=s.currentAmount/s.targetAmount*100,I=x/s.targetAmount*100,S=I-v,E=s.targetAmount-x,P=i==="withdraw"?d<=s.currentAmount:!0,q=r.useMemo(()=>[...s.contributions].sort((y,R)=>new Date(R.date).getTime()-new Date(y.date).getTime()),[s.contributions]),H=()=>{!d||d<=0||P&&(i==="deposit"?x>=s.targetAmount?u({type:"success",message:"ðŸŽ‰ ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! ÙˆØµÙ„Øª Ù„Ù‡Ø¯ÙÙƒ!",details:`Ø£Ø¶ÙØª ${a(d)} ÙˆÙˆØµÙ„Øª Ù„Ù„Ù‡Ø¯Ù ${a(s.targetAmount)}!`}):u({type:"success",message:`ðŸŽ¯ Ø£Ø­Ø³Ù†Øª! Ø§Ù‚ØªØ±Ø¨Øª ${S.toFixed(1)}% Ù…Ù† Ù‡Ø¯ÙÙƒ`,details:`Ø¨Ø§Ù‚ÙŠ ${a(E)} ÙÙ‚Ø· Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø¯ÙÙƒ`}):u({type:"warning",message:`âš ï¸ Ø§Ø¨ØªØ¹Ø¯Øª ${Math.abs(S).toFixed(1)}% Ø¹Ù† Ù‡Ø¯ÙÙƒ`,details:`Ø§Ù„Ø¢Ù† Ø¨Ø§Ù‚ÙŠ ${a(E)} Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø¯ÙÙƒ`}),g(s.id,l,c||void 0))},_=()=>{p(""),N(""),u(null),k(!1),j("deposit"),h()},X=y=>new Date(y).toLocaleDateString("ar-EG",{year:"numeric",month:"short",day:"numeric"}),A=s.milestones.map(y=>({...y,wouldBeReached:x>=y.targetAmount,isNewlyReached:!y.reached&&x>=y.targetAmount})).filter(y=>y.isNewlyReached);return e.jsx(Me,{open:n,onOpenChange:_,children:e.jsxs(je,{className:"sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx(fe,{children:e.jsxs(Ne,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:s.icon||"ðŸŽ¯"}),s.title]})}),o&&e.jsxs("div",{onClick:()=>{u(null),p(""),N("")},className:$("p-4 rounded-lg text-center animate-pulse cursor-pointer hover:opacity-80 transition-opacity",o.type==="success"?"bg-green-500/10 border border-green-500/30":"bg-yellow-500/10 border border-yellow-500/30"),children:[e.jsx("p",{className:"font-bold text-lg text-foreground",children:o.message}),o.details&&e.jsx("p",{className:"text-sm text-foreground/70 mt-1",children:o.details}),e.jsx("p",{className:"text-xs text-muted-foreground mt-3",children:"Ø§Ø¶ØºØ· Ù„Ù„Ø¥ØºÙ„Ø§Ù‚"})]}),!o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg space-y-3 text-foreground",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ"}),e.jsx("span",{className:"font-bold text-lg",children:a(s.currentAmount)})]}),e.jsx("div",{className:"h-3 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-300",style:{width:`${Math.min(v,100)}%`,backgroundColor:s.color||"var(--primary)"}})}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[v.toFixed(1),"% Ù…ÙƒØªÙ…Ù„"]}),e.jsxs("span",{children:["Ø§Ù„Ù‡Ø¯Ù: ",a(s.targetAmount)]})]})]}),s.milestones.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(L,{className:"text-sm flex items-center gap-2",children:[e.jsx(Le,{className:"h-4 w-4 text-yellow-500"}),"Ø§Ù„Ù…Ø±Ø§Ø­Ù„ (Ù†Ù‚Ø§Ø· Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²)"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.milestones.map(y=>{const R=x>=y.targetAmount,W=!y.reached&&d>0&&R;return e.jsxs("div",{className:$("p-2 rounded-lg border text-xs",y.reached?"bg-green-500/10 border-green-500/30":W?"bg-yellow-500/10 border-yellow-500/30 animate-pulse":"bg-muted/30 border-border"),children:[e.jsxs("div",{className:"flex items-center gap-1",children:[y.reached?e.jsx(as,{className:"h-3 w-3 text-green-500"}):W?e.jsx(Nt,{className:"h-3 w-3 text-yellow-500"}):e.jsx(Ie,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"font-medium truncate",children:y.title})]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:a(y.targetAmount)})]},y.id)})})]}),e.jsxs("div",{className:"flex gap-2 p-1 bg-muted rounded-lg",children:[e.jsxs(F,{variant:i==="deposit"?"default":"ghost",className:$("flex-1",i==="deposit"&&"bg-green-600 hover:bg-green-700"),onClick:()=>j("deposit"),children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),"Ø¥ÙŠØ¯Ø§Ø¹"]}),e.jsxs(F,{variant:i==="withdraw"?"default":"ghost",className:$("flex-1",i==="withdraw"&&"bg-orange-600 hover:bg-orange-700"),onClick:()=>j("withdraw"),children:[e.jsx(xt,{className:"h-4 w-4 mr-2"}),"Ø³Ø­Ø¨"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),e.jsx(ne,{type:"number",min:"0",step:"1",value:m,onChange:y=>p(y.target.value),placeholder:i==="deposit"?"Ø£Ø¯Ø®Ù„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹":"Ø£Ø¯Ø®Ù„ Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø­Ø¨",className:$(!P&&"border-red-500 focus-visible:ring-red-500")}),!P&&e.jsxs("p",{className:"text-xs text-red-500 flex items-center gap-1",children:[e.jsx(Oe,{className:"h-3 w-3"}),"Ø§Ù„Ù…Ø¨Ù„Øº Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ (",a(s.currentAmount),")"]})]}),d>0&&P&&e.jsxs("div",{className:$("p-3 rounded-lg border",i==="deposit"?"bg-green-500/5 border-green-500/30":"bg-orange-500/5 border-orange-500/30"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[i==="deposit"?e.jsx(pe,{className:"h-4 w-4 text-green-500"}):e.jsx(Xe,{className:"h-4 w-4 text-orange-500"}),e.jsx("span",{className:"text-sm",children:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯"})]}),e.jsx("span",{className:"font-bold",children:a(x)})]}),e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground flex items-center gap-2",children:[e.jsxs("span",{children:[v.toFixed(1),"%"]}),e.jsx("span",{children:"â†’"}),e.jsxs("span",{className:$("font-medium",i==="deposit"?"text-green-500":"text-orange-500"),children:[I.toFixed(1),"%"]}),e.jsxs("span",{className:$(i==="deposit"?"text-green-500":"text-orange-500"),children:["(",S>0?"+":"",S.toFixed(1),"%)"]})]}),A.length>0&&i==="deposit"&&e.jsxs("div",{className:"mt-2 text-xs text-yellow-500 flex items-center gap-1",children:[e.jsx(Nt,{className:"h-3 w-3"}),"Ø³ØªØµÙ„ Ù„Ù…Ø±Ø­Ù„Ø©:"," ",A.map(y=>y.title).join("ØŒ ")]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsx(He,{value:c,onChange:y=>N(y.target.value),placeholder:"Ù…Ø«Ø§Ù„: Ø±Ø§ØªØ¨ Ø´Ù‡Ø± ÙŠÙ†Ø§ÙŠØ±",rows:2})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{className:$("flex-1",i==="deposit"?"bg-green-600 hover:bg-green-700":"bg-orange-600 hover:bg-orange-700"),onClick:H,disabled:!d||!P,children:i==="deposit"?e.jsxs(e.Fragment,{children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),"Ø¥ÙŠØ¯Ø§Ø¹"," ",d>0&&a(d)]}):e.jsxs(e.Fragment,{children:[e.jsx(xt,{className:"h-4 w-4 mr-2"}),"Ø³Ø­Ø¨"," ",d>0&&a(d)]})}),e.jsx(F,{variant:"outline",onClick:_,children:"Ø¥Ù„ØºØ§Ø¡"})]}),e.jsxs(F,{variant:"ghost",className:"w-full text-muted-foreground",onClick:()=>k(!f),children:[e.jsx($t,{className:"h-4 w-4 mr-2"}),f?"Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø³Ø¬Ù„":"Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª",s.contributions.length>0&&e.jsx("span",{className:"ml-2 bg-muted px-2 py-0.5 rounded text-xs",children:s.contributions.length})]}),f&&e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:q.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø³Ø§Ø¨Ù‚Ø©"}):q.map(y=>e.jsxs("div",{className:$("flex items-center justify-between p-3 rounded-lg border",y.amount>=0?"bg-green-500/5 border-green-500/20":"bg-orange-500/5 border-orange-500/20"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[y.amount>=0?e.jsx(mt,{className:"h-4 w-4 text-green-500"}):e.jsx(xt,{className:"h-4 w-4 text-orange-500"}),e.jsxs("div",{children:[e.jsxs("p",{className:$("font-medium text-sm",y.amount>=0?"text-green-600":"text-orange-600"),children:[y.amount>=0?"+":"",a(y.amount)]}),y.notes&&e.jsx("p",{className:"text-xs text-muted-foreground",children:y.notes})]})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:X(y.date)})]},y.id))})]})]})})}const Bs=({goals:n,formatCurrency:h,onEdit:s,onDelete:a,onContribute:g})=>{const[i,j]=r.useState(null),[m,p]=r.useState(null),c=n.filter(d=>d.status==="active"),N=n.filter(d=>d.status==="completed"),f=(d,l,x)=>{g&&g(d,l,x)},k=d=>{switch(d){case"emergency-fund":return"ðŸ›¡ï¸";case"savings":return"ðŸ’°";case"investment":return"ðŸ“ˆ";case"purchase":return"ðŸ›’";case"travel":return"âœˆï¸";case"education":return"ðŸŽ“";default:return"ðŸŽ¯"}},o=d=>{switch(d){case"critical":return"text-red-500 bg-red-500/10";case"high":return"text-orange-500 bg-orange-500/10";case"medium":return"text-yellow-500 bg-yellow-500/10";default:return"text-blue-500 bg-blue-500/10"}},u=d=>{if(!d)return null;const l=new Date,v=new Date(d).getTime()-l.getTime(),I=Math.ceil(v/(1e3*60*60*24));return I<0?"Overdue":I===0?"Today":I===1?"Tomorrow":I<7?`${I} days`:I<30?`${Math.ceil(I/7)} weeks`:I<365?`${Math.ceil(I/30)} months`:`${Math.ceil(I/365)} years`};return e.jsxs("div",{className:"space-y-4",children:[n.length===0&&e.jsx(K,{children:e.jsxs(J,{className:"py-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(Ie,{className:"h-8 w-8 text-primary"})}),e.jsx("h4",{className:"font-semibold mb-2",children:"No Goals Yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Set financial goals to track your progress towards saving for what matters"})]})}),c.length>0&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:c.map(d=>{const l=d.currentAmount/d.targetAmount*100,x=u(d.deadline);return e.jsx(K,{className:"overflow-hidden",children:e.jsxs(J,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl shrink-0",style:{backgroundColor:d.color?`${d.color}20`:"var(--primary-10)"},children:d.icon||k(d.category)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[e.jsx("h4",{className:"font-semibold truncate",children:d.title}),e.jsx("span",{className:$("text-xs px-1.5 py-0.5 rounded",o(d.priority)),children:d.priority})]}),d.description&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:d.description})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-semibold text-primary tabular-nums",children:h(d.currentAmount)}),e.jsx("span",{className:"text-muted-foreground tabular-nums",children:h(d.targetAmount)})]}),e.jsx("div",{className:"h-3 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${Math.min(l,100)}%`,backgroundColor:d.color||"var(--primary)"}})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[l.toFixed(0),"% complete"]}),x&&e.jsxs("span",{children:[x," remaining"]})]})]}),d.monthlyContribution>0&&e.jsx("div",{className:"mt-3 pt-3 border-t border-border",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx(pe,{className:"h-3 w-3 inline mr-1"}),"Contributing"," ",h(d.monthlyContribution),"/month"]})}),d.milestones.length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-border",children:[e.jsxs("p",{className:"text-xs text-muted-foreground mb-2 flex items-center gap-1",children:[e.jsx(Le,{className:"h-3 w-3"}),"Ø§Ù„Ù…Ø±Ø§Ø­Ù„ (",d.milestones.filter(v=>v.reached).length,"/",d.milestones.length,")"]}),e.jsx("div",{className:"flex gap-1",children:d.milestones.map(v=>e.jsx("div",{className:$("flex-1 h-2 rounded-full transition-colors",v.reached?"bg-green-500":"bg-muted"),title:`${v.title}: ${h(v.targetAmount)}`},v.id))})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-border flex gap-2",children:[e.jsxs(F,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>j(d),children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),"Ø¥ÙŠØ¯Ø§Ø¹ / Ø³Ø­Ø¨"]}),s&&e.jsx(F,{size:"sm",variant:"ghost",onClick:()=>s(d),children:e.jsx(pt,{className:"h-4 w-4"})}),a&&e.jsx(F,{size:"sm",variant:"ghost",className:"text-red-500 hover:text-red-600 hover:bg-red-500/10",onClick:()=>p(d),children:e.jsx(me,{className:"h-4 w-4"})})]})]})},d.id)})}),N.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground mb-3 flex items-center gap-2",children:[e.jsx(Le,{className:"h-4 w-4 text-yellow-500"}),"Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©"]}),e.jsx("div",{className:"space-y-2 text-foreground",children:N.map(d=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/30 cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>j(d),children:[e.jsx("span",{className:"text-xl",children:d.icon||k(d.category)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:d.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[h(d.targetAmount)," ØªÙ… ØªØ­Ù‚ÙŠÙ‚Ù‡"]})]}),e.jsx(Le,{className:"h-5 w-5 text-yellow-500"})]},d.id))})]}),i&&e.jsx(Ps,{isOpen:!!i,onClose:()=>j(null),goal:i,formatCurrency:h,onContribute:f}),e.jsx(Me,{open:!!m,onOpenChange:()=>p(null),children:e.jsxs(je,{className:"sm:max-w-md",children:[e.jsxs(fe,{children:[e.jsxs(Ne,{className:"text-red-500 flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5"}),"Ø­Ø°Ù Ø§Ù„Ù‡Ø¯Ù"]}),e.jsx(it,{children:"Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù‡Ø¯ÙØŸ"})]}),m&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:m.icon||k(m.category)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:m.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Ø§Ù„Ø±ØµÙŠØ¯:"," ",h(m.currentAmount)," ","/"," ",h(m.targetAmount)]})]})]})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"âš ï¸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ù‡Ø¯Ù ÙˆØ¬Ù…ÙŠØ¹ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ ÙˆØ§Ù„Ø³Ø­Ø¨ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{variant:"destructive",className:"flex-1",onClick:()=>{a&&m&&(a(m.id),p(null))},children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Ù†Ø¹Ù…ØŒ Ø§Ø­Ø°Ù Ø§Ù„Ù‡Ø¯Ù"]}),e.jsx(F,{variant:"outline",onClick:()=>p(null),children:"Ø¥Ù„ØºØ§Ø¡"})]})]})]})})]})},Gs=({installments:n,formatCurrency:h,onEdit:s,onDelete:a,onPayInstallment:g})=>{const[i,j]=r.useState(null),m=n.filter(u=>u.status==="active"),p=n.filter(u=>u.status==="completed"),c=u=>{const d=new Date,x=new Date(u).getTime()-d.getTime();return Math.ceil(x/(1e3*60*60*24))},N=(u,d)=>u==="completed"?"bg-green-500/10 text-green-500":u==="paused"?"bg-yellow-500/10 text-yellow-500":u==="overdue"||d!==void 0&&d<0?"bg-red-500/10 text-red-500":d!==void 0&&d<=3?"bg-orange-500/10 text-orange-500":"bg-primary/10 text-primary",f=u=>{const d=c(u);return d<0?`${Math.abs(d)} days overdue`:d===0?"Due today":d===1?"Due tomorrow":d<=7?`Due in ${d} days`:new Date(u).toLocaleDateString("en-US",{month:"short",day:"numeric"})},k=m.reduce((u,d)=>u+(d.totalAmount-d.paidAmount),0),o=m.reduce((u,d)=>u+d.installmentAmount,0);return e.jsxs("div",{className:"space-y-4",children:[m.length>0&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(K,{children:e.jsxs(J,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Total Remaining"}),e.jsx("p",{className:"text-xl font-bold text-foreground tabular-nums",children:h(k)})]})}),e.jsx(K,{children:e.jsxs(J,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Monthly Payments"}),e.jsx("p",{className:"text-xl font-bold text-orange-500 tabular-nums",children:h(o)})]})})]}),n.length===0&&e.jsx(K,{children:e.jsxs(J,{className:"py-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(Qe,{className:"h-8 w-8 text-primary"})}),e.jsx("h4",{className:"font-semibold mb-2",children:"No Installments"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Track your installments, loans, and recurring payments"})]})}),m.length>0&&e.jsx("div",{className:"space-y-3",children:m.map(u=>{const d=u.paidInstallments/u.totalInstallments*100,l=u.totalInstallments-u.paidInstallments,x=c(u.nextPaymentDate),v=x<=3;return e.jsx(K,{className:$("overflow-hidden transition-all",v&&x>=0&&"border-orange-500/50",x<0&&"border-red-500/50"),children:e.jsxs(J,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-semibold truncate",children:u.title}),x<0&&e.jsx(Oe,{className:"h-4 w-4 text-red-500 shrink-0"})]}),u.description&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:u.description})]}),e.jsx(ts,{variant:"secondary",className:$("shrink-0",N(u.status,x)),children:f(u.nextPaymentDate)})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[u.paidInstallments," ","of"," ",u.totalInstallments," ","paid"]}),e.jsxs("span",{className:"font-medium",children:[d.toFixed(0),"%"]})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary rounded-full transition-all",style:{width:`${d}%`}})})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-muted-foreground",children:["Each:"," "]}),e.jsx("span",{className:"font-semibold tabular-nums",children:h(u.installmentAmount)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-muted-foreground",children:["Remaining:"," "]}),e.jsx("span",{className:"font-semibold tabular-nums",children:h(u.totalAmount-u.paidAmount)})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-border",children:e.jsx("p",{className:"text-xs text-center",children:l===1?e.jsx("span",{className:"text-green-500 font-medium",children:"ðŸŽ‰ Just 1 more payment to go!"}):l<=3?e.jsxs("span",{className:"text-primary font-medium",children:["ðŸ’ª Only ",l," payments left!"]}):e.jsxs("span",{className:"text-muted-foreground",children:[l," payments remaining"]})})}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[g&&e.jsxs(F,{size:"sm",variant:v?"default":"outline",className:"flex-1",onClick:()=>g(u.id),children:[e.jsx(Ye,{className:"h-4 w-4 mr-1"}),"Pay (",h(u.installmentAmount),")"]}),s&&e.jsx(F,{size:"sm",variant:"ghost",onClick:()=>s(u),children:e.jsx(pt,{className:"h-4 w-4"})}),a&&e.jsx(F,{size:"sm",variant:"ghost",className:"text-red-500 hover:text-red-600 hover:bg-red-500/10",onClick:()=>j(u),children:e.jsx(me,{className:"h-4 w-4"})})]})]})},u.id)})}),p.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground mb-3 flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4 text-green-500"}),"Completed"]}),e.jsx("div",{className:"space-y-2",children:p.slice(0,3).map(u=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/30",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-500/10 flex items-center justify-center",children:e.jsx(Ve,{className:"h-5 w-5 text-green-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:u.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[h(u.totalAmount)," ","paid off"]})]}),a&&e.jsx(F,{size:"sm",variant:"ghost",className:"text-red-500 hover:text-red-600 hover:bg-red-500/10",onClick:()=>j(u),children:e.jsx(me,{className:"h-4 w-4"})})]},u.id))})]}),e.jsx(Me,{open:!!i,onOpenChange:()=>j(null),children:e.jsxs(je,{className:"sm:max-w-md",children:[e.jsxs(fe,{children:[e.jsxs(Ne,{className:"text-red-500 flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5"}),"Ø­Ø°Ù Ø§Ù„Ù‚Ø³Ø·"]}),e.jsx(it,{children:"Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ø·ØŸ"})]}),i&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qe,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:i.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[i.paidInstallments," /"," ",i.totalInstallments," ","Ø£Ù‚Ø³Ø§Ø· Ù…Ø¯ÙÙˆØ¹Ø©"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:"," ",h(i.totalAmount-i.paidAmount)]})]})]})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"âš ï¸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ù‚Ø³Ø· ÙˆØ¬Ù…ÙŠØ¹ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{variant:"destructive",className:"flex-1",onClick:()=>{a&&i&&(a(i.id),j(null))},children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Ù†Ø¹Ù…ØŒ Ø§Ø­Ø°Ù Ø§Ù„Ù‚Ø³Ø·"]}),e.jsx(F,{variant:"outline",onClick:()=>j(null),children:"Ø¥Ù„ØºØ§Ø¡"})]})]})]})})]})},Ls=({alerts:n,onDismiss:h,maxVisible:s=3})=>{const g=[...n].sort((m,p)=>{const c={critical:0,warning:1,success:2,info:3};return c[m.severity]-c[p.severity]}).slice(0,s),i=n.length-s,j=m=>{switch(m){case"critical":return{bg:"bg-red-500/10 border-red-500/30",icon:Oe,iconColor:"text-red-500"};case"warning":return{bg:"bg-yellow-500/10 border-yellow-500/30",icon:Oe,iconColor:"text-yellow-500"};case"success":return{bg:"bg-green-500/10 border-green-500/30",icon:et,iconColor:"text-green-500"};default:return{bg:"bg-blue-500/10 border-blue-500/30",icon:ls,iconColor:"text-blue-500"}}};return n.length===0?null:e.jsxs("div",{className:"space-y-2",children:[g.map(m=>{const p=j(m.severity),c=p.icon;return e.jsxs("div",{className:$("flex items-start gap-3 p-3 rounded-lg border transition-all animate-in fade-in-0 slide-in-from-top-2",p.bg),children:[e.jsx(c,{className:$("h-5 w-5 mt-0.5 shrink-0",p.iconColor)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium",children:m.title}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:m.message}),m.actionable&&m.actionLabel&&e.jsxs("button",{className:"text-xs text-primary font-medium mt-2 flex items-center gap-1 hover:underline",children:[m.actionLabel,e.jsx(lt,{className:"h-3 w-3"})]})]}),!m.dismissed&&e.jsx("button",{onClick:()=>h(m.id),className:"p-1 rounded-full hover:bg-background/50 transition-colors shrink-0",children:e.jsx(Ze,{className:"h-4 w-4 text-muted-foreground"})})]},m.id)}),i>0&&e.jsxs("button",{className:"w-full text-center py-2 text-xs text-muted-foreground hover:text-foreground transition-colors",children:["+",i," more notification",i>1?"s":""]})]})};function Ys({incomes:n,expenses:h,formatCurrency:s}){const a=r.useMemo(()=>{const j=new Date,m=[];for(let p=5;p>=0;p--){const c=new Date(j.getFullYear(),j.getMonth()-p,1),N=`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}`,f=c.toLocaleDateString("ar-EG",{month:"short"}),k=n.filter(u=>{const d=new Date(u.actualDate||u.expectedDate||u.createdAt);return d.getFullYear()===c.getFullYear()&&d.getMonth()===c.getMonth()&&u.status==="received"}).reduce((u,d)=>u+d.amount,0),o=h.filter(u=>{const d=new Date(u.date);return d.getFullYear()===c.getFullYear()&&d.getMonth()===c.getMonth()}).reduce((u,d)=>u+d.amount,0);m.push({month:N,monthLabel:f,income:k,expenses:o,savings:k-o})}return m},[n,h]),g=r.useMemo(()=>{if(a.length<2)return{type:"neutral",percentage:0};const j=a[a.length-1],m=a[a.length-2];if(m.savings===0)return{type:"neutral",percentage:0};const p=(j.savings-m.savings)/Math.abs(m.savings)*100;return{type:p>=0?"up":"down",percentage:Math.abs(p).toFixed(1)}},[a]),i=a.reduce((j,m)=>j+m.savings,0);return e.jsxs(K,{children:[e.jsxs(re,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ce,{className:"text-base font-medium",children:"Ø§Ù„Ø¯Ø®Ù„ Ù…Ù‚Ø§Ø¨Ù„ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª"}),e.jsx("div",{className:"flex items-center gap-2 text-sm",children:g.type==="up"?e.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(pe,{className:"h-4 w-4"}),"+",g.percentage,"%"]}):g.type==="down"?e.jsxs("span",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(Xe,{className:"h-4 w-4"}),"-",g.percentage,"%"]}):null})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙˆÙÙŠØ±: ",s(i)]})]}),e.jsx(J,{children:e.jsx("div",{className:"h-[250px] w-full",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(vs,{data:a,margin:{top:5,right:10,left:10,bottom:5},children:[e.jsx(zt,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(qt,{dataKey:"monthLabel",tick:{fontSize:12},className:"text-muted-foreground"}),e.jsx(Wt,{tick:{fontSize:12},tickFormatter:j=>`${(j/1e3).toFixed(0)}k`,className:"text-muted-foreground"}),e.jsx(ft,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px",direction:"rtl"},formatter:(j,m)=>[s(j),m==="income"?"Ø§Ù„Ø¯Ø®Ù„":m==="expenses"?"Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª":"Ø§Ù„ØªÙˆÙÙŠØ±"],labelFormatter:j=>`Ø´Ù‡Ø± ${j}`}),e.jsx(Vt,{formatter:j=>j==="income"?"Ø§Ù„Ø¯Ø®Ù„":j==="expenses"?"Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª":"Ø§Ù„ØªÙˆÙÙŠØ±"}),e.jsx(ut,{type:"monotone",dataKey:"income",stroke:"#22c55e",strokeWidth:2,dot:{fill:"#22c55e",strokeWidth:2},activeDot:{r:6}}),e.jsx(ut,{type:"monotone",dataKey:"expenses",stroke:"#ef4444",strokeWidth:2,dot:{fill:"#ef4444",strokeWidth:2},activeDot:{r:6}}),e.jsx(ut,{type:"monotone",dataKey:"savings",stroke:"#3b82f6",strokeWidth:2,strokeDasharray:"5 5",dot:{fill:"#3b82f6",strokeWidth:2},activeDot:{r:6}})]})})})})]})}function zs({expenses:n,categories:h,formatCurrency:s,period:a="month"}){const g=r.useMemo(()=>{const j=new Date;let m;switch(a){case"week":m=new Date(j.getTime()-6048e5);break;case"year":m=new Date(j.getFullYear(),0,1);break;case"month":default:m=new Date(j.getFullYear(),j.getMonth(),1);break}const p=n.filter(k=>{const o=new Date(k.date);return o>=m&&o<=j}),c={};p.forEach(k=>{const o=k.categoryId;c[o]=(c[o]||0)+k.amount});const N=Object.values(c).reduce((k,o)=>k+o,0);return{data:Object.entries(c).map(([k,o])=>{const u=h.find(d=>d.id===k)||{name:"Ø£Ø®Ø±Ù‰",color:"#64748b",icon:"ðŸ“¦"};return{name:u.name,value:o,color:u.color,icon:u.icon,percentage:N>0?o/N*100:0}}).sort((k,o)=>o.value-k.value).slice(0,8),total:N}},[n,h,a]),i=a==="week"?"Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹":a==="year"?"Ù‡Ø°Ù‡ Ø§Ù„Ø³Ù†Ø©":"Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±";return g.data.length===0?e.jsxs(K,{children:[e.jsxs(re,{className:"pb-2",children:[e.jsx(ce,{className:"text-base font-medium",children:"Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i})]}),e.jsx(J,{children:e.jsx("div",{className:"flex h-[250px] items-center justify-center text-muted-foreground",children:e.jsxs("p",{children:["Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ØµØ±ÙˆÙØ§Øª ",i]})})})]}):e.jsxs(K,{children:[e.jsxs(re,{className:"pb-2",children:[e.jsx(ce,{className:"text-base font-medium",children:"Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[i," â€¢ Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ",s(g.total)]})]}),e.jsxs(J,{children:[e.jsx("div",{className:"h-[250px] w-full",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(ws,{children:[e.jsx(Cs,{data:g.data,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:2,dataKey:"value",children:g.data.map(j=>e.jsx(Ss,{fill:j.color},`cell-${j.name}`))}),e.jsx(ft,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px",direction:"rtl"},formatter:j=>[s(j),"Ø§Ù„Ù…Ø¨Ù„Øº"]}),e.jsx(Vt,{layout:"vertical",align:"right",verticalAlign:"middle",formatter:j=>{const m=g.data.find(p=>p.name===j);return e.jsxs("span",{className:"text-xs",children:[m?.icon," ",j," (",m?.percentage.toFixed(0),"%)"]})}})]})})}),e.jsx("div",{className:"mt-4 space-y-2",children:g.data.slice(0,3).map(j=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-3 w-3 rounded-full",style:{backgroundColor:j.color}}),e.jsxs("span",{children:[j.icon," ",j.name]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s(j.value)}),e.jsxs("span",{className:"text-muted-foreground",children:["(",j.percentage.toFixed(0),"%)"]})]})]},j.name))})]})]})}const St=[{value:"car",label:"Ø³ÙŠØ§Ø±Ø©",icon:"ðŸš—"},{value:"home",label:"Ù…Ù†Ø²Ù„/Ø¹Ù‚Ø§Ø±",icon:"ðŸ "},{value:"electronics",label:"Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª",icon:"ðŸ“±"},{value:"furniture",label:"Ø£Ø«Ø§Ø«",icon:"ðŸ›‹ï¸"},{value:"education",label:"ØªØ¹Ù„ÙŠÙ…",icon:"ðŸ“š"},{value:"medical",label:"Ø·Ø¨ÙŠ",icon:"ðŸ’Š"},{value:"loan",label:"Ù‚Ø±Ø¶ Ø´Ø®ØµÙŠ",icon:"ðŸ’°"},{value:"other",label:"Ø£Ø®Ø±Ù‰",icon:"ðŸ“¦"}];function qs({isOpen:n,onClose:h,onSave:s,installment:a}){const[g,i]=r.useState(""),[j,m]=r.useState(""),[p,c]=r.useState(""),[N,f]=r.useState(""),[k,o]=r.useState("0"),[u,d]=r.useState("monthly"),[l,x]=r.useState("other"),[v,I]=r.useState(""),[S,E]=r.useState("3"),[P,q]=r.useState(!1),[H,_]=r.useState(""),[X,w]=r.useState(null),A=parseFloat(j)||0,y=parseFloat(p)||0,R=parseInt(N)||0,W=parseInt(k)||0,ie=y*W,xe=A-ie;r.useEffect(()=>{a?(i(a.title),m(a.totalAmount.toString()),c(a.installmentAmount.toString()),f(a.totalInstallments.toString()),o(a.paidInstallments.toString()),d(a.frequency),x(a.categoryId),I(a.startDate.split("T")[0]),E(a.remindDaysBefore.toString()),q(a.autoPayment),_(a.notes||"")):ye()},[a,n]);const ye=()=>{i(""),m(""),c(""),f(""),o("0"),d("monthly"),x("other"),I(new Date().toISOString().split("T")[0]),E("3"),q(!1),_(""),w(null)};r.useEffect(()=>{X==="total"&&A>0&&R>0?c((A/R).toFixed(2)):X==="installment"&&y>0&&R>0?m((y*R).toFixed(2)):X==="count"&&R>0&&(A>0?c((A/R).toFixed(2)):y>0&&m((y*R).toFixed(2)))},[j,p,N,X]);const de=t=>{m(t),w("total")},ue=t=>{c(t),w("installment")},be=t=>{f(t),w("count")},ee=()=>{const t=new Date(v),D=new Date;let T=new Date(t);for(;T<=D;)switch(u){case"weekly":T.setDate(T.getDate()+7);break;case"monthly":T.setMonth(T.getMonth()+1);break;case"quarterly":T.setMonth(T.getMonth()+3);break}return T.toISOString()},Z=()=>{const t=new Date(v),D=R-W;switch(u){case"weekly":t.setDate(t.getDate()+7*D);break;case"monthly":t.setMonth(t.getMonth()+D);break;case"quarterly":t.setMonth(t.getMonth()+3*D);break}return t.toISOString()},b=t=>{t.preventDefault(),!(!g||!j||!p||!N||!v)&&(s({title:g,totalAmount:A,paidAmount:ie,installmentAmount:y,totalInstallments:R,paidInstallments:W,frequency:u,startDate:new Date(v).toISOString(),nextPaymentDate:ee(),endDate:Z(),categoryId:l,status:W>=R?"completed":"active",autoPayment:P,remindDaysBefore:parseInt(S),notes:H||void 0,payments:a?.payments||[],updatedAt:new Date().toISOString()}),h())},C=St.find(t=>t.value===l);return e.jsx(Me,{open:n,onOpenChange:h,children:e.jsxs(je,{className:"max-h-[90vh] overflow-y-auto sm:max-w-lg",children:[e.jsx(fe,{children:e.jsxs(Ne,{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5"}),a?"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Ø³Ø·":"Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ø· Ø¬Ø¯ÙŠØ¯"]})}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"title",children:"Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ø·"}),e.jsx(ne,{id:"title",value:g,onChange:t=>i(t.target.value),placeholder:"Ù…Ø«Ø§Ù„: Ù‚Ø³Ø· Ø§Ù„Ø³ÙŠØ§Ø±Ø©",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Ø§Ù„ÙØ¦Ø©"}),e.jsxs(Se,{value:l,onValueChange:x,children:[e.jsx(De,{children:e.jsxs(Ae,{children:[C?.icon," ",C?.label]})}),e.jsx(ke,{children:St.map(t=>e.jsxs(ae,{value:t.value,children:[t.icon," ",t.label]},t.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"totalAmount",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"}),e.jsx(ne,{id:"totalAmount",type:"number",min:"0",step:"0.01",value:j,onChange:t=>de(t.target.value),placeholder:"0.00",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"installmentAmount",children:"Ù‚ÙŠÙ…Ø© Ø§Ù„Ù‚Ø³Ø·"}),e.jsx(ne,{id:"installmentAmount",type:"number",min:"0",step:"0.01",value:p,onChange:t=>ue(t.target.value),placeholder:"0.00",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"totalInstallments",children:"Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„ÙƒÙ„ÙŠ"}),e.jsx(ne,{id:"totalInstallments",type:"number",min:"1",value:N,onChange:t=>be(t.target.value),placeholder:"12",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"paidInstallments",children:"Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø©"}),e.jsx(ne,{id:"paidInstallments",type:"number",min:"0",max:N,value:k,onChange:t=>o(t.target.value),placeholder:"0"})]})]}),A>0&&R>0&&e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Ø§Ù„Ù…Ø¯ÙÙˆØ¹"}),e.jsxs("span",{className:"font-medium text-green-600",children:[ie.toLocaleString("ar-EG")," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ"}),e.jsxs("span",{className:"font-medium text-red-600",children:[xe.toLocaleString("ar-EG")," ","Ø¬.Ù…"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©"}),e.jsxs("span",{className:"font-medium",children:[R-W," Ù‚Ø³Ø·"]})]}),e.jsx("div",{className:"h-2 rounded-full bg-muted overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 transition-all",style:{width:`${W/R*100}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"ØªÙƒØ±Ø§Ø± Ø§Ù„Ø¯ÙØ¹"}),e.jsxs(Se,{value:u,onValueChange:t=>d(t),children:[e.jsx(De,{children:e.jsx(Ae,{})}),e.jsxs(ke,{children:[e.jsx(ae,{value:"weekly",children:"Ø£Ø³Ø¨ÙˆØ¹ÙŠ"}),e.jsx(ae,{value:"monthly",children:"Ø´Ù‡Ø±ÙŠ"}),e.jsx(ae,{value:"quarterly",children:"Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"startDate",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ue,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(ne,{id:"startDate",type:"date",value:v,onChange:t=>I(t.target.value),className:"pl-10",required:!0})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(L,{htmlFor:"remindDaysBefore",className:"flex items-center gap-2",children:[e.jsx(Pt,{className:"h-4 w-4"}),"Ø§Ù„ØªØ°ÙƒÙŠØ± Ù‚Ø¨Ù„ Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø¨Ù€"]}),e.jsxs(Se,{value:S,onValueChange:E,children:[e.jsx(De,{children:e.jsx(Ae,{})}),e.jsxs(ke,{children:[e.jsx(ae,{value:"1",children:"ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯"}),e.jsx(ae,{value:"3",children:"3 Ø£ÙŠØ§Ù…"}),e.jsx(ae,{value:"7",children:"Ø£Ø³Ø¨ÙˆØ¹"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(et,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Ø¯ÙØ¹ ØªÙ„Ù‚Ø§Ø¦ÙŠ"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯ÙØ¹ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙÙŠ Ù…ÙˆØ¹Ø¯Ù‡"})]})]}),e.jsx(F,{type:"button",variant:P?"default":"outline",size:"sm",onClick:()=>q(!P),children:P?"Ù…ÙØ¹Ù‘Ù„":"Ù…Ø¹Ø·Ù‘Ù„"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"notes",children:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsx(He,{id:"notes",value:H,onChange:t=>_(t.target.value),placeholder:"Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©...",rows:2})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(F,{type:"submit",className:"flex-1",children:a?"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª":"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ø³Ø·"}),e.jsx(F,{type:"button",variant:"outline",onClick:h,children:"Ø¥Ù„ØºØ§Ø¡"})]})]})]})})}function Ws({isOpen:n,onClose:h,installment:s,onPay:a,formatCurrency:g}){const[i,j]=r.useState(""),[m,p]=r.useState(new Date().toISOString().split("T")[0]),[c,N]=r.useState(""),[f,k]=r.useState(!1);if(!s)return null;const o=s.installmentAmount,u=new Date(s.nextPaymentDate),d=new Date(m),l=d<u,x=d>u,v=l?Math.ceil((u.getTime()-d.getTime())/(1e3*60*60*24)):0,I=x?Math.ceil((d.getTime()-u.getTime())/(1e3*60*60*24)):0,S=parseFloat(i)||o,E=S<o,P=s.totalAmount-s.paidAmount-S,q=()=>{if(!i&&!o)return;const w=x?"late":E?"partial":"paid";a(s.id,{date:m,amount:S,status:w,lateFee:x?0:void 0,notes:c||void 0}),j(""),p(new Date().toISOString().split("T")[0]),N(""),h()},H=w=>new Date(w).toLocaleDateString("ar-EG",{year:"numeric",month:"short",day:"numeric"}),_=w=>{switch(w){case"paid":return"text-green-500 bg-green-500/10";case"late":return"text-orange-500 bg-orange-500/10";case"partial":return"text-yellow-500 bg-yellow-500/10";case"missed":return"text-red-500 bg-red-500/10";default:return"text-muted-foreground bg-muted"}},X=w=>{switch(w){case"paid":return"Ù…Ø¯ÙÙˆØ¹";case"late":return"Ù…ØªØ£Ø®Ø±";case"partial":return"Ø¬Ø²Ø¦ÙŠ";case"missed":return"ÙØ§Ø¦Øª";default:return w}};return e.jsx(Me,{open:n,onOpenChange:h,children:e.jsxs(je,{className:"max-h-[90vh] overflow-y-auto sm:max-w-md",children:[e.jsx(fe,{children:e.jsxs(Ne,{className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"h-5 w-5"}),"Ø³Ø¯Ø§Ø¯ Ù‚Ø³Ø·"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:s.title}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Ù‚Ø³Ø· ",s.paidInstallments+1," Ù…Ù†"," ",s.totalInstallments]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù…Ø­Ø¯Ø¯:"}),e.jsx("span",{className:"font-medium",children:H(s.nextPaymentDate)})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Ù‚ÙŠÙ…Ø© Ø§Ù„Ù‚Ø³Ø·:"}),e.jsx("span",{className:"font-bold text-primary",children:g(o)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(L,{htmlFor:"paymentDate",className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¯ÙØ¹"]}),e.jsx(ne,{id:"paymentDate",type:"date",value:m,onChange:w=>p(w.target.value)}),l&&e.jsxs("p",{className:"text-xs text-green-500 flex items-center gap-1",children:[e.jsx(et,{className:"h-3 w-3"}),"Ø¯ÙØ¹ Ù…Ø¨ÙƒØ± Ø¨Ù€ ",v," ÙŠÙˆÙ… - Ù…Ù…ØªØ§Ø²! ðŸŽ‰"]}),x&&e.jsxs("p",{className:"text-xs text-orange-500 flex items-center gap-1",children:[e.jsx(gt,{className:"h-3 w-3"}),"Ø¯ÙØ¹ Ù…ØªØ£Ø®Ø± Ø¨Ù€ ",I," ÙŠÙˆÙ…"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"amount",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹"}),e.jsx(ne,{id:"amount",type:"number",min:"0",step:"0.01",value:i,onChange:w=>j(w.target.value),placeholder:o.toString()}),E&&i&&e.jsxs("p",{className:"text-xs text-yellow-500 flex items-center gap-1",children:[e.jsx(rs,{className:"h-3 w-3"}),"Ø¯ÙØ¹ Ø¬Ø²Ø¦ÙŠ - Ø³ÙŠØªØ¨Ù‚Ù‰"," ",g(o-S)]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"notes",children:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsx(He,{id:"notes",value:c,onChange:w=>N(w.target.value),placeholder:"Ù…Ø«Ø§Ù„: Ø¯ÙØ¹Øª Ù…Ù† Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†Ùƒ...",rows:2})]}),e.jsxs("div",{className:"rounded-lg border p-3 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø­Ø§Ù„ÙŠ:"}),e.jsx("span",{children:g(S)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø¯Ø§Ø¯:"}),e.jsx("span",{className:$("font-medium",P<=0?"text-green-500":"text-foreground"),children:P<=0?"âœ… Ù…ÙƒØªÙ…Ù„!":g(P)})]})]}),s.payments.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{type:"button",onClick:()=>k(!f),className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors w-full",children:[e.jsx($t,{className:"h-4 w-4"}),"Ø³Ø¬Ù„ Ø§Ù„Ø¯ÙØ¹Ø§Øª (",s.payments.length,")",f?e.jsx(Bt,{className:"h-4 w-4 mr-auto"}):e.jsx(Gt,{className:"h-4 w-4 mr-auto"})]}),f&&e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto text-foreground",children:s.payments.slice().reverse().map((w,A)=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/30 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-muted-foreground",children:["#",s.payments.length-A]}),e.jsx("span",{children:H(w.date)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:g(w.amount)}),e.jsx("span",{className:$("text-xs px-2 py-0.5 rounded",_(w.status)),children:X(w.status)})]})]},w.id))})]})]}),e.jsxs(ct,{className:"gap-2 sm:gap-0",children:[e.jsx(F,{variant:"outline",onClick:h,children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsxs(F,{onClick:q,className:"gap-2",children:[e.jsx(Ye,{className:"h-4 w-4"}),"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹"]})]})]})})}const Dt=[{value:"emergency-fund",label:"ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦",icon:"ðŸ¥",color:"#ef4444"},{value:"savings",label:"Ø§Ø¯Ø®Ø§Ø± Ø¹Ø§Ù…",icon:"ðŸ’°",color:"#22c55e"},{value:"investment",label:"Ø§Ø³ØªØ«Ù…Ø§Ø±",icon:"ðŸ“ˆ",color:"#3b82f6"},{value:"purchase",label:"Ø´Ø±Ø§Ø¡ Ø´ÙŠØ¡",icon:"ðŸ›ï¸",color:"#f97316"},{value:"travel",label:"Ø³ÙØ±",icon:"âœˆï¸",color:"#8b5cf6"},{value:"education",label:"ØªØ¹Ù„ÙŠÙ…",icon:"ðŸ“š",color:"#14b8a6"},{value:"other",label:"Ø£Ø®Ø±Ù‰",icon:"ðŸŽ¯",color:"#64748b"}],At=[{value:"low",label:"Ù…Ù†Ø®ÙØ¶Ø©",color:"bg-gray-500"},{value:"medium",label:"Ù…ØªÙˆØ³Ø·Ø©",color:"bg-yellow-500"},{value:"high",label:"Ø¹Ø§Ù„ÙŠØ©",color:"bg-orange-500"},{value:"critical",label:"Ø­Ø±Ø¬Ø©",color:"bg-red-500"}];function Vs({isOpen:n,onClose:h,onSave:s,goal:a}){const[g,i]=r.useState(""),[j,m]=r.useState(""),[p,c]=r.useState(""),[N,f]=r.useState("0"),[k,o]=r.useState("savings"),[u,d]=r.useState("medium"),[l,x]=r.useState(""),[v,I]=r.useState(""),[S,E]=r.useState(!1),[P,q]=r.useState([]),[H,_]=r.useState(""),[X,w]=r.useState(""),[A,y]=r.useState(!1),R=parseFloat(p)||0,W=parseFloat(N)||0,ie=parseFloat(v)||0,xe=R>0?W/R*100:0;r.useEffect(()=>{a?(i(a.title),m(a.description||""),c(a.targetAmount.toString()),f(a.currentAmount.toString()),o(a.category),d(a.priority),x(a.deadline?.split("T")[0]||""),I(a.monthlyContribution.toString()),E(a.autoAllocate),q(a.milestones||[]),y((a.milestones||[]).length>0)):ye()},[a,n]);const ye=()=>{i(""),m(""),c(""),f("0"),o("savings"),d("medium"),x(""),I(""),E(!1),q([]),_(""),w(""),y(!1)};r.useEffect(()=>{if(R>0&&l&&!v){const t=new Date(l),D=new Date,T=Math.max(1,(t.getFullYear()-D.getFullYear())*12+(t.getMonth()-D.getMonth())),B=R-W;B>0&&I((B/T).toFixed(0))}},[p,l,N]);const de=()=>{if(!H||!X)return;const t=parseFloat(X);if(isNaN(t)||t<=0)return;const D={id:`milestone-${Date.now()}`,title:H,targetAmount:t,reached:W>=t,reachedAt:W>=t?new Date().toISOString():void 0};q([...P,D].sort((T,B)=>T.targetAmount-B.targetAmount)),_(""),w("")},ue=t=>{q(P.filter(D=>D.id!==t))},be=()=>{if(R<=0)return;const t=[{id:`milestone-auto-25-${Date.now()}`,title:"Ø±Ø¨Ø¹ Ø§Ù„Ø·Ø±ÙŠÙ‚ ðŸŒ±",targetAmount:Math.round(R*.25),reached:W>=R*.25,reachedAt:W>=R*.25?new Date().toISOString():void 0},{id:`milestone-auto-50-${Date.now()}`,title:"Ù†ØµÙ Ø§Ù„Ø·Ø±ÙŠÙ‚ ðŸ”¥",targetAmount:Math.round(R*.5),reached:W>=R*.5,reachedAt:W>=R*.5?new Date().toISOString():void 0},{id:`milestone-auto-75-${Date.now()}`,title:"Ù‚Ø±Ø¨Øª ØªØ®Ù„Øµ ðŸš€",targetAmount:Math.round(R*.75),reached:W>=R*.75,reachedAt:W>=R*.75?new Date().toISOString():void 0}];q(t),y(!0)},ee=t=>{if(t.preventDefault(),!g||!p)return;const D=P.map(T=>({...T,reached:W>=T.targetAmount,reachedAt:W>=T.targetAmount&&!T.reachedAt?new Date().toISOString():T.reachedAt}));s({title:g,description:j||void 0,targetAmount:R,currentAmount:W,currency:"EGP",priority:u,category:k,deadline:l?new Date(l).toISOString():void 0,monthlyContribution:ie,autoAllocate:S,milestones:D,contributions:a?.contributions||[],status:xe>=100?"completed":"active",updatedAt:new Date().toISOString()}),h()},Z=Dt.find(t=>t.value===k),b=At.find(t=>t.value===u),C=()=>{if(!l)return null;const t=new Date(l),D=new Date,T=Math.ceil((t.getTime()-D.getTime())/(1e3*60*60*24));return T<0?"Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ù…ÙˆØ¹Ø¯":T===0?"Ø§Ù„ÙŠÙˆÙ…!":T===1?"ØºØ¯Ø§Ù‹":T<30?`${T} ÙŠÙˆÙ…`:T<365?`${Math.ceil(T/30)} Ø´Ù‡Ø±`:`${(T/365).toFixed(1)} Ø³Ù†Ø©`};return e.jsx(Me,{open:n,onOpenChange:h,children:e.jsxs(je,{className:"max-h-[90vh] overflow-y-auto sm:max-w-lg",children:[e.jsx(fe,{children:e.jsxs(Ne,{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-5 w-5"}),a?"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ù":"Ø¥Ø¶Ø§ÙØ© Ù‡Ø¯Ù Ù…Ø§Ù„ÙŠ Ø¬Ø¯ÙŠØ¯"]})}),e.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"title",children:"Ø§Ø³Ù… Ø§Ù„Ù‡Ø¯Ù"}),e.jsx(ne,{id:"title",value:g,onChange:t=>i(t.target.value),placeholder:"Ù…Ø«Ø§Ù„: Ø´Ø±Ø§Ø¡ Ù„Ø§Ø¨ ØªÙˆØ¨ Ø¬Ø¯ÙŠØ¯",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"description",children:"Ø§Ù„ÙˆØµÙ"}),e.jsx(He,{id:"description",value:j,onChange:t=>m(t.target.value),placeholder:"ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„Ù‡Ø¯Ù...",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Ø§Ù„ÙØ¦Ø©"}),e.jsxs(Se,{value:k,onValueChange:t=>o(t),children:[e.jsx(De,{children:e.jsxs(Ae,{children:[Z?.icon," ",Z?.label]})}),e.jsx(ke,{children:Dt.map(t=>e.jsxs(ae,{value:t.value,children:[t.icon," ",t.label]},t.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©"}),e.jsxs(Se,{value:u,onValueChange:t=>d(t),children:[e.jsx(De,{children:e.jsx(Ae,{children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`h-2 w-2 rounded-full ${b?.color}`}),b?.label]})})}),e.jsx(ke,{children:At.map(t=>e.jsx(ae,{value:t.value,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`h-2 w-2 rounded-full ${t.color}`}),t.label]})},t.value))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"targetAmount",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù"}),e.jsx(ne,{id:"targetAmount",type:"number",min:"0",step:"1",value:p,onChange:t=>c(t.target.value),placeholder:"10000",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"currentAmount",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø­Ø§Ù„ÙŠ"}),e.jsx(ne,{id:"currentAmount",type:"number",min:"0",step:"1",value:N,onChange:t=>f(t.target.value),placeholder:"0"})]})]}),R>0&&e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Ø§Ù„ØªÙ‚Ø¯Ù…"}),e.jsxs("span",{className:"font-medium",children:[xe.toFixed(1),"%"]})]}),e.jsx("div",{className:"h-3 rounded-full bg-muted overflow-hidden",children:e.jsx("div",{className:"h-full transition-all",style:{width:`${Math.min(100,xe)}%`,backgroundColor:Z?.color||"#22c55e"}})}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[W.toLocaleString("ar-EG")," Ø¬.Ù…"]}),e.jsxs("span",{children:[R.toLocaleString("ar-EG")," Ø¬.Ù…"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(L,{htmlFor:"deadline",className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),"Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ"]}),e.jsx(ne,{id:"deadline",type:"date",value:l,onChange:t=>x(t.target.value)}),l&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ",C()]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(L,{htmlFor:"monthlyContribution",className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"Ø§Ù„Ù…Ø³Ø§Ù‡Ù…Ø© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©"]}),e.jsx(ne,{id:"monthlyContribution",type:"number",min:"0",step:"1",value:v,onChange:t=>I(t.target.value),placeholder:"500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"ØªØ®ØµÙŠØµ ØªÙ„Ù‚Ø§Ø¦ÙŠ"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ø®ØµÙ… Ø§Ù„Ù…Ø³Ø§Ù‡Ù…Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ø¯Ø®Ù„"})]}),e.jsx(F,{type:"button",variant:S?"default":"outline",size:"sm",onClick:()=>E(!S),children:S?"Ù…ÙØ¹Ù‘Ù„":"Ù…Ø¹Ø·Ù‘Ù„"})]}),S&&ie>0&&e.jsxs("p",{className:"text-xs text-primary bg-primary/10 p-2 rounded-lg",children:["âœ¨ Ø³ÙŠØªÙ… ØªØ®ØµÙŠØµ ",ie.toLocaleString()," Ø¬.Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙƒÙ„ Ø´Ù‡Ø± Ù„Ù‡Ø°Ø§ Ø§Ù„Ù‡Ø¯Ù"]})]}),R>0&&e.jsxs("div",{className:"space-y-3 border rounded-lg p-3",children:[e.jsxs("button",{type:"button",className:"flex items-center justify-between w-full text-sm",onClick:()=>y(!A),children:[e.jsxs(L,{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(Le,{className:"h-4 w-4 text-yellow-500"}),"Ø§Ù„Ù…Ø±Ø§Ø­Ù„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)",P.length>0&&e.jsx("span",{className:"bg-primary/10 text-primary text-xs px-2 py-0.5 rounded-full",children:P.length})]}),A?e.jsx(Bt,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(Gt,{className:"h-4 w-4 text-muted-foreground"})]}),!A&&P.length===0&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ù†Ù‚Ø§Ø· Ø¥Ù†Ø¬Ø§Ø² ÙˆØ³ÙŠØ·Ø© ØªØ­ÙØ²Ùƒ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø¯ÙÙƒ"}),A&&e.jsxs("div",{className:"space-y-3 pt-2",children:[P.length===0&&e.jsxs(F,{type:"button",variant:"outline",size:"sm",className:"w-full",onClick:be,children:[e.jsx(_e,{className:"h-4 w-4 mr-2 text-yellow-500"}),"Ø§Ù‚ØªØ±Ø§Ø­ Ù…Ø±Ø§Ø­Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ© (25%ØŒ 50%ØŒ 75%)"]}),P.length>0&&e.jsxs("div",{className:"space-y-2",children:[P.map(t=>e.jsxs("div",{className:`flex items-center justify-between rounded-lg border p-2 text-sm ${t.reached?"bg-green-50 border-green-200 dark:bg-green-900/20":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t.reached?e.jsx("span",{className:"text-green-600",children:"âœ“"}):e.jsx("span",{className:"text-muted-foreground",children:"â—‹"}),e.jsx("span",{children:t.title})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium text-xs",children:[t.targetAmount.toLocaleString("ar-EG")," ","Ø¬.Ù…"]}),e.jsx(F,{type:"button",variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>ue(t.id),children:e.jsx(Ze,{className:"h-3 w-3"})})]})]},t.id)),e.jsx(F,{type:"button",variant:"ghost",size:"sm",className:"w-full text-muted-foreground text-xs",onClick:()=>q([]),children:"Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ø£Ùˆ Ø£Ø¶Ù Ù…Ø±Ø­Ù„Ø© Ù…Ø®ØµØµØ©:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{placeholder:"Ø§Ø³Ù… Ø§Ù„Ù…Ø±Ø­Ù„Ø©",value:H,onChange:t=>_(t.target.value),className:"flex-1"}),e.jsx(ne,{type:"number",placeholder:"Ø§Ù„Ù…Ø¨Ù„Øº",value:X,onChange:t=>w(t.target.value),className:"w-24"}),e.jsx(F,{type:"button",variant:"outline",size:"icon",onClick:de,children:e.jsx(Te,{className:"h-4 w-4"})})]})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(F,{type:"submit",className:"flex-1",children:a?"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª":"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‡Ø¯Ù"}),e.jsx(F,{type:"button",variant:"outline",onClick:h,children:"Ø¥Ù„ØºØ§Ø¡"})]})]})]})})}function Us({budget:n,categories:h,formatCurrency:s,onSaveBudget:a}){const[g,i]=r.useState(!1),[j,m]=r.useState({}),p=()=>{const x={};h.forEach(v=>{const I=n?.categoryBudgets.find(S=>S.categoryId===v.id);x[v.id]=I?.planned.toString()||v.monthlyBudget?.toString()||"0"}),m(x),i(!0)},c=()=>{const x=h.map(v=>{const I=parseFloat(j[v.id])||0,E=n?.categoryBudgets.find(P=>P.categoryId===v.id)?.spent||0;return{categoryId:v.id,categoryName:v.name,planned:I,spent:E,remaining:I-E,percentage:I>0?E/I*100:0}});a(x),i(!1)},N=()=>{i(!1),m({})},f=n?.categoryBudgets.reduce((x,v)=>x+v.planned,0)||0,k=n?.categoryBudgets.reduce((x,v)=>x+v.spent,0)||0,o=f-k,u=f>0?k/f*100:0,d=x=>x<=50?"bg-green-500":x<=80?"bg-yellow-500":x<=100?"bg-orange-500":"bg-red-500",l=x=>x<=80?e.jsx(Ve,{className:"h-4 w-4 text-green-600"}):x<=100?e.jsx(Oe,{className:"h-4 w-4 text-orange-600"}):e.jsx(pe,{className:"h-4 w-4 text-red-600"});return e.jsxs(K,{children:[e.jsxs(re,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ce,{className:"flex items-center gap-2 text-base font-medium",children:[e.jsx(yt,{className:"h-5 w-5"}),"ØªØ®Ø·ÙŠØ· Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©"]}),g?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{size:"sm",onClick:c,children:[e.jsx(Ve,{className:"mr-1 h-4 w-4"}),"Ø­ÙØ¸"]}),e.jsx(F,{size:"sm",variant:"outline",onClick:N,children:"Ø¥Ù„ØºØ§Ø¡"})]}):e.jsxs(F,{size:"sm",variant:"outline",onClick:p,children:[e.jsx(Lt,{className:"mr-1 h-4 w-4"}),"ØªØ¹Ø¯ÙŠÙ„"]})]}),n&&!g&&e.jsxs("div",{className:"mt-3 rounded-lg bg-muted/50 p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©"}),e.jsx("span",{className:"font-medium",children:s(f)})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Ø§Ù„Ù…ØµØ±ÙˆÙ"}),e.jsx("span",{className:k>f?"text-red-600":"text-muted-foreground",children:s(k)})]}),e.jsx(Ut,{value:Math.min(100,u),className:"h-2"}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:o>=0?"text-green-600":"text-red-600",children:[o>=0?"Ù…ØªØ¨Ù‚ÙŠ":"ØªØ¬Ø§ÙˆØ²",":"," ",s(Math.abs(o))]}),e.jsxs("span",{className:"text-muted-foreground",children:[u.toFixed(0),"%"]})]})]})]}),e.jsxs(J,{className:"space-y-3",children:[g?e.jsxs("div",{className:"space-y-3",children:[h.map(x=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-[120px]",children:[e.jsx("span",{className:"h-3 w-3 rounded-full",style:{backgroundColor:x.color}}),e.jsxs("span",{className:"text-sm truncate",children:[x.icon," ",x.name]})]}),e.jsx(ne,{type:"number",min:"0",step:"100",value:j[x.id]||"0",onChange:v=>m({...j,[x.id]:v.target.value}),className:"w-28 text-left",placeholder:"0"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Ø¬.Ù…"})]},x.id)),e.jsxs("div",{className:"border-t pt-3 mt-4",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Ù‚ÙˆØ§Ù„Ø¨ Ø³Ø±ÙŠØ¹Ø©:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(F,{size:"sm",variant:"outline",onClick:()=>{const x={};h.forEach(v=>{x[v.id]=v.isEssential?"2000":"500"}),m(x)},children:"Ù‚Ø§Ø¹Ø¯Ø© 50/30/20"}),e.jsx(F,{size:"sm",variant:"outline",onClick:()=>{const x={};h.forEach(v=>{x[v.id]="1000"}),m(x)},children:"ØªÙˆØ²ÙŠØ¹ Ù…ØªØ³Ø§ÙˆÙŠ"})]})]})]}):n&&n.categoryBudgets.length>0?e.jsxs("div",{className:"space-y-3",children:[n.categoryBudgets.filter(x=>x.planned>0).map(x=>{const v=h.find(E=>E.id===x.categoryId),I=x.planned>0?x.spent/x.planned*100:0,S=I>100;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-3 w-3 rounded-full",style:{backgroundColor:v?.color}}),e.jsxs("span",{className:"truncate",children:[v?.icon," ",v?.name]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[l(I),e.jsxs("span",{className:S?"text-red-600 font-medium":"",children:[I.toFixed(0),"%"]})]})]}),e.jsxs("div",{className:"relative h-2 rounded-full bg-muted overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 left-0 h-full transition-all ${d(I)}`,style:{width:`${Math.min(100,I)}%`}}),S&&e.jsx("div",{className:"absolute top-0 h-full bg-red-500/50",style:{left:"100%",width:`${Math.min(50,I-100)}%`,transform:"translateX(-100%)"}})]}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:s(x.spent)}),e.jsx("span",{children:s(x.planned)})]})]},x.categoryId)}),n.categoryBudgets.filter(x=>x.planned>0).length===0&&e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx("p",{children:"Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ù„Ø£ÙŠ ÙØ¦Ø©"}),e.jsxs(F,{variant:"outline",size:"sm",className:"mt-2",onClick:p,children:[e.jsx(Te,{className:"mr-1 h-4 w-4"}),"Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©"]})]})]}):e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx(yt,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Ù„Ù… ÙŠØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±"}),e.jsx("p",{className:"text-xs mt-1",children:"Ø­Ø¯Ø¯ Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ù„ÙƒÙ„ ÙØ¦Ø© Ù„ØªØªØ¨Ø¹ Ø¥Ù†ÙØ§Ù‚Ùƒ"}),e.jsxs(F,{variant:"outline",size:"sm",className:"mt-3",onClick:p,children:[e.jsx(Te,{className:"mr-1 h-4 w-4"}),"Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©"]})]}),n&&!g&&k>0&&e.jsxs("div",{className:"border-t pt-3 mt-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"ðŸ’¡ Ù†ØµÙŠØ­Ø©:"}),u<50?e.jsx("p",{className:"text-xs text-green-600",children:"Ø£Ø¯Ø§Ø¡ Ù…Ù…ØªØ§Ø²! Ø£Ù†Øª ØªÙ†ÙÙ‚ Ø£Ù‚Ù„ Ù…Ù† Ù†ØµÙ Ù…ÙŠØ²Ø§Ù†ÙŠØªÙƒ ðŸ’š"}):u<80?e.jsx("p",{className:"text-xs text-yellow-600",children:"Ø£Ù†Øª ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ØµØ­ÙŠØ­ØŒ Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø¥Ù†ÙØ§Ù‚ ðŸ‘"}):u<100?e.jsx("p",{className:"text-xs text-orange-600",children:"Ø§Ù†ØªØ¨Ù‡! Ø§Ù‚ØªØ±Ø¨Øª Ù…Ù† Ø­Ø¯ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©ØŒ Ù‚Ù„Ù„ Ù…Ù† Ø§Ù„Ù†ÙÙ‚Ø§Øª ØºÙŠØ± Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ© âš ï¸"}):e.jsx("p",{className:"text-xs text-red-600",children:"ØªØ¬Ø§ÙˆØ²Øª Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©! Ø±Ø§Ø¬Ø¹ Ù†ÙÙ‚Ø§ØªÙƒ ÙˆØ­Ø§ÙˆÙ„ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø¥Ù†ÙØ§Ù‚ ðŸš¨"})]})]})]})}function Hs({incomes:n,expenses:h,categories:s,goals:a,budgets:g,formatCurrency:i}){const j=r.useMemo(()=>{const p=[],c=new Date,N=c.getMonth(),f=c.getFullYear(),k=N===0?11:N-1,o=N===0?f-1:f,u=h.filter(A=>{const y=new Date(A.date);return y.getMonth()===N&&y.getFullYear()===f}),d=h.filter(A=>{const y=new Date(A.date);return y.getMonth()===k&&y.getFullYear()===o}),l=u.reduce((A,y)=>A+y.amount,0),x=d.reduce((A,y)=>A+y.amount,0),I=n.filter(A=>{const y=new Date(A.actualDate||A.expectedDate||A.createdAt);return new Date(y).getMonth()===N&&new Date(y).getFullYear()===f}).reduce((A,y)=>A+y.amount,0);if(x>0){const A=(l-x)/x*100;A>15?p.push({id:"month-comparison-warning",type:"warning",icon:pe,title:"Ø²ÙŠØ§Ø¯Ø© ÙÙŠ Ø§Ù„ØµØ±Ù",message:`ØµØ±ÙØª ${Math.abs(A).toFixed(0)}% Ø£ÙƒØªØ± Ù…Ù† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù„ÙŠ ÙØ§Øª`,value:i(l-x),trend:"up"}):A<-10&&p.push({id:"month-comparison-positive",type:"positive",icon:Xe,title:"ØªØ­Ø³Ù† ÙÙŠ Ø§Ù„ØµØ±Ù! ðŸŽ‰",message:`ØµØ±ÙØª ${Math.abs(A).toFixed(0)}% Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù„ÙŠ ÙØ§Øª`,value:i(Math.abs(l-x)),trend:"down"})}if(I>0){const A=I-l,y=A/I*100;y>=20?p.push({id:"savings-excellent",type:"positive",icon:Ye,title:"Ù†Ø³Ø¨Ø© Ø§Ø¯Ø®Ø§Ø± Ù…Ù…ØªØ§Ø²Ø©! ðŸ’ª",message:`Ø¨ØªÙˆÙØ± ${y.toFixed(0)}% Ù…Ù† Ø¯Ø®Ù„Ùƒ - Ø£Ø¯Ø§Ø¡ Ø±Ø§Ø¦Ø¹!`,value:i(A),trend:"up"}):y>=10?p.push({id:"savings-good",type:"info",icon:Ye,title:"Ù†Ø³Ø¨Ø© Ø§Ø¯Ø®Ø§Ø± Ø¬ÙŠØ¯Ø©",message:`Ø¨ØªÙˆÙØ± ${y.toFixed(0)}% Ù…Ù† Ø¯Ø®Ù„Ùƒ`,value:i(A),trend:"neutral"}):y<5&&y>=0&&p.push({id:"savings-low",type:"warning",icon:Oe,title:"Ù†Ø³Ø¨Ø© Ø§Ø¯Ø®Ø§Ø± Ù…Ù†Ø®ÙØ¶Ø©",message:`Ø¨ØªÙˆÙØ± ${y.toFixed(0)}% ÙÙ‚Ø· - Ø­Ø§ÙˆÙ„ ØªØ²ÙˆØ¯ Ø§Ù„Ø§Ø¯Ø®Ø§Ø±`,trend:"down"})}const S={};u.forEach(A=>{S[A.categoryId]=(S[A.categoryId]||0)+A.amount});const E=Object.entries(S).sort(([,A],[,y])=>y-A)[0];if(E&&l>0){const[A,y]=E,R=s.find(ie=>ie.id===A),W=y/l*100;W>40&&p.push({id:"top-category",type:"info",icon:Ie,title:`Ø£ÙƒØªØ± ÙØ¦Ø© ØµØ±Ù: ${R?.name||"Ø£Ø®Ø±Ù‰"}`,message:`${W.toFixed(0)}% Ù…Ù† ØµØ±ÙÙƒ Ø±Ø§Ø­ Ù„Ù€ ${R?.name||"Ù‡Ø°Ù‡ Ø§Ù„ÙØ¦Ø©"}`,value:i(y)})}const P={};u.forEach(A=>{const y=new Date(A.date).getDay();P[y]=(P[y]||0)+A.amount});const q=Object.entries(P).sort(([,A],[,y])=>y-A)[0];if(q){const A=["Ø§Ù„Ø£Ø­Ø¯","Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†","Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡","Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø§Ù„Ø®Ù…ÙŠØ³","Ø§Ù„Ø¬Ù…Ø¹Ø©","Ø§Ù„Ø³Ø¨Øª"],[y,R]=q;p.push({id:"day-pattern",type:"info",icon:Ue,title:`ÙŠÙˆÙ… Ø§Ù„ØµØ±Ù Ø§Ù„Ø£Ø¹Ù„Ù‰: ${A[parseInt(y)]}`,message:`Ø¨ØªØµØ±Ù Ø£ÙƒØªØ± ÙŠÙˆÙ… ${A[parseInt(y)]}`,value:i(R)})}const H=g.find(A=>{const[y,R]=A.month.split("-").map(Number);return y===f&&R-1===N});if(H){const A=H.categoryBudgets.filter(y=>y.spent>y.planned&&y.planned>0);if(A.length>0){const y=A[0],R=s.find(ie=>ie.id===y.categoryId),W=(y.spent-y.planned)/y.planned*100;p.push({id:`budget-over-${y.categoryId}`,type:"warning",icon:Oe,title:`ØªØ¬Ø§ÙˆØ²Øª Ù…ÙŠØ²Ø§Ù†ÙŠØ© ${R?.name||"Ø§Ù„ÙØ¦Ø©"}`,message:`ØªØ¬Ø§ÙˆØ²Øª Ø¨Ù†Ø³Ø¨Ø© ${W.toFixed(0)}% - Ø­Ø§ÙˆÙ„ ØªÙ‚Ù„Ù„ Ø§Ù„ØµØ±Ù`,value:i(y.spent-y.planned),trend:"up"})}else H.categoryBudgets.length>0&&H.categoryBudgets.every(R=>R.spent<=R.planned||R.planned===0)&&p.push({id:"budget-on-track",type:"positive",icon:_e,title:"Ù…Ù„ØªØ²Ù… Ø¨Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©! ðŸ’š",message:"Ø£Ù†Øª Ù…Ø§Ø´ÙŠ ØµØ­ - Ø§Ø³ØªÙ…Ø±!"})}a.filter(A=>A.status==="active").forEach(A=>{const y=A.targetAmount>0?A.currentAmount/A.targetAmount*100:0;y>=90&&y<100?p.push({id:`goal-almost-${A.id}`,type:"positive",icon:Ie,title:`Ù‚Ø±Ø¨Øª ØªØ­Ù‚Ù‚ Ù‡Ø¯Ù "${A.title}"! ðŸŽ¯`,message:`Ø¨Ø§Ù‚ÙŠ ${i(A.targetAmount-A.currentAmount)} ÙÙ‚Ø·`,value:`${y.toFixed(0)}%`,trend:"up"}):y>=50&&y<90&&p.push({id:`goal-halfway-${A.id}`,type:"info",icon:Ie,title:`ØªÙ‚Ø¯Ù… Ø¬ÙŠØ¯ ÙÙŠ "${A.title}"`,message:`ÙˆØµÙ„Øª Ù„Ù€ ${y.toFixed(0)}% Ù…Ù† Ø§Ù„Ù‡Ø¯Ù`,value:i(A.currentAmount)})});const X=s.filter(A=>!A.isEssential),w=u.filter(A=>X.some(y=>y.id===A.categoryId)).reduce((A,y)=>A+y.amount,0);if(w>l*.3){const A=w*.2;p.push({id:"saving-opportunity",type:"suggestion",icon:cs,title:"ÙØ±ØµØ© ØªÙˆÙÙŠØ±! ðŸ’¡",message:`Ù„Ùˆ Ù‚Ù„Ù„Øª Ø§Ù„ØµØ±Ù ØºÙŠØ± Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠ 20% Ù‡ØªÙˆÙØ± ${i(A)}`,value:i(A)})}return p.slice(0,6)},[n,h,s,a,g,i]),m=p=>{switch(p){case"positive":return{bg:"bg-green-500/10 border-green-500/20",iconBg:"bg-green-500/20",iconColor:"text-green-600"};case"warning":return{bg:"bg-orange-500/10 border-orange-500/20",iconBg:"bg-orange-500/20",iconColor:"text-orange-600"};case"suggestion":return{bg:"bg-purple-500/10 border-purple-500/20",iconBg:"bg-purple-500/20",iconColor:"text-purple-600"};default:return{bg:"bg-blue-500/10 border-blue-500/20",iconBg:"bg-blue-500/20",iconColor:"text-blue-600"}}};return j.length===0?e.jsxs(K,{children:[e.jsx(re,{children:e.jsxs(ce,{className:"flex items-center gap-2 text-lg",children:[e.jsx(_e,{className:"h-5 w-5"}),"Ø±Ø¤Ù‰ Ù…Ø§Ù„ÙŠØ©"]})}),e.jsx(J,{children:e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Ø£Ø¶Ù Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù„Ø±Ø¤ÙŠØ© Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª ÙˆØ§Ù„Ù†ØµØ§Ø¦Ø­ ðŸ“Š"})})]}):e.jsxs(K,{children:[e.jsx(re,{children:e.jsxs(ce,{className:"flex items-center gap-2 text-lg",children:[e.jsx(_e,{className:"h-5 w-5"}),"Ø±Ø¤Ù‰ Ù…Ø§Ù„ÙŠØ© Ø°ÙƒÙŠØ©"]})}),e.jsx(J,{className:"space-y-3",children:j.map(p=>{const c=m(p.type),N=p.icon;return e.jsxs("div",{className:$("flex items-start gap-3 p-3 rounded-lg border transition-all",c.bg),children:[e.jsx("div",{className:$("p-2 rounded-lg shrink-0",c.iconBg),children:e.jsx(N,{className:$("h-4 w-4",c.iconColor)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-medium",children:p.title}),p.trend&&(p.trend==="up"?e.jsx(Fe,{className:"h-4 w-4 text-red-500"}):p.trend==="down"?e.jsx(rt,{className:"h-4 w-4 text-green-500"}):null)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:p.message})]}),p.value&&e.jsx("div",{className:"text-sm font-semibold shrink-0",children:p.value})]},p.id)})})]})}function Ks({incomes:n,expenses:h,formatCurrency:s,monthsToForecast:a=3}){const g=r.useMemo(()=>{const j=new Date,m=[],p={};n.forEach(v=>{const I=new Date(v.actualDate||v.expectedDate||v.createdAt),S=`${I.getFullYear()}-${String(I.getMonth()+1).padStart(2,"0")}`;p[S]||(p[S]={income:0,expenses:0}),p[S].income+=v.amount}),h.forEach(v=>{const I=new Date(v.date),S=`${I.getFullYear()}-${String(I.getMonth()+1).padStart(2,"0")}`;p[S]||(p[S]={income:0,expenses:0}),p[S].expenses+=v.amount});const c=Object.keys(p).sort().slice(-6);let N=0,f=0,k=0;c.forEach(v=>{N+=p[v].income,f+=p[v].expenses,k++});const o=k>0?N/k:0,u=k>0?f/k:0;let d=0;if(c.length>=2){const v=c.slice(-3),I=c.slice(0,3),S=v.reduce((P,q)=>P+p[q].expenses,0)/v.length,E=I.reduce((P,q)=>P+p[q].expenses,0)/I.length;E>0&&(d=(S-E)/E)}let l=0;const x=["ÙŠÙ†Ø§ÙŠØ±","ÙØ¨Ø±Ø§ÙŠØ±","Ù…Ø§Ø±Ø³","Ø£Ø¨Ø±ÙŠÙ„","Ù…Ø§ÙŠÙˆ","ÙŠÙˆÙ†ÙŠÙˆ","ÙŠÙˆÙ„ÙŠÙˆ","Ø£ØºØ³Ø·Ø³","Ø³Ø¨ØªÙ…Ø¨Ø±","Ø£ÙƒØªÙˆØ¨Ø±","Ù†ÙˆÙÙ…Ø¨Ø±","Ø¯ÙŠØ³Ù…Ø¨Ø±"];c.slice(-4).forEach(v=>{const[I,S]=v.split("-").map(Number),E=p[v],P=E.income-E.expenses;l+=P,m.push({month:`${x[S-1]} ${I.toString().slice(-2)}`,income:E.income,expenses:E.expenses,net:P,cumulative:l,isForecast:!1})});for(let v=1;v<=a;v++){const I=new Date(j.getFullYear(),j.getMonth()+v,1),S=x[I.getMonth()],E=I.getFullYear().toString().slice(-2),P=1+d*.5*v,q=Math.max(0,u*Math.min(1.5,Math.max(.5,P))),H=o,_=H-q;l+=_,m.push({month:`${S} ${E}*`,income:Math.round(H),expenses:Math.round(q),net:Math.round(_),cumulative:Math.round(l),isForecast:!0})}return m},[n,h,a]),i=r.useMemo(()=>{const j=g.filter(f=>f.isForecast),m=j.reduce((f,k)=>f+k.net,0),p=j.length>0?m/j.length:0,c=g.filter(f=>!f.isForecast).slice(-1)[0],N=j.slice(-1)[0];return{totalForecastNet:m,avgMonthlyNet:p,trend:p>=0?"positive":"negative",startCumulative:c?.cumulative||0,endCumulative:N?.cumulative||0}},[g]);return g.length===0?e.jsxs(K,{children:[e.jsx(re,{children:e.jsxs(ce,{className:"flex items-center gap-2 text-lg",children:[e.jsx(pe,{className:"h-5 w-5"}),"ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„ØªØ¯ÙÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠ"]})}),e.jsx(J,{children:e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Ø£Ø¶Ù Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù„Ø±Ø¤ÙŠØ© Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© ðŸ“ˆ"})})]}):e.jsxs(K,{children:[e.jsx(re,{children:e.jsxs(ce,{className:"flex items-center gap-2 text-lg",children:[e.jsx(pe,{className:"h-5 w-5"}),"ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„ØªØ¯ÙÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠ"]})}),e.jsxs(J,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:$("p-3 rounded-lg border",i.trend==="positive"?"bg-green-500/10 border-green-500/20":"bg-red-500/10 border-red-500/20"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[i.trend==="positive"?e.jsx(et,{className:"h-4 w-4 text-green-600"}):e.jsx(Oe,{className:"h-4 w-4 text-red-600"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Ø§Ù„ØªÙˆÙ‚Ø¹ Ù„Ù„Ù€ ",a," Ø´Ù‡ÙˆØ±"]})]}),e.jsxs("p",{className:$("text-lg font-bold mt-1",i.trend==="positive"?"text-green-600":"text-red-600"),children:[i.totalForecastNet>=0?"+":"",s(i.totalForecastNet)]})]}),e.jsxs("div",{className:"p-3 rounded-lg border bg-muted/30",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[i.avgMonthlyNet>=0?e.jsx(pe,{className:"h-4 w-4 text-green-600"}):e.jsx(Xe,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Ø§Ù„Ù…ØªÙˆØ³Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠ"})]}),e.jsxs("p",{className:$("text-lg font-bold mt-1",i.avgMonthlyNet>=0?"text-green-600":"text-red-600"),children:[i.avgMonthlyNet>=0?"+":"",s(i.avgMonthlyNet)]})]})]}),e.jsx("div",{className:"h-[200px] w-full",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Ds,{data:g,margin:{top:10,right:10,left:-20,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorIncome",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#22c55e",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#22c55e",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorExpenses",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#ef4444",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#ef4444",stopOpacity:0})]})]}),e.jsx(zt,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(qt,{dataKey:"month",fontSize:10,tickLine:!1,axisLine:!1,className:"fill-muted-foreground"}),e.jsx(Wt,{fontSize:10,tickLine:!1,axisLine:!1,tickFormatter:j=>`${(j/1e3).toFixed(0)}k`,className:"fill-muted-foreground"}),e.jsx(ft,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px",direction:"rtl"},formatter:(j,m)=>{const p={income:"Ø§Ù„Ø¯Ø®Ù„",expenses:"Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª",net:"Ø§Ù„ØµØ§ÙÙŠ"};return[s(j),p[m]||m]}}),e.jsx(As,{y:0,stroke:"hsl(var(--muted-foreground))",strokeDasharray:"3 3"}),e.jsx(wt,{type:"monotone",dataKey:"income",stroke:"#22c55e",fill:"url(#colorIncome)",strokeWidth:2,dot:!1}),e.jsx(wt,{type:"monotone",dataKey:"expenses",stroke:"#ef4444",fill:"url(#colorExpenses)",strokeWidth:2,dot:!1})]})})}),e.jsxs("div",{className:"flex items-center justify-center gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"h-3 w-3 rounded-full bg-green-500"}),e.jsx("span",{className:"text-muted-foreground",children:"Ø§Ù„Ø¯Ø®Ù„"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"h-3 w-3 rounded-full bg-red-500"}),e.jsx("span",{className:"text-muted-foreground",children:"Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª"})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{className:"text-muted-foreground",children:"* ØªÙˆÙ‚Ø¹Ø§Øª"})})]})]})]})}function Js({incomes:n,expenses:h,categories:s,formatCurrency:a}){const[g,i]=r.useState("daily"),j=(c,N,f,k)=>{const o=c.reduce((S,E)=>S+E.amount,0),u=N.reduce((S,E)=>S+E.amount,0),d=f.reduce((S,E)=>S+E.amount,0),l=k.reduce((S,E)=>S+E.amount,0),x={};c.forEach(S=>{x[S.categoryId]=(x[S.categoryId]||0)+S.amount});const v=Object.entries(x).sort(([,S],[,E])=>E-S)[0];let I=null;if(v){const S=s.find(E=>E.id===v[0]);I={name:S?.name||"Ø£Ø®Ø±Ù‰",amount:v[1],icon:S?.icon||"ðŸ“¦"}}return{income:u,expenses:o,net:u-o,topCategory:I,transactionCount:c.length+N.length,comparison:{expenses:d>0?(o-d)/d*100:0,income:l>0?(u-l)/l*100:0}}},m=r.useMemo(()=>{const c=new Date,N=new Date(c.getFullYear(),c.getMonth(),c.getDate()),f=new Date(N.getTime()-1440*60*1e3),k=c.getDay(),o=new Date(N.getTime()-k*24*60*60*1e3),u=new Date(o.getTime()-10080*60*1e3),d=new Date(c.getFullYear(),c.getMonth(),1),l=new Date(c.getFullYear(),c.getMonth()-1,1),x=new Date(c.getFullYear(),c.getMonth(),0),v=new Date(c.getFullYear(),0,1),I=new Date(c.getFullYear()-1,0,1),S=new Date(c.getFullYear()-1,11,31),E=(ee,Z,b)=>ee.filter(C=>{const t=new Date("date"in C?C.date:C.actualDate||C.expectedDate||C.createdAt);return t>=Z&&t<=b}),P=h.filter(ee=>{const Z=new Date(ee.date);return Z>=N&&Z<new Date(N.getTime()+1440*60*1e3)}),q=n.filter(ee=>{const Z=new Date(ee.actualDate||ee.expectedDate||ee.createdAt);return Z>=N&&Z<new Date(N.getTime()+1440*60*1e3)}),H=h.filter(ee=>{const Z=new Date(ee.date);return Z>=f&&Z<N}),_=n.filter(ee=>{const Z=new Date(ee.actualDate||ee.expectedDate||ee.createdAt);return Z>=f&&Z<N}),X=E(h,o,c),w=E(n,o,c),A=E(h,u,o),y=E(n,u,o),R=E(h,d,c),W=E(n,d,c),ie=E(h,l,x),xe=E(n,l,x),ye=E(h,v,c),de=E(n,v,c),ue=E(h,I,S),be=E(n,I,S);return{daily:j(P,q,H,_),weekly:j(X,w,A,y),monthly:j(R,W,ie,xe),yearly:j(ye,de,ue,be)}},[n,h,s]),p=(c,N,f)=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-green-500/10 border border-green-500/20",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ø§Ù„Ø¯Ø®Ù„"}),e.jsx("p",{className:"text-lg font-bold text-green-600",children:a(c.income)}),c.comparison.income!==0&&e.jsxs("div",{className:$("flex items-center gap-1 text-xs mt-1",c.comparison.income>0?"text-green-600":"text-red-600"),children:[c.comparison.income>0?e.jsx(Fe,{className:"h-3 w-3"}):e.jsx(rt,{className:"h-3 w-3"}),e.jsxs("span",{children:[Math.abs(c.comparison.income).toFixed(0),"%"]})]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-red-500/10 border border-red-500/20",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª"}),e.jsx("p",{className:"text-lg font-bold text-red-600",children:a(c.expenses)}),c.comparison.expenses!==0&&e.jsxs("div",{className:$("flex items-center gap-1 text-xs mt-1",c.comparison.expenses<0?"text-green-600":"text-red-600"),children:[c.comparison.expenses>0?e.jsx(Fe,{className:"h-3 w-3"}):e.jsx(rt,{className:"h-3 w-3"}),e.jsxs("span",{children:[Math.abs(c.comparison.expenses).toFixed(0),"%"]})]})]}),e.jsxs("div",{className:$("p-3 rounded-lg border",c.net>=0?"bg-blue-500/10 border-blue-500/20":"bg-orange-500/10 border-orange-500/20"),children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ø§Ù„ØµØ§ÙÙŠ"}),e.jsxs("p",{className:$("text-lg font-bold",c.net>=0?"text-blue-600":"text-orange-600"),children:[c.net>=0?"+":"",a(c.net)]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.topCategory&&e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30 border",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ø£ÙƒØªØ± ÙØ¦Ø© ØµØ±Ù"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-lg",children:c.topCategory.icon}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:c.topCategory.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a(c.topCategory.amount)})]})]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30 border",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª"}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:c.transactionCount}),e.jsx("p",{className:"text-xs text-muted-foreground",children:N})]})]}),(c.comparison.expenses!==0||c.comparison.income!==0)&&e.jsx("div",{className:"p-2 rounded-lg bg-muted/20 text-center",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:c.comparison.expenses<0?e.jsxs("span",{className:"text-green-600",children:["ØµØ±ÙØª Ø£Ù‚Ù„ Ù…Ù† ",f," Ø¨Ù†Ø³Ø¨Ø©"," ",Math.abs(c.comparison.expenses).toFixed(0),"% ðŸŽ‰"]}):c.comparison.expenses>0?e.jsxs("span",{className:"text-orange-600",children:["ØµØ±ÙØª Ø£ÙƒØªØ± Ù…Ù† ",f," Ø¨Ù†Ø³Ø¨Ø©"," ",Math.abs(c.comparison.expenses).toFixed(0),"%"]}):e.jsxs("span",{className:"flex items-center justify-center gap-1",children:[e.jsx(is,{className:"h-3 w-3"}),"Ù†ÙØ³ Ù…Ø¹Ø¯Ù„ Ø§Ù„ØµØ±Ù"]})})})]});return e.jsxs(K,{children:[e.jsx(re,{children:e.jsxs(ce,{className:"flex items-center gap-2 text-lg",children:[e.jsx(Yt,{className:"h-5 w-5"}),"Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±"]})}),e.jsx(J,{children:e.jsxs(Ot,{value:g,onValueChange:i,children:[e.jsxs(Rt,{className:"grid w-full grid-cols-4 mb-4",children:[e.jsxs(we,{value:"daily",className:"text-xs",children:[e.jsx(Ue,{className:"h-3 w-3 ml-1"}),"ÙŠÙˆÙ…ÙŠ"]}),e.jsx(we,{value:"weekly",className:"text-xs",children:"Ø£Ø³Ø¨ÙˆØ¹ÙŠ"}),e.jsx(we,{value:"monthly",className:"text-xs",children:"Ø´Ù‡Ø±ÙŠ"}),e.jsx(we,{value:"yearly",className:"text-xs",children:"Ø³Ù†ÙˆÙŠ"})]}),e.jsx(Ce,{value:"daily",children:p(m.daily,"Ø§Ù„ÙŠÙˆÙ…","Ø£Ù…Ø³")}),e.jsx(Ce,{value:"weekly",children:p(m.weekly,"Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹","Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ù…Ø§Ø¶ÙŠ")}),e.jsx(Ce,{value:"monthly",children:p(m.monthly,"Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±","Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø§Ø¶ÙŠ")}),e.jsx(Ce,{value:"yearly",children:p(m.yearly,"Ù‡Ø°Ù‡ Ø§Ù„Ø³Ù†Ø©","Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…Ø§Ø¶ÙŠØ©")})]})})]})}function _s({expenses:n,budgets:h,goals:s}){const a=r.useMemo(()=>{const g=new Date,i=new Date(g.getFullYear(),g.getMonth(),g.getDate()),j=[];let m=0;const p=[...h].sort((x,v)=>v.month.localeCompare(x.month));for(const x of p)if(x.totalActualExpenses<=x.totalPlannedExpenses)m++;else break;m>0&&j.push({type:"budget",days:m,icon:os,title:`${m} Ø´Ù‡Ø± Ù…Ù„ØªØ²Ù… Ø¨Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©`,color:"text-orange-500"});const c=new Map;n.forEach(x=>{const v=new Date(x.date).toISOString().split("T")[0];c.set(v,(c.get(v)||0)+x.amount)});let N=0;for(let x=0;x<30;x++){const I=new Date(i.getTime()-x*24*60*60*1e3).toISOString().split("T")[0];if((c.get(I)||0)===0)N++;else break}N>=1&&j.push({type:"saving",days:N,icon:ds,title:`${N} ÙŠÙˆÙ… Ø¨Ø¯ÙˆÙ† ØµØ±Ù`,color:"text-yellow-500"});const f=s.filter(x=>x.status==="active"),k=f.filter(x=>x.currentAmount>0);k.length>0&&j.push({type:"goal",days:k.length,icon:Ie,title:`${k.length} Ø£Ù‡Ø¯Ø§Ù Ù†Ø´Ø·Ø©`,color:"text-blue-500"});const o=[];n.length>=1&&o.push({id:"first-expense",icon:ms,title:"Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©",description:"Ø³Ø¬Ù„Øª Ø£ÙˆÙ„ Ù†ÙÙ‚Ø©",color:"bg-yellow-500",earned:!0}),o.push({id:"ten-expenses",icon:xs,title:"Ù…Ù†Ø¸Ù…",description:"Ø³Ø¬Ù„ 10 Ù†ÙÙ‚Ø§Øª",color:"bg-blue-500",earned:n.length>=10,progress:Math.min(100,n.length/10*100)}),o.push({id:"fifty-expenses",icon:Le,title:"Ø®Ø¨ÙŠØ± Ø§Ù„ØªØªØ¨Ø¹",description:"Ø³Ø¬Ù„ 50 Ù†ÙÙ‚Ø©",color:"bg-purple-500",earned:n.length>=50,progress:Math.min(100,n.length/50*100)});const u=s.filter(x=>x.status==="completed");o.push({id:"first-goal",icon:us,title:"Ù…Ø­Ù‚Ù‚ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù",description:"Ø£ÙƒÙ…Ù„ Ù‡Ø¯Ù Ù…Ø§Ù„ÙŠ",color:"bg-red-500",earned:u.length>=1,progress:f.length>0?Math.max(...f.map(x=>x.currentAmount/x.targetAmount*100)):0});const d=h.filter(x=>x.totalActualExpenses<=x.totalPlannedExpenses);o.push({id:"budget-master",icon:_e,title:"Ø³ÙŠØ¯ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©",description:"Ø§Ù„ØªØ²Ù… Ø¨Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø´Ù‡Ø± ÙƒØ§Ù…Ù„",color:"bg-green-500",earned:d.length>=1,progress:h.length>0?d.length/h.length*100:0});const l=[];return m>=3&&l.push("ðŸ”¥ Ø£Ø¯Ø§Ø¡ Ù…Ø°Ù‡Ù„! Ø§Ø³ØªÙ…Ø± Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¹Ø¯Ù„"),N>=3&&l.push("ðŸ’ª Ø¥Ø±Ø§Ø¯Ø© Ù‚ÙˆÙŠØ©! ÙƒÙ„ ÙŠÙˆÙ… Ø¨Ø¯ÙˆÙ† ØµØ±Ù ØºÙŠØ± Ø¶Ø±ÙˆØ±ÙŠ Ù‡Ùˆ Ø§Ù†ØªØµØ§Ø±"),u.length>0&&l.push(`ðŸ† Ø­Ù‚Ù‚Øª ${u.length} Ø£Ù‡Ø¯Ø§Ù! Ø£Ù†Øª Ù…Ù„Ù‡Ù…`),f.some(x=>x.currentAmount/x.targetAmount>=.9)&&l.push("ðŸŽ¯ Ù‚Ø±Ø¨Øª ØªØ­Ù‚Ù‚ Ù‡Ø¯ÙÙƒ! Ø´ÙˆÙŠØ© ÙƒÙ…Ø§Ù†"),l.length===0&&(n.length===0?l.push("ðŸš€ Ø§Ø¨Ø¯Ø£ Ø¨ØªØ³Ø¬ÙŠÙ„ Ø£ÙˆÙ„ Ù†ÙÙ‚Ø© Ø¹Ø´Ø§Ù† ØªØªØ§Ø¨Ø¹ ØµØ±ÙÙƒ"):s.length===0?l.push("ðŸ’¡ Ø­Ø¯Ø¯ Ù‡Ø¯Ù Ù…Ø§Ù„ÙŠ Ø¹Ø´Ø§Ù† ÙŠÙƒÙˆÙ† Ø¹Ù†Ø¯Ùƒ Ø¯Ø§ÙØ¹ Ù„Ù„ØªÙˆÙÙŠØ±"):l.push("ðŸ“Š Ø§Ø³ØªÙ…Ø± ÙÙŠ ØªØªØ¨Ø¹ Ù†ÙÙ‚Ø§ØªÙƒ Ø¹Ø´Ø§Ù† ØªÙÙ‡Ù… Ø¹Ø§Ø¯Ø§ØªÙƒ Ø§Ù„Ù…Ø§Ù„ÙŠØ©")),{streaks:j,achievements:o,motivationalMessage:l[Math.floor(Math.random()*l.length)]}},[n,h,s]);return a.streaks.length===0&&a.achievements.filter(g=>g.earned).length===0?null:e.jsxs(K,{children:[e.jsx(re,{children:e.jsxs(ce,{className:"flex items-center gap-2 text-lg",children:[e.jsx(Le,{className:"h-5 w-5"}),"Ø¥Ù†Ø¬Ø§Ø²Ø§ØªÙƒ"]})}),e.jsxs(J,{className:"space-y-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-gradient-to-r from-purple-500/10 to-blue-500/10 border border-purple-500/20",children:e.jsx("p",{className:"text-sm text-center",children:a.motivationalMessage})}),a.streaks.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground font-medium",children:"Ø§Ù„Ø³Ù„Ø§Ø³Ù„ Ø§Ù„Ù†Ø´Ø·Ø©"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.streaks.map((g,i)=>{const j=g.icon;return e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-full bg-muted/50 border",children:[e.jsx(j,{className:$("h-4 w-4",g.color)}),e.jsx("span",{className:"text-sm font-medium",children:g.title})]},i)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground font-medium",children:"Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:a.achievements.slice(0,4).map(g=>{const i=g.icon;return e.jsxs("div",{className:$("p-3 rounded-lg border transition-all",g.earned?"bg-muted/30":"bg-muted/10 opacity-50"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:$("p-2 rounded-full",g.earned?g.color:"bg-muted"),children:e.jsx(i,{className:$("h-4 w-4",g.earned?"text-white":"text-muted-foreground")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:g.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:g.description})]})]}),!g.earned&&g.progress!==void 0&&e.jsx(Ut,{value:g.progress,className:"h-1 mt-2"})]},g.id)})})]})]})]})}const kt=["#22c55e","#3b82f6","#f59e0b","#ec4899","#8b5cf6","#14b8a6","#f43f5e","#eab308"],Qs=({isActive:n,duration:h=3e3,particleCount:s=100,onComplete:a})=>{const[g,i]=r.useState([]),[j,m]=r.useState(!1),p=r.useCallback(()=>{const c=[];for(let N=0;N<s;N++)c.push({id:N,x:Math.random()*100,y:-10-Math.random()*20,color:kt[Math.floor(Math.random()*kt.length)],rotation:Math.random()*360,scale:.5+Math.random()*.5,speedX:(Math.random()-.5)*4,speedY:2+Math.random()*4,rotationSpeed:(Math.random()-.5)*10});return c},[s]);return r.useEffect(()=>{if(n){i(p()),m(!0);const c=setTimeout(()=>{m(!1),i([]),a?.()},h);return()=>clearTimeout(c)}},[n,h,p,a]),!j||g.length===0?null:e.jsxs("div",{className:"fixed inset-0 pointer-events-none z-[9999] overflow-hidden",children:[g.map(c=>e.jsx("div",{className:"absolute animate-confetti-fall",style:{left:`${c.x}%`,top:`${c.y}%`,transform:`rotate(${c.rotation}deg) scale(${c.scale})`,animation:`confetti-fall ${1.5+Math.random()}s ease-out forwards`,animationDelay:`${Math.random()*.5}s`},children:e.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:c.color}})},c.id)),e.jsx("style",{children:`
        @keyframes confetti-fall {
          0% {
            transform: translateY(0) rotate(0deg) scale(var(--scale, 1));
            opacity: 1;
          }
          100% {
            transform: translateY(100vh) rotate(720deg) scale(var(--scale, 1));
            opacity: 0;
          }
        }
      `})]})},Xs=({message:n,subMessage:h,emoji:s="ðŸŽ‰",isVisible:a,onClose:g})=>(r.useEffect(()=>{if(a&&g){const i=setTimeout(g,4e3);return()=>clearTimeout(i)}},[a,g]),a?e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-[9998] pointer-events-none",children:[e.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-2xl \r
                   animate-bounce-in border-2 border-green-500/20\r
                   text-center max-w-sm mx-4`,children:[e.jsx("div",{className:"text-6xl mb-4 animate-pulse",children:s}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:n}),h&&e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:h})]}),e.jsx("style",{children:`
        @keyframes bounce-in {
          0% {
            transform: scale(0);
            opacity: 0;
          }
          50% {
            transform: scale(1.1);
          }
          100% {
            transform: scale(1);
            opacity: 1;
          }
        }
        .animate-bounce-in {
          animation: bounce-in 0.5s ease-out forwards;
        }
      `})]}):null),Zs=()=>{const[n,h]=r.useState(!1),[s,a]=r.useState(null),g=r.useCallback((j,m,p)=>{h(!0),a({message:j,subMessage:m,emoji:p})},[]),i=r.useCallback(()=>{h(!1),a(null)},[]);return{showConfetti:n,celebrationMessage:s,celebrate:g,endCelebration:i,setShowConfetti:h,setCelebrationMessage:a}},ea=[{value:"EGP",label:"Egyptian Pound",symbol:"Ø¬.Ù…"},{value:"USD",label:"US Dollar",symbol:"$"},{value:"EUR",label:"Euro",symbol:"â‚¬"},{value:"GBP",label:"British Pound",symbol:"Â£"},{value:"SAR",label:"Saudi Riyal",symbol:"Ø±.Ø³"},{value:"AED",label:"UAE Dirham",symbol:"Ø¯.Ø¥"},{value:"KWD",label:"Kuwaiti Dinar",symbol:"Ø¯.Ùƒ"}],ta=["#3b82f6","#22c55e","#ef4444","#f59e0b","#8b5cf6","#ec4899","#06b6d4","#f97316","#14b8a6","#6366f1","#dc2626","#64748b","#10b981","#d946ef","#0ea5e9"],sa=["ðŸ ","âš¡","ðŸš—","ðŸ›’","ðŸ’Š","ðŸ›¡ï¸","ðŸ”","ðŸŽ®","ðŸ›ï¸","ðŸ‘”","ðŸ“š","ðŸŽ","âš½","âœˆï¸","ðŸ“±","ðŸ’‡","ðŸš¨","ðŸ“¦","ðŸ’°","ðŸŽµ","ðŸŽ¬","â˜•","ðŸ•","ðŸ‹ï¸","ðŸšŒ","ðŸ’»","ðŸŽ¨","ðŸŒ","ðŸ”§","ðŸ¥"],aa=({settings:n,categories:h,onUpdateSettings:s,onAddCategory:a,onUpdateCategory:g,onDeleteCategory:i})=>{const[j,m]=r.useState(!1),[p,c]=r.useState(null),[N,f]=r.useState({name:"",nameAr:"",icon:"ðŸ“¦",color:"#3b82f6",isEssential:!1}),k=()=>{N.name.trim()&&(p?g(p.id,{name:N.name,nameAr:N.nameAr,icon:N.icon,color:N.color,isEssential:N.isEssential}):a({name:N.name,nameAr:N.nameAr,icon:N.icon,color:N.color,isEssential:N.isEssential,isDefault:!1,order:h.length+1}),m(!1),c(null),f({name:"",nameAr:"",icon:"ðŸ“¦",color:"#3b82f6",isEssential:!1}))},o=l=>{c(l),f({name:l.name,nameAr:l.nameAr||"",icon:l.icon,color:l.color,isEssential:l.isEssential}),m(!0)},u=h.filter(l=>!l.isDefault),d=h.filter(l=>l.isDefault);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(K,{className:"animate-fade-in-up",children:[e.jsxs(re,{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[e.jsx(hs,{className:"h-5 w-5"}),"Currency Settings"]}),e.jsx(Be,{children:"Configure your default currency and display options"})]}),e.jsx(J,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Default Currency"}),e.jsxs(Se,{value:n.defaultCurrency,onValueChange:l=>s({defaultCurrency:l}),children:[e.jsx(De,{children:e.jsx(Ae,{})}),e.jsx(ke,{children:ea.map(l=>e.jsxs(ae,{value:l.value,children:[l.symbol," ",l.label]},l.value))})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(L,{children:"Show Cents"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Display decimal places in amounts"})]}),e.jsx($e,{checked:n.showCents,onCheckedChange:l=>s({showCents:l})})]})]})})]}),e.jsxs(K,{className:"animate-fade-in-up",children:[e.jsxs(re,{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-5 w-5"}),"Date Settings"]}),e.jsx(Be,{children:"Configure when your financial month starts"})]}),e.jsx(J,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Month Start Day"}),e.jsxs(Se,{value:String(n.monthStartDay),onValueChange:l=>s({monthStartDay:parseInt(l)}),children:[e.jsx(De,{className:"w-full sm:w-48",children:e.jsx(Ae,{})}),e.jsx(ke,{children:Array.from({length:28},(l,x)=>x+1).map(l=>e.jsxs(ae,{value:String(l),children:["Day ",l," of each month"]},l))})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Set this to your salary day for more accurate monthly tracking"})]})})]}),e.jsxs(K,{className:"animate-fade-in-up",children:[e.jsxs(re,{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[e.jsx(Pt,{className:"h-5 w-5"}),"Notification Settings"]}),e.jsx(Be,{children:"Configure alerts and reminders"})]}),e.jsxs(J,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(L,{children:"Budget Alerts"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Get notified when approaching budget limits"})]}),e.jsx($e,{checked:n.enableBudgetAlerts,onCheckedChange:l=>s({enableBudgetAlerts:l})})]}),n.enableBudgetAlerts&&e.jsxs("div",{className:"space-y-2 pl-4 border-l-2 border-muted",children:[e.jsx(L,{children:"Warning Threshold"}),e.jsxs(Se,{value:String(n.budgetWarningThreshold),onValueChange:l=>s({budgetWarningThreshold:parseInt(l)}),children:[e.jsx(De,{className:"w-full sm:w-48",children:e.jsx(Ae,{})}),e.jsxs(ke,{children:[e.jsx(ae,{value:"50",children:"50% of budget"}),e.jsx(ae,{value:"60",children:"60% of budget"}),e.jsx(ae,{value:"70",children:"70% of budget"}),e.jsx(ae,{value:"80",children:"80% of budget"}),e.jsx(ae,{value:"90",children:"90% of budget"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(L,{children:"Installment Reminders"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Get reminded before payment due dates"})]}),e.jsx($e,{checked:n.enableInstallmentReminders,onCheckedChange:l=>s({enableInstallmentReminders:l})})]}),n.enableInstallmentReminders&&e.jsxs("div",{className:"space-y-2 pl-4 border-l-2 border-muted",children:[e.jsx(L,{children:"Reminder Days Before"}),e.jsxs(Se,{value:String(n.installmentReminderDays),onValueChange:l=>s({installmentReminderDays:parseInt(l)}),children:[e.jsx(De,{className:"w-full sm:w-48",children:e.jsx(Ae,{})}),e.jsxs(ke,{children:[e.jsx(ae,{value:"1",children:"1 day before"}),e.jsx(ae,{value:"2",children:"2 days before"}),e.jsx(ae,{value:"3",children:"3 days before"}),e.jsx(ae,{value:"5",children:"5 days before"}),e.jsx(ae,{value:"7",children:"7 days before"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(L,{children:"Financial Insights"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Show smart spending analysis and tips"})]}),e.jsx($e,{checked:n.enableInsights,onCheckedChange:l=>s({enableInsights:l})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(L,{children:"Weekly Reports"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Show weekly spending summary"})]}),e.jsx($e,{checked:n.weeklyReportEnabled,onCheckedChange:l=>s({weeklyReportEnabled:l})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(L,{children:"Monthly Reports"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Show monthly spending summary"})]}),e.jsx($e,{checked:n.monthlyReportEnabled,onCheckedChange:l=>s({monthlyReportEnabled:l})})]})]})]}),e.jsxs(K,{className:"animate-fade-in-up",children:[e.jsxs(re,{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[e.jsx(gs,{className:"h-5 w-5"}),"Expense Categories"]}),e.jsx(Be,{children:"Manage your expense categories"})]}),e.jsxs(J,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(L,{children:"Custom Categories"}),e.jsxs(F,{size:"sm",onClick:()=>{c(null),f({name:"",nameAr:"",icon:"ðŸ“¦",color:"#3b82f6",isEssential:!1}),m(!0)},children:[e.jsx(Te,{className:"h-4 w-4 mr-1"}),"Add Category"]})]}),u.length===0?e.jsx("p",{className:"text-sm text-muted-foreground py-4 text-center",children:"No custom categories yet"}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:u.map(l=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",style:{borderColor:l.color+"40"},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-full flex items-center justify-center text-lg",style:{backgroundColor:l.color+"20"},children:l.icon}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:l.name}),l.nameAr&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.nameAr})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(F,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>o(l),children:e.jsx(ps,{className:"h-4 w-4"})}),e.jsx(F,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive",onClick:()=>i(l.id),children:e.jsx(me,{className:"h-4 w-4"})})]})]},l.id))})]}),e.jsxs("div",{className:"space-y-2 pt-4 border-t",children:[e.jsxs(L,{children:["Default Categories (",d.length,")"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2",children:d.map(l=>e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg bg-muted/50",children:[e.jsx("span",{className:"w-6 h-6 rounded-full flex items-center justify-center text-sm",style:{backgroundColor:l.color+"20"},children:l.icon}),e.jsx("span",{className:"text-xs font-medium truncate",children:l.name})]},l.id))})]})]})]}),e.jsx(Me,{open:j,onOpenChange:m,children:e.jsxs(je,{className:"sm:max-w-md",children:[e.jsx(fe,{children:e.jsxs(Ne,{className:"flex items-center gap-2",children:[e.jsx(js,{className:"h-5 w-5"}),p?"Edit Category":"Add Category"]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Name (English)"}),e.jsx(ne,{value:N.name,onChange:l=>f({...N,name:l.target.value}),placeholder:"e.g., Coffee"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Name (Arabic - Optional)"}),e.jsx(ne,{value:N.nameAr,onChange:l=>f({...N,nameAr:l.target.value}),placeholder:"e.g., Ù‚Ù‡ÙˆØ©",dir:"rtl"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Icon"}),e.jsx("div",{className:"grid grid-cols-10 gap-1",children:sa.map(l=>e.jsx("button",{type:"button",onClick:()=>f({...N,icon:l}),className:`w-8 h-8 rounded flex items-center justify-center text-lg hover:bg-muted transition-colors ${N.icon===l?"bg-primary/20 ring-2 ring-primary":""}`,children:l},l))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Color"}),e.jsx("div",{className:"grid grid-cols-8 gap-1",children:ta.map(l=>e.jsx("button",{type:"button",onClick:()=>f({...N,color:l}),className:`w-8 h-8 rounded-full transition-all ${N.color===l?"ring-2 ring-offset-2 ring-primary":""}`,style:{backgroundColor:l}},l))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(L,{children:"Essential Category"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Mark as essential/necessary expense"})]}),e.jsx($e,{checked:N.isEssential,onCheckedChange:l=>f({...N,isEssential:l})})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx(L,{className:"mb-2 block",children:"Preview"}),e.jsxs("div",{className:"inline-flex items-center gap-2 p-3 rounded-lg border",style:{borderColor:N.color+"40"},children:[e.jsx("span",{className:"w-10 h-10 rounded-full flex items-center justify-center text-xl",style:{backgroundColor:N.color+"20"},children:N.icon}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:N.name||"Category Name"}),N.nameAr&&e.jsx("p",{className:"text-sm text-muted-foreground",children:N.nameAr})]})]})]})]}),e.jsxs(ct,{children:[e.jsxs(F,{variant:"outline",onClick:()=>m(!1),children:[e.jsx(Ze,{className:"h-4 w-4 mr-1"}),"Cancel"]}),e.jsxs(F,{onClick:k,disabled:!N.name.trim(),children:[e.jsx(Ve,{className:"h-4 w-4 mr-1"}),p?"Save Changes":"Add Category"]})]})]})})]})},na=({onImport:n,onExport:h,onReset:s})=>{const[a,g]=r.useState("idle"),[i,j]=r.useState(""),[m,p]=r.useState(!1),c=()=>{try{const o=h(),u=JSON.stringify(o,null,2),d=new Blob([u],{type:"application/json"}),l=URL.createObjectURL(d),x=document.createElement("a");x.href=l,x.download=`lifeos-finance-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(l)}catch{console.error("Export failed")}},N=()=>{try{const o=h(),u=[];o.expenses.forEach(S=>{const E=o.categories.find(P=>P.id===S.categoryId);u.push({type:"Expense",title:S.title,amount:-S.amount,category:E?.name||"Unknown",date:S.date,notes:S.notes||""})}),o.incomes.forEach(S=>{u.push({type:"Income",title:S.title,amount:S.amount,category:S.category||"Income",date:S.actualDate||S.expectedDate||S.createdAt,notes:S.notes||""})}),u.sort((S,E)=>new Date(E.date).getTime()-new Date(S.date).getTime());const l=[["Type","Title","Amount","Category","Date","Notes"].join(","),...u.map(S=>[S.type,`"${S.title.replace(/"/g,'""')}"`,S.amount,`"${S.category.replace(/"/g,'""')}"`,S.date,`"${S.notes.replace(/"/g,'""')}"`].join(","))].join(`
`),x=new Blob([l],{type:"text/csv;charset=utf-8;"}),v=URL.createObjectURL(x),I=document.createElement("a");I.href=v,I.download=`lifeos-finance-transactions-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(v)}catch{console.error("CSV export failed")}},f=o=>{const u=o.target.files?.[0];if(!u)return;const d=new FileReader;d.onload=l=>{try{const x=l.target?.result,v=JSON.parse(x);if(!v.incomes||!v.expenses||!v.categories)throw new Error("Invalid file structure");n(v),g("success"),j("Data imported successfully!"),setTimeout(()=>g("idle"),3e3)}catch{g("error"),j("Invalid file format. Please use a valid LifeOS Finance backup file."),setTimeout(()=>g("idle"),5e3)}},d.readAsText(u),o.target.value=""},k=()=>{s(),p(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(K,{className:"animate-fade-in-up",children:[e.jsxs(re,{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[e.jsx(fs,{className:"h-5 w-5"}),"Data Management"]}),e.jsx(Be,{children:"Export, import, or reset your financial data"})]}),e.jsxs(J,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium text-sm text-foreground",children:"Export Data"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Download your financial data for backup or use in other applications."}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(F,{variant:"outline",size:"sm",onClick:c,className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"h-4 w-4"}),"Export JSON"]}),e.jsxs(F,{variant:"outline",size:"sm",onClick:N,className:"flex items-center gap-2",children:[e.jsx(ys,{className:"h-4 w-4"}),"Export CSV"]})]})]}),e.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[e.jsx("h3",{className:"font-medium text-sm text-foreground",children:"Import Data"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Restore from a previous backup (JSON format only). This will replace your current data."}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:".json",onChange:f,className:"hidden"}),e.jsx(F,{variant:"outline",size:"sm",className:"flex items-center gap-2 w-full sm:w-auto",asChild:!0,children:e.jsxs("span",{children:[e.jsx(bs,{className:"h-4 w-4"}),"Import from JSON"]})})]}),a==="success"&&e.jsxs("div",{className:"flex items-center gap-2 text-green-600 text-sm animate-fade-in",children:[e.jsx(et,{className:"h-4 w-4"}),i]}),a==="error"&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm animate-fade-in",children:[e.jsx(gt,{className:"h-4 w-4"}),i]})]})]}),e.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[e.jsx("h3",{className:"font-medium text-sm text-foreground text-destructive",children:"Danger Zone"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Reset all financial data. This action cannot be undone."}),e.jsxs(F,{variant:"destructive",size:"sm",onClick:()=>p(!0),className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),"Reset All Data"]})]})]})]}),e.jsx(Me,{open:m,onOpenChange:p,children:e.jsxs(je,{className:"sm:max-w-md",children:[e.jsx(fe,{children:e.jsxs(Ne,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(gt,{className:"h-5 w-5"}),"Confirm Reset"]})}),e.jsxs("div",{className:"py-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Are you sure you want to reset all financial data? This will permanently delete:"}),e.jsxs("ul",{className:"mt-3 text-sm space-y-1 text-muted-foreground list-disc list-inside",children:[e.jsx("li",{children:"All income records"}),e.jsx("li",{children:"All expense records"}),e.jsx("li",{children:"All installments"}),e.jsx("li",{children:"All budgets"}),e.jsx("li",{children:"All financial goals"}),e.jsx("li",{children:"Custom categories"})]}),e.jsx("p",{className:"mt-4 text-sm font-medium text-destructive",children:"This action cannot be undone."})]}),e.jsxs(ct,{className:"gap-2 sm:gap-0",children:[e.jsx(F,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(F,{variant:"destructive",onClick:k,children:"Yes, Reset Everything"})]})]})})]})},ja=()=>{const{incomes:n,expenses:h,categories:s,installments:a,goals:g,alerts:i,settings:j,getMonthlyStats:m,getCategorySpending:p,getRecentTransactions:c,getOrCreateBudget:N,formatCurrency:f,quickAddExpense:k,addExpense:o,deleteExpense:u,addIncome:d,deleteIncome:l,addInstallment:x,updateInstallment:v,deleteInstallment:I,addInstallmentPayment:S,addGoal:E,updateGoal:P,deleteGoal:q,addGoalContribution:H,updateBudget:_,dismissAlert:X,updateSettings:w,addCategory:A,updateCategory:y,deleteCategory:R,exportData:W,importData:ie,resetData:xe}=Ms(),{showConfetti:ye,celebrationMessage:de,celebrate:ue,endCelebration:be,setShowConfetti:ee,setCelebrationMessage:Z}=Zs(),[b,C]=r.useState(!1),[t,D]=r.useState(!1),[T,B]=r.useState(!1),[M,z]=r.useState(!1),[G,te]=r.useState(!1),[Q,O]=r.useState(!1),[V,he]=r.useState(null),[tt,ze]=r.useState(null),[Re,oe]=r.useState(null),[Ke,Ee]=r.useState("overview"),[qe,Je]=r.useState(()=>{const se=localStorage.getItem("lifeos-celebrated-goals");return se?new Set(JSON.parse(se)):new Set}),ot=r.useMemo(()=>m(),[m]),st=r.useMemo(()=>p(),[p]),dt=r.useMemo(()=>c(5),[c]),at=new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"}),ve=r.useMemo(()=>N(),[N]),Y=r.useMemo(()=>a.filter(se=>se.status==="active"),[a]);r.useEffect(()=>{const We=g.filter(ge=>ge.currentAmount>=ge.targetAmount).find(ge=>!qe.has(ge.id));if(We){ue("Goal Achieved! ðŸŽ¯",`You reached your "${We.title}" goal!`,"ðŸ†");const ge=new Set(qe);ge.add(We.id),Je(ge),localStorage.setItem("lifeos-celebrated-goals",JSON.stringify([...ge]))}},[g,qe,ue]);const le=r.useMemo(()=>g.filter(se=>se.status==="active"),[g]),Kt=se=>{V?v(V.id,se):x(se),he(null)},Jt=se=>{Re?P(Re.id,se):E(se),oe(null)},_t=se=>{ve&&_(ve.id,{categoryBudgets:se})};return e.jsxs("div",{className:"space-y-4 sm:space-y-6 pb-20 lg:pb-6",children:[e.jsx(Qs,{isActive:ye,onComplete:be}),e.jsx(Xs,{isVisible:!!de,message:de?.message||"",subMessage:de?.subMessage,emoji:de?.emoji,onClose:()=>{ee(!1),Z(null)}}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between animate-fade-in-up",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground flex items-center gap-2",children:[e.jsx(Ye,{className:"h-6 w-6 sm:h-8 sm:w-8 text-primary"}),"Finance"]}),e.jsxs("p",{className:"text-sm sm:text-base text-muted-foreground mt-1",children:[at," Overview"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{variant:"outline",size:"sm",onClick:()=>B(!0),className:"flex-1 sm:flex-none",children:[e.jsx(Fe,{className:"h-4 w-4 mr-1 text-green-500"}),e.jsx("span",{className:"hidden sm:inline",children:"Add"})," Income"]}),e.jsxs(F,{size:"sm",onClick:()=>D(!0),className:"flex-1 sm:flex-none",children:[e.jsx(Te,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Add"})," Expense"]})]})]}),i.length>0&&e.jsx(Ls,{alerts:i,onDismiss:X}),e.jsx(Es,{stats:ot,formatCurrency:f}),e.jsxs(Ot,{value:Ke,onValueChange:Ee,className:"w-full",children:[e.jsxs(Rt,{className:"w-full grid grid-cols-5 h-auto p-1",children:[e.jsxs(we,{value:"overview",className:"text-xs sm:text-sm py-2 px-1 sm:px-3 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground",children:[e.jsx(Yt,{className:"h-4 w-4 sm:mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Overview"})]}),e.jsxs(we,{value:"transactions",className:"text-xs sm:text-sm py-2 px-1 sm:px-3 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground",children:[e.jsx(bt,{className:"h-4 w-4 sm:mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Transactions"})]}),e.jsxs(we,{value:"installments",className:"text-xs sm:text-sm py-2 px-1 sm:px-3 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground",children:[e.jsx(Qe,{className:"h-4 w-4 sm:mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Installments"})]}),e.jsxs(we,{value:"goals",className:"text-xs sm:text-sm py-2 px-1 sm:px-3 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground",children:[e.jsx(Ie,{className:"h-4 w-4 sm:mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Goals"})]}),e.jsxs(we,{value:"settings",className:"text-xs sm:text-sm py-2 px-1 sm:px-3 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground",children:[e.jsx(Lt,{className:"h-4 w-4 sm:mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Settings"})]})]}),e.jsxs(Ce,{value:"overview",className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(Ys,{incomes:n,expenses:h,formatCurrency:f}),e.jsx(zs,{expenses:h,categories:s,formatCurrency:f,period:"month"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(Us,{budget:ve,categories:s,formatCurrency:f,onSaveBudget:_t}),e.jsxs(K,{children:[e.jsxs(re,{className:"pb-2",children:[e.jsxs(ce,{className:"text-base sm:text-lg flex items-center gap-2",children:[e.jsx(vt,{className:"h-4 w-4 text-primary"}),"Spending by Category"]}),e.jsx(Be,{children:"Where your money goes"})]}),e.jsx(J,{children:e.jsx($s,{categorySpending:st,formatCurrency:f})})]})]}),e.jsxs(K,{children:[e.jsx(re,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(ce,{className:"text-base sm:text-lg flex items-center gap-2",children:[e.jsx(bt,{className:"h-4 w-4 text-primary"}),"Recent Transactions"]}),e.jsx(Be,{children:"Your latest activity"})]}),e.jsxs(F,{variant:"ghost",size:"sm",onClick:()=>Ee("transactions"),className:"text-xs",children:["View All",e.jsx(lt,{className:"h-4 w-4 ml-1"})]})]})}),e.jsx(J,{children:e.jsx(Ct,{transactions:dt,formatCurrency:f,compact:!0})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(K,{className:"cursor-pointer hover:bg-accent/50 transition-colors",onClick:()=>Ee("installments"),children:e.jsx(J,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-orange-500/10",children:e.jsx(Qe,{className:"h-5 w-5 text-orange-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active Installments"}),e.jsx("p",{className:"text-lg font-bold",children:Y.length})]}),e.jsx(lt,{className:"h-4 w-4 text-muted-foreground"})]})})}),e.jsx(K,{className:"cursor-pointer hover:bg-accent/50 transition-colors",onClick:()=>Ee("goals"),children:e.jsx(J,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(Ie,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active Goals"}),e.jsx("p",{className:"text-lg font-bold",children:le.length})]}),e.jsx(lt,{className:"h-4 w-4 text-muted-foreground"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(Hs,{incomes:n,expenses:h,categories:s,goals:g,budgets:ve?[ve]:[],formatCurrency:f}),e.jsx(Ks,{incomes:n,expenses:h,formatCurrency:f})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(Js,{incomes:n,expenses:h,categories:s,formatCurrency:f}),e.jsx(_s,{expenses:h,budgets:ve?[ve]:[],goals:g})]})]}),e.jsx(Ce,{value:"transactions",className:"mt-4",children:e.jsxs(K,{children:[e.jsx(re,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ce,{className:"text-base sm:text-lg",children:"All Transactions"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(F,{variant:"outline",size:"sm",children:[e.jsx(vt,{className:"h-4 w-4 mr-1"}),"Filter"]})})]})}),e.jsx(J,{children:e.jsx(Ct,{transactions:c(50),formatCurrency:f,onDeleteIncome:l,onDeleteExpense:u})})]})}),e.jsxs(Ce,{value:"installments",className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Installments"}),e.jsxs(F,{size:"sm",onClick:()=>{he(null),z(!0)},children:[e.jsx(Te,{className:"h-4 w-4 mr-1"}),"Add Installment"]})]}),e.jsx(Gs,{installments:a,formatCurrency:f,onEdit:se=>{he(se),z(!0)},onDelete:I,onPayInstallment:se=>{const We=a.find(ge=>ge.id===se);We&&(ze(We),te(!0))}})]}),e.jsxs(Ce,{value:"goals",className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Financial Goals"}),e.jsxs(F,{size:"sm",onClick:()=>{oe(null),O(!0)},children:[e.jsx(Te,{className:"h-4 w-4 mr-1"}),"Add Goal"]})]}),e.jsx(Bs,{goals:g,formatCurrency:f,onEdit:se=>{oe(se),O(!0)},onDelete:q,onContribute:H})]}),e.jsxs(Ce,{value:"settings",className:"mt-4 space-y-4",children:[e.jsx(aa,{settings:j,categories:s,onUpdateSettings:w,onAddCategory:A,onUpdateCategory:y,onDeleteCategory:R}),e.jsx(na,{onExport:W,onImport:ie,onReset:xe})]})]}),e.jsx("button",{onClick:()=>C(!0),className:"lg:hidden fixed bottom-20 right-4 z-50 w-14 h-14 rounded-full bg-primary text-primary-foreground shadow-lg flex items-center justify-center hover:bg-primary/90 active:scale-95 transition-all","aria-label":"Quick add expense",children:e.jsx(Te,{className:"h-6 w-6"})}),e.jsx(Ts,{isOpen:b,onClose:()=>C(!1),categories:s,onAdd:k}),e.jsx(Fs,{isOpen:t,onClose:()=>D(!1),categories:s,onSave:o,defaultCurrency:j.defaultCurrency}),e.jsx(Os,{isOpen:T,onClose:()=>B(!1),onSave:d,defaultCurrency:j.defaultCurrency}),e.jsx(qs,{isOpen:M,onClose:()=>{z(!1),he(null)},onSave:Kt,installment:V}),e.jsx(Ws,{isOpen:G,onClose:()=>{te(!1),ze(null)},installment:tt,onPay:S,formatCurrency:f}),e.jsx(Vs,{isOpen:Q,onClose:()=>{O(!1),oe(null)},onSave:Jt,goal:Re})]})};export{ja as Finance,ja as default};
