import{j as e}from"./radix-ui-q4KaMQ3n.js";import{r as N,f as Q,u as W}from"./router-Ba52I8Mc.js";import{C as D}from"./Card-DVvn3yC3.js";import{j as S,d as j,B as v,e as M,z as O}from"./index-DHR3R_v5.js";import{P as _}from"./progress-CGaMcMnD.js";import"./dnd-kit-DHe5TpGb.js";import{L as A,a as B}from"./ListCard-fIrfTEbg.js";import{C as z}from"./Checkbox-D529UBiJ.js";import{a as T,i as k,h as H,c as U,b as X,f as F,P as Z,j as ee}from"./TaskModals-DhGI8ZL9.js";import{W as $,Y as q,s as I,t as L,m as y,J as se,C as te,Q as J,w as ae,x as re,P as ie}from"./utils-BXZcBnh9.js";import{K as le,a as K}from"./KanbanCard-xSbsNDqL.js";import"./react-vendor-pR2cKLDH.js";import"./charts-CDhWM7dn.js";import"./TextArea-2u2uRZNT.js";const oe=({tasks:a,onToggleComplete:o,onEdit:n,onDelete:g})=>{const[c,d]=N.useState(!0),h=a.filter(t=>!t.completed),m=a.filter(t=>t.completed),r=t=>{const l=[];if(l.push({label:T(t.priority),variant:S(t.priority)}),t.dueDate){const s=k(t.dueDate);l.push({label:`Due: ${new Date(t.dueDate).toLocaleDateString()}${s&&!t.completed?" (Overdue)":""}`,variant:s&&!t.completed?"destructive":"outline",icon:e.jsx(y,{className:"h-3 w-3"})})}return t.timeEstimate&&l.push({label:`${t.timeEstimate}h estimated`,variant:"outline"}),l},i=t=>[{label:t.completed?"Mark Incomplete":"Mark Complete",icon:t.completed?e.jsx($,{className:"h-4 w-4"}):e.jsx(q,{className:"h-4 w-4"}),onClick:()=>o(t.id)},{label:"Edit",icon:e.jsx(I,{className:"h-4 w-4"}),onClick:()=>n(t)},{label:"Delete",icon:e.jsx(L,{className:"h-4 w-4"}),onClick:()=>g(t.id),variant:"destructive"}];return a.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:'No tasks yet. Click "Add Task" to get started.'})}):e.jsxs("div",{className:"space-y-4",children:[h.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:["Active Tasks (",h.length,")"]}),e.jsx(A,{items:h,getItemId:t=>t.id,emptyMessage:"",renderItem:t=>e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(z,{checked:t.completed,onCheckedChange:()=>o(t.id),className:"mt-4"}),e.jsx("div",{className:"flex-1",children:e.jsx(B,{title:t.title,description:t.description,badges:r(t),actions:i(t),className:t.completed?"opacity-60":""})})]})})]}),m.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>d(!c),className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide hover:text-foreground transition-colors",children:["Completed Tasks (",m.length,")",e.jsx("span",{className:"ml-2",children:c?"â–¼":"â–¶"})]}),c&&e.jsx(A,{items:m,getItemId:t=>t.id,emptyMessage:"",renderItem:t=>e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(z,{checked:t.completed,onCheckedChange:()=>o(t.id),className:"mt-4"}),e.jsx("div",{className:"flex-1",children:e.jsx(B,{title:t.title,description:t.description,badges:r(t),actions:i(t),className:"opacity-60"})})]})})]})]})},ne=({tasks:a,onToggleComplete:o,onEdit:n,onDelete:g,onUpdateStatus:c})=>{const d=s=>{const p=[];if(s.priority&&p.push({label:T(s.priority),variant:S(s.priority)}),s.dueDate){const x=k(s.dueDate);p.push({label:new Date(s.dueDate).toLocaleDateString(),variant:x?"destructive":"outline",icon:e.jsx(y,{className:"h-3 w-3"})})}return p},h=s=>{const p=[{label:s.completed?"Mark Incomplete":"Mark Complete",icon:s.completed?e.jsx($,{className:"h-4 w-4"}):e.jsx(q,{className:"h-4 w-4"}),onClick:()=>o(s.id)},{label:"Edit",icon:e.jsx(I,{className:"h-4 w-4"}),onClick:()=>n(s),separator:!0},{label:"Delete",icon:e.jsx(L,{className:"h-4 w-4"}),onClick:()=>g(s.id),variant:"destructive"}];if(!s.completed){const x=s.status||"todo",u=[];x!=="inProgress"&&u.push({label:"Move to In Progress",onClick:()=>c(s.id,"inProgress"),separator:u.length===0}),x!=="todo"&&u.push({label:"Move to To Do",onClick:()=>c(s.id,"todo"),separator:u.length===0}),p.splice(1,0,...u)}return p},m=(s,p)=>{const x=a.find(w=>w.id===s);if(!x)return;const u=p;u==="completed"?x.completed||o(s):(x.completed&&o(s),c(s,u))},r=a.filter(s=>!s.completed&&(!s.status||s.status==="todo")),i=a.filter(s=>!s.completed&&s.status==="inProgress"),t=a.filter(s=>s.completed),l=[{id:"todo",title:"ðŸ“‹ To Do",items:r,color:"from-blue-500 to-cyan-500"},{id:"inProgress",title:"ðŸ”¶ In Progress",items:i,color:"from-yellow-500 to-orange-500"},{id:"completed",title:"âœ… Completed",items:t,color:"from-green-500 to-emerald-500"}];return e.jsx(le,{columns:l,getItemId:s=>s.id,onDragEnd:m,renderItem:s=>e.jsx(K,{id:s.id,title:s.title,description:s.description,badges:d(s),actions:h(s),className:s.completed?"opacity-60":""}),dragOverlay:s=>e.jsx(K,{id:s.id,title:s.title,description:s.description,badges:d(s),actions:[],className:s.completed?"opacity-60":""})})},ce=({project:a,onBack:o,onUpdate:n,onDelete:g})=>{const[c,d]=N.useState(!1),[h,m]=N.useState(!1),[r,i]=N.useState(!1),[t,l]=N.useState("kanban"),{tasks:s,addTask:p,deleteTask:x,toggleTaskComplete:u,updateTask:w,reloadTasks:R}=H(a.id),E=U(a.id),C=k(a.deadline),V=X(a.deadline),Y=s.filter(f=>f.completed).length,G=()=>a.status==="todo"?e.jsx(v,{variant:"secondary",children:"To Do"}):a.status==="inProgress"?e.jsx(v,{variant:"default",children:"In Progress"}):e.jsx(v,{className:"bg-green-500/10 text-green-500",children:"Done"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(j,{variant:"outline",size:"default",onClick:o,className:"gap-2 hover:bg-primary/10 hover:border-primary text-primary transition-all duration-200 font-medium shadow-sm",children:[e.jsx(se,{className:"h-4 w-4"}),"Back to Projects"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(j,{variant:"outline",size:"default",onClick:()=>d(!0),className:"gap-2 hover:bg-blue-50 hover:border-blue-500 hover:text-blue-600 transition-all duration-200 shadow-sm text-primary ",children:[e.jsx(I,{className:"h-4 w-4"}),"Edit Project"]}),e.jsxs(j,{variant:"outline",size:"default",onClick:()=>i(!0),className:"gap-2 hover:bg-red-50 hover:border-red-500 hover:text-red-600 transition-all duration-200 shadow-sm text-primary ",children:[e.jsx(L,{className:"h-4 w-4"}),"Delete"]})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Freelancing > Projects >"," ",e.jsx("span",{className:"text-foreground font-medium",children:a.name})]}),e.jsx(D,{className:"p-6 border-border",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:a.name}),e.jsx("p",{className:"text-lg text-muted-foreground",children:a.clientName})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[G(),a.priority&&e.jsx(v,{variant:S(a.priority),children:T(a.priority)})]})]}),a.description&&e.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-foreground whitespace-pre-wrap",children:a.description})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Timeline"}),e.jsxs("div",{className:"space-y-2",children:[a.startDate&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(y,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-foreground",children:["Started:"," ",new Date(a.startDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[C?e.jsx(te,{className:"h-4 w-4 text-destructive"}):e.jsx(y,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:"Deadline: "}),e.jsx("span",{dir:"rtl",className:C?"text-destructive font-medium":"text-foreground",children:new Date(a.deadline).toLocaleDateString().toString()}),e.jsxs("span",{children:[" ",C?" (Overdue)":` (${V} days left)`]})]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Financial"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Expected:"}),e.jsx("span",{className:"font-semibold text-foreground",children:F(a.expectedProfit,a.currency)})]}),a.actualProfit&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Actual:"}),e.jsx("span",{className:"font-bold text-green-600",children:F(a.actualProfit,a.currency)})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[a.tags.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map((f,P)=>e.jsx(v,{variant:"outline",children:f},P))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Metadata"}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Created:"," ",e.jsx("span",{dir:"rtl",children:new Date(a.createdAt).toLocaleDateString()})]}),e.jsxs("p",{children:["Last updated:"," ",e.jsx("span",{dir:"rtl",children:new Date(a.updatedAt).toLocaleDateString()})]})]})]})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-foreground",children:"Project Progress"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[Y," of ",s.length," tasks completed"]})]}),e.jsx(_,{value:E,className:"h-2.5"}),e.jsx("div",{className:"text-right mt-2",children:e.jsxs("span",{className:"text-2xl font-bold text-primary",children:[E,"%"]})})]})]})}),e.jsxs(D,{className:"p-6 border-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Tasks"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{variant:t==="kanban"?"secondary":"ghost",size:"sm",onClick:()=>l("kanban"),"aria-label":"Kanban view",className:M("text-primary",t==="kanban"&&"bg-primary/10 text-primary hover:bg-primary/20"),children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsx(j,{variant:t==="list"?"secondary":"ghost",size:"sm",onClick:()=>l("list"),"aria-label":"List view",className:M("text-primary",t==="list"&&"bg-primary/10 hover:bg-primary/20"),children:e.jsx(re,{className:"h-4 w-4"})}),e.jsxs(j,{onClick:()=>m(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add Task"]})]})]}),t==="kanban"?e.jsx(ne,{tasks:s,onToggleComplete:u,onEdit:()=>{},onDelete:x,onUpdateStatus:(f,P)=>{w(f,{status:P})}}):e.jsx(oe,{tasks:s,onToggleComplete:u,onEdit:()=>{},onDelete:x})]}),c&&e.jsx(Z,{isOpen:c,onClose:()=>d(!1),onSave:f=>{n(f),d(!1)},project:a,mode:"edit"}),h&&e.jsx(ee,{isOpen:h,onClose:()=>m(!1),onSave:f=>{p(f),m(!1),R()},projectId:a.id,mode:"create"}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(D,{className:"p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Delete Project?"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-6",children:['Are you sure you want to delete "',a.name,'"? This will also delete all associated tasks. This action cannot be undone.']}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(j,{variant:"secondary",onClick:()=>i(!1),children:"Cancel"}),e.jsx(j,{variant:"destructive",onClick:()=>{g(),i(!1)},children:"Delete Project"})]})]})})]})},b="lifeos-freelancing-projects",Ce=()=>{const{projectId:a}=Q(),o=W(),[n,g]=N.useState(null),[c,d]=N.useState(!0);N.useEffect(()=>{if(!a){d(!1);return}const r=localStorage.getItem(b);if(r)try{const t=JSON.parse(r).find(l=>l.id===a);g(t||null)}catch(i){console.error("Failed to load project:",i),g(null)}d(!1)},[a]);const h=r=>{if(!n)return;const i=localStorage.getItem(b);if(i)try{const l=JSON.parse(i).map(s=>s.id===n.id?{...s,...r,updatedAt:new Date().toISOString()}:s);localStorage.setItem(b,JSON.stringify(l)),g({...n,...r,updatedAt:new Date().toISOString()})}catch(t){console.error("Failed to update project:",t)}},m=()=>{if(!n)return;const r=localStorage.getItem(b);if(r)try{const t=JSON.parse(r).filter(l=>l.id!==n.id);localStorage.setItem(b,JSON.stringify(t))}catch(i){console.error("Failed to delete project:",i)}};return c?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading project..."})}):n?e.jsx(ce,{project:n,onBack:()=>o("/freelancing"),onUpdate:r=>{h(r),O.success("Project updated successfully")},onDelete:()=>{m(),O.success("Project deleted"),o("/freelancing")}}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Project Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"The project you're looking for doesn't exist."}),e.jsx("button",{onClick:()=>o("/freelancing"),className:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors",children:"Back to Freelancing"})]})};export{Ce as FreelancingProjectDetail};
