import{j as e}from"./radix-ui-CkGECzuE.js";import{r as w}from"./router-CLckEVPx.js";import{u as q,M as E,B as L,d as v,h as z,e as C,b as J,f as K}from"./index-C1qMWjzx.js";import{a as y,F as N,T as oe}from"./TextArea-XtBVAueP.js";import{T as ce,a as ue,b as A,c as M}from"./tabs-JhXcEEFa.js";import{q as me,G as Y,n as F,P as R,u as B,$ as ge,z as S,p as xe,r as he,o as pe,s as je,y as D,t as H,N as ve,T as V,a0 as be}from"./utils-Cuc1pixd.js";import{C as Q,b as fe,c as ye,a as X}from"./Card-4FVo8xr3.js";import{P as Ne}from"./progress-iMixBTgX.js";import{D as we,a as Se,b as Ce,e as I,d as Ge}from"./KanbanCard-CyI7mrgi.js";const $=["#8B5CF6","#3B82F6","#10B981","#F59E0B","#EF4444","#EC4899","#14B8A6","#F97316"],W=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Te=()=>{const s=[];for(let o=8;o<=18;o++)for(let t=0;t<60;t+=30){const a=`${o.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`,p=o>12?o-12:o===0?12:o,m=o>=12?"PM":"AM",l=`${p}:${t.toString().padStart(2,"0")} ${m}`;s.push({value:a,label:l})}return s},ze=({isOpen:s,onClose:o,subject:t})=>{const{data:a,updateData:p,showToast:m}=q(),[l,j]=w.useState("details"),[r,x]=w.useState({name:"",professor:"",schedule:"",color:$[0],gradingScale:100,targetGrade:void 0,yearId:void 0,termId:void 0}),[g,u]=w.useState([]),[h,c]=w.useState([]),b=a.university.academicYears||[],P=a.university.terms||[],Z=r.yearId?P.filter(n=>n.yearId===r.yearId).sort((n,d)=>n.order-d.order):[];w.useEffect(()=>{t?(x({name:t.name,professor:t.professor||"",schedule:t.schedule||"",color:t.color,gradingScale:t.gradingScale??100,targetGrade:t.targetGrade,yearId:t.yearId,termId:t.termId}),u(t.lectures||[]),c(t.sections||[])):(x({name:"",professor:"",schedule:"",color:$[0],gradingScale:100,targetGrade:void 0,yearId:a.university.currentYearId,termId:a.university.currentTermId}),u([]),c([])),j("details")},[t,s,a.university.currentYearId,a.university.currentTermId]);const O=n=>{const{name:d,value:i}=n.target;x(f=>({...f,[d]:i}))},ee=()=>{u([...g,{day:"Monday",startTime:"09:00",endTime:"10:30",location:""}])},ae=n=>{u(g.filter((d,i)=>i!==n))},G=(n,d,i)=>{const f=[...g];f[n]={...f[n],[d]:i},u(f)},se=()=>{c([...h,{day:"Monday",startTime:"14:00",endTime:"15:30",location:""}])},te=n=>{c(h.filter((d,i)=>i!==n))},T=(n,d,i)=>{const f=[...h];f[n]={...f[n],[d]:i},c(f)},re=()=>{const n=[...g,...h];for(const d of n){const[i,f]=d.startTime.split(":").map(Number),[ne,de]=d.endTime.split(":").map(Number),le=i*60+f,ie=ne*60+de;if(le>=ie)return m("End time must be after start time","error"),!1}return!0},U=n=>{if(n.preventDefault(),!r.name){m("Please fill in required fields","error");return}if(!re())return;const d={...r,id:t?.id||z(),lectures:g.length>0?g:void 0,sections:h.length>0?h:void 0,gradingScale:r.gradingScale||100,targetGrade:r.targetGrade,yearId:r.yearId,termId:r.termId};if(t){const i=a.university.subjects.map(f=>f.id===t.id?d:f);p({university:{...a.university,subjects:i}}),m("Subject updated successfully!","success")}else p({university:{...a.university,subjects:[...a.university.subjects,d]}}),m("Subject added successfully!","success");o()},k=Te();return e.jsx(E,{isOpen:s,onClose:o,title:t?"Edit Subject":"Add New Subject",footer:e.jsxs(e.Fragment,{children:[e.jsx(v,{variant:"secondary",onClick:o,children:"Cancel"}),e.jsxs(v,{variant:"default",onClick:U,children:[t?"Update":"Add"," Subject"]})]}),children:e.jsx("form",{onSubmit:U,className:"space-y-4",children:e.jsxs(ce,{value:l,onValueChange:j,children:[e.jsxs(ue,{className:"grid w-full grid-cols-3",children:[e.jsxs(A,{value:"details",children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Details"]}),e.jsxs(A,{value:"grading",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Grading"]}),e.jsxs(A,{value:"schedules",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Schedules"]})]}),e.jsxs(M,{value:"details",className:"space-y-4 mt-4",children:[e.jsx(y,{label:"Subject Name *",name:"name",value:r.name,onChange:O,placeholder:"e.g., Programming Language (PL2)",required:!0}),e.jsx(y,{label:"Professor",name:"professor",value:r.professor,onChange:O,placeholder:"e.g., Ù…Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(N,{label:"Academic Year",name:"yearId",value:r.yearId||"",onChange:n=>{const d=n.target.value||void 0;x(i=>({...i,yearId:d,termId:d?i.termId:void 0}))},options:[{value:"",label:"Unassigned"},...b.sort((n,d)=>n.order-d.order).map(n=>({value:n.id,label:n.name+(n.isActive?" (Active)":"")}))]}),e.jsx(N,{label:"Term / Semester",name:"termId",value:r.termId||"",onChange:n=>x(d=>({...d,termId:n.target.value||void 0})),options:[{value:"",label:r.yearId?"All Terms":"Select Year First"},...Z.map(n=>({value:n.id,label:n.name}))],disabled:!r.yearId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Color"}),e.jsx("div",{className:"grid grid-cols-8 gap-2",children:$.map(n=>e.jsx("button",{type:"button",onClick:()=>x(d=>({...d,color:n})),className:`w-8 h-8 rounded-lg transition-all duration-200 ${r.color===n?"ring-2 ring-primary ring-offset-2 ring-offset-background":""}`,style:{backgroundColor:n},title:`Select ${n}`,"aria-label":`Select color ${n}`},n))})]})]}),e.jsxs(M,{value:"grading",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"p-4 bg-muted/30 rounded-lg border",children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4"}),"Grade Tracking Configuration"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure how grades are calculated for this subject. The grading scale determines the total possible points, and the target grade is your personal goal."})]}),e.jsx(y,{label:"Grading Scale (Total Points)",name:"gradingScale",type:"number",value:String(r.gradingScale||100),onChange:n=>x(d=>({...d,gradingScale:Number(n.target.value)||100})),placeholder:"e.g., 100"}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:"The maximum possible points for this subject (default: 100)"}),e.jsx(y,{label:"Target Grade (%)",name:"targetGrade",type:"number",value:r.targetGrade!==void 0?String(r.targetGrade):"",onChange:n=>x(d=>({...d,targetGrade:n.target.value?Number(n.target.value):void 0})),placeholder:"e.g., 85"}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:"Your target percentage for this subject (optional)"}),r.targetGrade!==void 0&&r.gradingScale&&e.jsx("div",{className:"p-3 bg-primary/10 rounded-lg border border-primary/20",children:e.jsxs("p",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium",children:["Target Points:"," "]}),(r.targetGrade/100*r.gradingScale).toFixed(1)," ","/ ",r.gradingScale]})})]}),e.jsxs(M,{value:"schedules",className:"space-y-6 mt-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold flex items-center gap-2",children:e.jsx(L,{variant:"outline",style:{borderColor:r.color,color:r.color},children:"Lectures"})}),e.jsxs(v,{type:"button",variant:"outline",size:"sm",onClick:ee,children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Add Lecture"]})]}),g.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4 border rounded-lg",children:'No lectures scheduled. Click "Add Lecture" to add one.'}),g.map((n,d)=>e.jsxs("div",{className:"p-4 border rounded-lg space-y-3",style:{backgroundColor:`${r.color}10`,borderColor:`${r.color}50`},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-primary",children:["Lecture ",d+1]}),e.jsx(v,{type:"button",variant:"ghost",size:"sm",onClick:()=>ae(d),children:e.jsx(B,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(N,{label:"Day",name:`lecture-day-${d}`,value:n.day,onChange:i=>G(d,"day",i.target.value),options:W.map(i=>({value:i,label:i}))}),e.jsx(y,{label:"Location",name:`lecture-location-${d}`,value:n.location,onChange:i=>G(d,"location",i.target.value),placeholder:"e.g., Room 101"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(N,{label:"Start Time",name:`lecture-start-${d}`,value:n.startTime,onChange:i=>G(d,"startTime",i.target.value),options:k}),e.jsx(N,{label:"End Time",name:`lecture-end-${d}`,value:n.endTime,onChange:i=>G(d,"endTime",i.target.value),options:k})]})]},`lecture-${d}`))]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold flex items-center gap-2",children:e.jsx(L,{variant:"outline",style:{borderColor:r.color,color:r.color,opacity:.8},children:"Sections"})}),e.jsxs(v,{type:"button",variant:"outline",size:"sm",onClick:se,children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Add Section"]})]}),h.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4 border rounded-lg",children:'No sections scheduled. Click "Add Section" to add one.'}),h.map((n,d)=>e.jsxs("div",{className:"p-4 border rounded-lg space-y-3",style:{backgroundColor:`${r.color}08`,borderColor:`${r.color}40`},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-primary",children:["Section ",d+1]}),e.jsx(v,{type:"button",variant:"ghost",size:"sm",onClick:()=>te(d),children:e.jsx(B,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(N,{label:"Day",name:`section-day-${d}`,value:n.day,onChange:i=>T(d,"day",i.target.value),options:W.map(i=>({value:i,label:i}))}),e.jsx(y,{label:"Location",name:`section-location-${d}`,value:n.location,onChange:i=>T(d,"location",i.target.value),placeholder:"e.g., Lab 203"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(N,{label:"Start Time",name:`section-start-${d}`,value:n.startTime,onChange:i=>T(d,"startTime",i.target.value),options:k}),e.jsx(N,{label:"End Time",name:`section-end-${d}`,value:n.endTime,onChange:i=>T(d,"endTime",i.target.value),options:k})]})]},`section-${d}`))]})]})]})})})},Oe=({isOpen:s,onClose:o,task:t})=>{const{data:a,updateData:p,showToast:m}=q(),[l,j]=w.useState({subjectId:"",title:"",description:"",type:"assignment",dueDate:"",priority:5,status:"todo"});w.useEffect(()=>{j(t?{subjectId:t.subjectId,title:t.title,description:t.description||"",type:t.type,dueDate:t.dueDate||"",priority:t.priority,status:t.status}:{subjectId:"",title:"",description:"",type:"assignment",dueDate:"",priority:5,status:"todo"})},[t,s]);const r=g=>{const{name:u,value:h}=g.target;j(c=>({...c,[u]:u==="priority"?Number(h):h}))},x=g=>{if(g.preventDefault(),!l.title||!l.subjectId){m("Please fill in required fields","error");return}if(t){const u=a.university.tasks.map(h=>h.id===t.id?{...t,...l,dueDate:l.dueDate||void 0}:h);p({university:{...a.university,tasks:u}}),m("Task updated successfully!","success")}else{const u={...l,dueDate:l.dueDate||void 0,id:z(),timeSpent:0,createdAt:new Date().toISOString()};p({university:{...a.university,tasks:[...a.university.tasks,u]}}),m("Task added successfully!","success")}o()};return e.jsx(E,{isOpen:s,onClose:o,title:t?"Edit Task":"Add New Task",footer:e.jsxs(e.Fragment,{children:[e.jsx(v,{variant:"secondary",onClick:o,children:"Cancel"}),e.jsxs(v,{variant:"default",onClick:x,children:[t?"Update":"Add"," Task"]})]}),children:e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsx(N,{label:"Subject *",name:"subjectId",value:l.subjectId,onChange:r,options:[{value:"",label:"Select a subject"},...a.university.subjects.map(g=>({value:g.id,label:g.name}))],required:!0}),e.jsx(y,{label:"Task Title *",name:"title",value:l.title,onChange:r,placeholder:"e.g., Complete Assignment 3",required:!0}),e.jsx(oe,{label:"Description",name:"description",value:l.description,onChange:r,placeholder:"Add details about this task...",rows:3}),e.jsx(N,{label:"Type",name:"type",value:l.type,onChange:r,options:[{value:"study",label:"Study Session"},{value:"assignment",label:"Assignment"},{value:"exam",label:"Exam Prep"},{value:"notes",label:"Notes"}]}),e.jsx(y,{label:"Due Date (Optional)",name:"dueDate",type:"date",value:l.dueDate||"",onChange:r}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Priority (1-10)"}),e.jsx("input",{type:"range",name:"priority",min:"1",max:"10",value:l.priority,onChange:r,className:"w-full h-2 bg-muted rounded-lg appearance-none cursor-pointer accent-primary"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[e.jsx("span",{children:"Low (1)"}),e.jsx("span",{className:"text-primary font-semibold text-base",children:l.priority}),e.jsx("span",{children:"High (10)"})]})]}),e.jsx(N,{label:"Status",name:"status",value:l.status,onChange:r,options:[{value:"todo",label:"To Do"},{value:"in-progress",label:"In Progress"},{value:"done",label:"Done"}]})]})]})})},Ue=({isOpen:s,onClose:o,exam:t})=>{const{data:a,updateData:p,showToast:m}=q(),[l,j]=w.useState({subjectId:"",title:"",date:new Date().toISOString().split("T")[0],duration:120,location:"",maxGrade:100});w.useEffect(()=>{j(t?{subjectId:t.subjectId,title:t.title,date:t.date,duration:t.duration,location:t.location||"",maxGrade:t.maxGrade||100}:{subjectId:"",title:"",date:new Date().toISOString().split("T")[0],duration:120,location:"",maxGrade:100})},[t,s]);const r=g=>{const{name:u,value:h}=g.target;j(c=>({...c,[u]:u==="duration"||u==="maxGrade"?Number(h):h}))},x=g=>{if(g.preventDefault(),!l.title||!l.subjectId||!l.date){m("Please fill in required fields","error");return}if(t){const u=a.university.exams.map(h=>h.id===t.id?{...h,subjectId:l.subjectId,title:l.title,date:l.date,duration:l.duration,location:l.location,maxGrade:l.maxGrade}:h);p({university:{...a.university,exams:u}}),m("Exam updated successfully!","success")}else{const u={id:z(),subjectId:l.subjectId,title:l.title,date:l.date,duration:l.duration,location:l.location,maxGrade:l.maxGrade,taken:!1};p({university:{...a.university,exams:[...a.university.exams,u]}}),m("Exam added successfully!","success")}o()};return e.jsx(E,{isOpen:s,onClose:o,title:t?"Edit Exam":"Add New Exam",footer:e.jsxs(e.Fragment,{children:[e.jsx(v,{variant:"secondary",onClick:o,children:"Cancel"}),e.jsxs(v,{variant:"default",onClick:x,children:[t?"Update":"Add"," Exam"]})]}),children:e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsx(N,{label:"Subject *",name:"subjectId",value:l.subjectId,onChange:r,options:[{value:"",label:"Select a subject"},...a.university.subjects.map(g=>({value:g.id,label:g.name}))],required:!0}),e.jsx(y,{label:"Exam Title *",name:"title",value:l.title,onChange:r,placeholder:"e.g., Midterm Exam",required:!0}),e.jsx(y,{label:"Date *",name:"date",type:"date",value:l.date,onChange:r,required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(y,{label:"Duration (minutes)",name:"duration",type:"number",min:"30",max:"300",value:l.duration,onChange:r}),e.jsx(y,{label:"Max Grade *",name:"maxGrade",type:"number",min:"1",max:"1000",value:l.maxGrade,onChange:r,placeholder:"e.g., 100",required:!0})]}),e.jsx(y,{label:"Location",name:"location",value:l.location,onChange:r,placeholder:"e.g., Room 301, Building A"})]})})},ke=(s,o)=>{const t=s.filter(c=>c.taken&&c.grade!==void 0&&c.grade!==null),a=t.reduce((c,b)=>c+(b.grade||0),0),p=t.reduce((c,b)=>c+(b.maxGrade||0),0),m=o.filter(c=>c.type!=="bonus"&&c.type!=="deduction"),l=m.reduce((c,b)=>c+b.pointsEarned,0),j=m.reduce((c,b)=>c+(b.maxPoints||0),0),r=o.filter(c=>c.type==="bonus").reduce((c,b)=>c+b.pointsEarned,0),x=o.filter(c=>c.type==="deduction").reduce((c,b)=>c+Math.abs(b.pointsEarned),0),g=a+l+r-x,u=p+j,h=u>0?g/u*100:0;return{totalEarned:g,totalPossible:u,percentage:h,examGrades:{earned:a,possible:p},entryGrades:{earned:l,possible:j},bonusPoints:r,deductions:x}},_=s=>s>=90?"text-green-500":s>=80?"text-emerald-500":s>=70?"text-blue-500":s>=60?"text-yellow-500":s>=50?"text-orange-500":"text-red-500",Ye=({subject:s,exams:o,gradeEntries:t})=>{const a=ke(o,t),p=s.targetGrade||60,m=a.percentage>=p;return e.jsxs(Q,{children:[e.jsx(fe,{children:e.jsxs(ye,{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5"}),"Grade Summary"]})}),e.jsxs(X,{className:"space-y-6",children:[e.jsxs("div",{className:"text-center p-6 bg-muted/30 rounded-xl",children:[e.jsx("div",{className:"flex items-center justify-center gap-2 mb-2",children:e.jsx(S,{className:C("w-8 h-8",_(a.percentage))})}),e.jsxs("div",{className:C("text-5xl font-bold mb-1",_(a.percentage)),children:[a.percentage.toFixed(1),"%"]}),e.jsxs("div",{className:"text-muted-foreground",children:[a.totalEarned.toFixed(1)," /"," ",a.totalPossible.toFixed(1)," points"]}),a.totalPossible===0&&e.jsx("div",{className:"text-sm text-muted-foreground mt-2",children:"No grades recorded yet"})]}),a.totalPossible>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[a.percentage.toFixed(1),"%"]})]}),e.jsx(Ne,{value:Math.min(a.percentage,100),className:"h-3"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"Target Grade"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium",children:[p,"%"]}),a.totalPossible>0&&e.jsx("span",{className:C("text-xs px-2 py-0.5 rounded-full",m?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"),children:m?"On Track":"Below Target"})]})]}),a.totalPossible>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4"}),"Breakdown"]}),a.examGrades.possible>0&&e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Exams"}),e.jsxs("span",{children:[a.examGrades.earned.toFixed(1)," /"," ",a.examGrades.possible.toFixed(1)]})]}),a.entryGrades.possible>0&&e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Assignments & Others"}),e.jsxs("span",{children:[a.entryGrades.earned.toFixed(1)," /"," ",a.entryGrades.possible.toFixed(1)]})]}),a.bonusPoints>0&&e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-green-600 dark:text-green-400",children:"Bonus Points"}),e.jsxs("span",{className:"text-green-600 dark:text-green-400",children:["+",a.bonusPoints.toFixed(1)]})]}),a.deductions>0&&e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400",children:"Deductions"}),e.jsxs("span",{className:"text-red-600 dark:text-red-400",children:["-",a.deductions.toFixed(1)]})]})]})]})]})},Ie=s=>{const o=J(s.date),t=new Date,p=new Date(s.date).toDateString()===t.toDateString();return s.taken&&s.grade!==void 0&&s.grade!==null?"graded":s.taken?"taken":p?"today":o<0?"missed":"upcoming"},De=s=>{switch(s){case"graded":return{label:"Graded",variant:"default",className:"bg-green-500 hover:bg-green-600",icon:e.jsx(S,{className:"w-3 h-3"})};case"taken":return{label:"Awaiting Grade",variant:"secondary",className:"bg-blue-500 hover:bg-blue-600 text-white",icon:e.jsx(be,{className:"w-3 h-3"})};case"today":return{label:"Today!",variant:"destructive",className:"bg-orange-500 hover:bg-orange-600 animate-pulse",icon:e.jsx(V,{className:"w-3 h-3"})};case"missed":return{label:"Missed",variant:"destructive",className:"bg-red-500 hover:bg-red-600",icon:e.jsx(V,{className:"w-3 h-3"})};case"upcoming":default:return{label:"Upcoming",variant:"outline",className:"",icon:e.jsx(F,{className:"w-3 h-3"})}}},Re=({exam:s,subjectName:o,subjectColor:t,onMarkAsTaken:a,onAddGrade:p,onEdit:m,onDelete:l})=>{const j=Ie(s),r=De(j),x=J(s.date),u=s.grade===void 0||s.grade===null||!s.maxGrade?null:(s.grade/s.maxGrade*100).toFixed(1);return e.jsx(Q,{className:C("transition-all hover:shadow-md",j==="today"&&"ring-2 ring-orange-500",j==="missed"&&!s.taken&&"opacity-75"),style:{borderLeftWidth:"4px",borderLeftColor:t||"var(--primary)"},children:e.jsx(X,{className:"pt-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.title}),e.jsxs(L,{className:r.className,children:[r.icon,e.jsx("span",{className:"ml-1",children:r.label})]})]}),o&&e.jsx("p",{className:"text-sm text-muted-foreground",children:o}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(F,{className:"w-4 h-4"}),e.jsx("span",{children:K(s.date)}),j==="upcoming"&&x>0&&e.jsxs("span",{className:C("ml-1 font-medium",x<=3?"text-red-500":x<=7?"text-orange-500":"text-muted-foreground"),children:["(",x," days left)"]})]}),s.duration>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.duration," min"]})]}),s.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(je,{className:"w-4 h-4"}),e.jsx("span",{children:s.location})]})]}),j==="graded"&&s.grade!==void 0&&e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-green-100 dark:bg-green-700/85 rounded-lg",children:[e.jsx(S,{className:"w-4 h-4 text-green-600 dark:text-white"}),e.jsxs("span",{className:"font-bold text-green-700 dark:text-white",children:[s.grade," / ",s.maxGrade]}),u&&e.jsxs("span",{className:"text-sm text-green-600 dark:text-white",children:["(",u,"%)"]})]})}),e.jsx("div",{className:"flex items-center gap-2 mt-3",children:j==="upcoming"||j==="today"?e.jsxs(v,{size:"sm",variant:"outline",onClick:()=>a(s),children:[e.jsx(D,{className:"w-4 h-4 mr-1"}),"Mark as Taken"]}):j==="missed"?e.jsxs(v,{size:"sm",variant:"outline",onClick:()=>a(s),children:[e.jsx(D,{className:"w-4 h-4 mr-1"}),"I took this exam"]}):j==="taken"?e.jsxs(v,{size:"sm",variant:"default",onClick:()=>p(s),children:[e.jsx(S,{className:"w-4 h-4 mr-1"}),"Add Grade"]}):e.jsxs(v,{size:"sm",variant:"outline",onClick:()=>p(s),children:[e.jsx(H,{className:"w-4 h-4 mr-1"}),"Edit Grade"]})})]}),e.jsxs(we,{children:[e.jsx(Se,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"sm",children:e.jsx(ve,{className:"w-4 h-4"})})}),e.jsxs(Ce,{align:"end",children:[e.jsxs(I,{onClick:()=>m(s),children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Edit Exam"]}),!s.taken&&e.jsxs(I,{onClick:()=>a(s),children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Mark as Taken"]}),s.taken&&e.jsxs(I,{onClick:()=>p(s),children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),s.grade!==void 0?"Edit Grade":"Add Grade"]}),e.jsx(Ge,{}),e.jsxs(I,{onClick:()=>l(s),className:"text-red-600",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]})})})},He=({isOpen:s,onClose:o,onSave:t,exam:a,mode:p})=>{const[m,l]=w.useState({grade:"",addGradeNow:!1});w.useEffect(()=>{l(a?{grade:a.grade!==void 0?a.grade.toString():"",addGradeNow:p==="grade"||a.grade!==void 0}:{grade:"",addGradeNow:!1})},[a,p,s]);const j=g=>{const{name:u,value:h,type:c,checked:b}=g.target;l(P=>({...P,[u]:c==="checkbox"?b:h}))},r=g=>{if(g.preventDefault(),!a)return;const u={taken:!0,takenAt:a.takenAt||new Date().toISOString()};if(m.addGradeNow&&m.grade!==""){const h=parseFloat(m.grade);isNaN(h)||(u.grade=h,u.gradeEnteredAt=new Date().toISOString())}t(a.id,u),o()};if(!a)return null;const x=p==="grade";return e.jsx(E,{isOpen:s,onClose:o,title:x?a.grade!==void 0?"Edit Exam Grade":"Add Exam Grade":"Mark Exam as Taken",footer:e.jsxs(e.Fragment,{children:[e.jsx(v,{variant:"secondary",onClick:o,children:"Cancel"}),e.jsx(v,{variant:"default",onClick:r,children:x?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),a.grade!==void 0?"Update Grade":"Save Grade"]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Mark as Taken"]})})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg space-y-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:a.title}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(F,{className:"w-4 h-4"}),e.jsx("span",{children:K(a.date)})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Max Grade:"," ",e.jsx("span",{className:"font-medium",children:a.maxGrade})," ","points"]})]}),!x&&e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg",children:[e.jsx("input",{type:"checkbox",id:"addGradeNow",name:"addGradeNow",checked:m.addGradeNow,onChange:j,className:"w-4 h-4 rounded border-gray-300"}),e.jsx("label",{htmlFor:"addGradeNow",className:"text-sm cursor-pointer",children:"I know my grade, add it now"})]}),(x||m.addGradeNow)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{label:`Grade (out of ${a.maxGrade})`,name:"grade",type:"number",step:"0.5",min:"0",max:a.maxGrade,value:m.grade,onChange:j,placeholder:`Enter grade (max: ${a.maxGrade})`}),m.grade!==""&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Percentage:"," ",e.jsxs("span",{className:"font-medium",children:[(parseFloat(m.grade)/a.maxGrade*100).toFixed(1),"%"]})]})]}),!x&&!m.addGradeNow&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"ðŸ’¡ You can add your grade later when the results are available. We'll remind you periodically."})]})})};export{Re as E,Ye as G,He as M,ze as S,Oe as T,Ue as a,ke as c,_ as g};
