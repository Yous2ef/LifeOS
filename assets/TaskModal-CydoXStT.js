import{j as e}from"./radix-ui-CZbxChR9.js";import{r as y}from"./router-CLckEVPx.js";import{u as I,M as P,B as A,d as v,h as B}from"./index-Cl9Owp1C.js";import{a as S,F as h,T as Y}from"./TextArea-BkkJIZd4.js";import{T as G,a as J,b as k,c as L}from"./tabs-D_DGAz29.js";import{q as K,n as Q,P as E,u as F}from"./utils-gzJrCzCn.js";const D=["#8B5CF6","#3B82F6","#10B981","#F59E0B","#EF4444","#EC4899","#14B8A6","#F97316"],M=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],X=()=>{const g=[];for(let o=8;o<=18;o++)for(let a=0;a<60;a+=30){const u=`${o.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`,j=o>12?o-12:o===0?12:o,p=o>=12?"PM":"AM",n=`${j}:${a.toString().padStart(2,"0")} ${p}`;g.push({value:u,label:n})}return g},re=({isOpen:g,onClose:o,subject:a})=>{const{data:u,updateData:j,showToast:p}=I(),[n,f]=y.useState("details"),[r,b]=y.useState({name:"",professor:"",schedule:"",color:D[0]}),[i,m]=y.useState([]),[c,x]=y.useState([]);y.useEffect(()=>{a?(b({name:a.name,professor:a.professor||"",schedule:a.schedule||"",color:a.color}),m(a.lectures||[]),x(a.sections||[])):(b({name:"",professor:"",schedule:"",color:D[0]}),m([]),x([])),f("details")},[a,g]);const w=l=>{const{name:t,value:s}=l.target;b(d=>({...d,[t]:s}))},q=()=>{m([...i,{day:"Monday",startTime:"09:00",endTime:"10:30",location:""}])},O=l=>{m(i.filter((t,s)=>s!==l))},T=(l,t,s)=>{const d=[...i];d[l]={...d[l],[t]:s},m(d)},R=()=>{x([...c,{day:"Monday",startTime:"14:00",endTime:"15:30",location:""}])},z=l=>{x(c.filter((t,s)=>s!==l))},N=(l,t,s)=>{const d=[...c];d[l]={...d[l],[t]:s},x(d)},H=()=>{const l=[...i,...c];for(const t of l){const[s,d]=t.startTime.split(":").map(Number),[U,_]=t.endTime.split(":").map(Number),V=s*60+d,W=U*60+_;if(V>=W)return p("End time must be after start time","error"),!1}return!0},$=l=>{if(l.preventDefault(),!r.name){p("Please fill in required fields","error");return}if(!H())return;const t={...r,id:a?.id||B(),lectures:i.length>0?i:void 0,sections:c.length>0?c:void 0};if(a){const s=u.university.subjects.map(d=>d.id===a.id?t:d);j({university:{...u.university,subjects:s}}),p("Subject updated successfully!","success")}else j({university:{...u.university,subjects:[...u.university.subjects,t]}}),p("Subject added successfully!","success");o()},C=X();return e.jsx(P,{isOpen:g,onClose:o,title:a?"Edit Subject":"Add New Subject",footer:e.jsxs(e.Fragment,{children:[e.jsx(v,{variant:"secondary",onClick:o,children:"Cancel"}),e.jsxs(v,{variant:"default",onClick:$,children:[a?"Update":"Add"," Subject"]})]}),children:e.jsx("form",{onSubmit:$,className:"space-y-4",children:e.jsxs(G,{value:n,onValueChange:f,children:[e.jsxs(J,{className:"grid w-full grid-cols-2",children:[e.jsxs(k,{value:"details",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Details"]}),e.jsxs(k,{value:"schedules",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Schedules"]})]}),e.jsxs(L,{value:"details",className:"space-y-4 mt-4",children:[e.jsx(S,{label:"Subject Name *",name:"name",value:r.name,onChange:w,placeholder:"e.g., Programming Language (PL2)",required:!0}),e.jsx(S,{label:"Professor",name:"professor",value:r.professor,onChange:w,placeholder:"e.g., محمد السعيد"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Color"}),e.jsx("div",{className:"grid grid-cols-8 gap-2",children:D.map(l=>e.jsx("button",{type:"button",onClick:()=>b(t=>({...t,color:l})),className:`w-8 h-8 rounded-lg transition-all duration-200 ${r.color===l?"ring-2 ring-primary ring-offset-2 ring-offset-background":""}`,style:{backgroundColor:l},title:`Select ${l}`,"aria-label":`Select color ${l}`},l))})]})]}),e.jsxs(L,{value:"schedules",className:"space-y-6 mt-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold flex items-center gap-2",children:e.jsx(A,{variant:"outline",style:{borderColor:r.color,color:r.color},children:"Lectures"})}),e.jsxs(v,{type:"button",variant:"outline",size:"sm",onClick:q,children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Add Lecture"]})]}),i.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4 border rounded-lg",children:'No lectures scheduled. Click "Add Lecture" to add one.'}),i.map((l,t)=>e.jsxs("div",{className:"p-4 border rounded-lg space-y-3",style:{backgroundColor:`${r.color}10`,borderColor:`${r.color}50`},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-primary",children:["Lecture ",t+1]}),e.jsx(v,{type:"button",variant:"ghost",size:"sm",onClick:()=>O(t),children:e.jsx(F,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(h,{label:"Day",name:`lecture-day-${t}`,value:l.day,onChange:s=>T(t,"day",s.target.value),options:M.map(s=>({value:s,label:s}))}),e.jsx(S,{label:"Location",name:`lecture-location-${t}`,value:l.location,onChange:s=>T(t,"location",s.target.value),placeholder:"e.g., Room 101"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(h,{label:"Start Time",name:`lecture-start-${t}`,value:l.startTime,onChange:s=>T(t,"startTime",s.target.value),options:C}),e.jsx(h,{label:"End Time",name:`lecture-end-${t}`,value:l.endTime,onChange:s=>T(t,"endTime",s.target.value),options:C})]})]},`lecture-${t}`))]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold flex items-center gap-2",children:e.jsx(A,{variant:"outline",style:{borderColor:r.color,color:r.color,opacity:.8},children:"Sections"})}),e.jsxs(v,{type:"button",variant:"outline",size:"sm",onClick:R,children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Add Section"]})]}),c.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4 border rounded-lg",children:'No sections scheduled. Click "Add Section" to add one.'}),c.map((l,t)=>e.jsxs("div",{className:"p-4 border rounded-lg space-y-3",style:{backgroundColor:`${r.color}08`,borderColor:`${r.color}40`},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-primary",children:["Section ",t+1]}),e.jsx(v,{type:"button",variant:"ghost",size:"sm",onClick:()=>z(t),children:e.jsx(F,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(h,{label:"Day",name:`section-day-${t}`,value:l.day,onChange:s=>N(t,"day",s.target.value),options:M.map(s=>({value:s,label:s}))}),e.jsx(S,{label:"Location",name:`section-location-${t}`,value:l.location,onChange:s=>N(t,"location",s.target.value),placeholder:"e.g., Lab 203"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(h,{label:"Start Time",name:`section-start-${t}`,value:l.startTime,onChange:s=>N(t,"startTime",s.target.value),options:C}),e.jsx(h,{label:"End Time",name:`section-end-${t}`,value:l.endTime,onChange:s=>N(t,"endTime",s.target.value),options:C})]})]},`section-${t}`))]})]})]})})})},ne=({isOpen:g,onClose:o,task:a})=>{const{data:u,updateData:j,showToast:p}=I(),[n,f]=y.useState({subjectId:"",title:"",description:"",type:"assignment",dueDate:"",priority:5,status:"todo"});y.useEffect(()=>{f(a?{subjectId:a.subjectId,title:a.title,description:a.description||"",type:a.type,dueDate:a.dueDate||"",priority:a.priority,status:a.status}:{subjectId:"",title:"",description:"",type:"assignment",dueDate:"",priority:5,status:"todo"})},[a,g]);const r=i=>{const{name:m,value:c}=i.target;f(x=>({...x,[m]:m==="priority"?Number(c):c}))},b=i=>{if(i.preventDefault(),!n.title||!n.subjectId){p("Please fill in required fields","error");return}if(a){const m=u.university.tasks.map(c=>c.id===a.id?{...a,...n,dueDate:n.dueDate||void 0}:c);j({university:{...u.university,tasks:m}}),p("Task updated successfully!","success")}else{const m={...n,dueDate:n.dueDate||void 0,id:B(),timeSpent:0,createdAt:new Date().toISOString()};j({university:{...u.university,tasks:[...u.university.tasks,m]}}),p("Task added successfully!","success")}o()};return e.jsx(P,{isOpen:g,onClose:o,title:a?"Edit Task":"Add New Task",footer:e.jsxs(e.Fragment,{children:[e.jsx(v,{variant:"secondary",onClick:o,children:"Cancel"}),e.jsxs(v,{variant:"default",onClick:b,children:[a?"Update":"Add"," Task"]})]}),children:e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsx(h,{label:"Subject *",name:"subjectId",value:n.subjectId,onChange:r,options:[{value:"",label:"Select a subject"},...u.university.subjects.map(i=>({value:i.id,label:i.name}))],required:!0}),e.jsx(S,{label:"Task Title *",name:"title",value:n.title,onChange:r,placeholder:"e.g., Complete Assignment 3",required:!0}),e.jsx(Y,{label:"Description",name:"description",value:n.description,onChange:r,placeholder:"Add details about this task...",rows:3}),e.jsx(h,{label:"Type",name:"type",value:n.type,onChange:r,options:[{value:"study",label:"Study Session"},{value:"assignment",label:"Assignment"},{value:"exam",label:"Exam Prep"},{value:"notes",label:"Notes"}]}),e.jsx(S,{label:"Due Date (Optional)",name:"dueDate",type:"date",value:n.dueDate||"",onChange:r}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Priority (1-10)"}),e.jsx("input",{type:"range",name:"priority",min:"1",max:"10",value:n.priority,onChange:r,className:"w-full h-2 bg-muted rounded-lg appearance-none cursor-pointer accent-primary"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[e.jsx("span",{children:"Low (1)"}),e.jsx("span",{className:"text-primary font-semibold text-base",children:n.priority}),e.jsx("span",{children:"High (10)"})]})]}),e.jsx(h,{label:"Status",name:"status",value:n.status,onChange:r,options:[{value:"todo",label:"To Do"},{value:"in-progress",label:"In Progress"},{value:"done",label:"Done"}]})]})]})})};export{re as S,ne as T};
